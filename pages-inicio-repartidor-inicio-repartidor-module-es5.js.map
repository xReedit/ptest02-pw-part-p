{"version":3,"sources":["webpack:///node_modules/@capacitor/push-notifications/dist/esm/definitions.js","webpack:///node_modules/@capacitor/push-notifications/dist/esm/index.js","webpack:///src/app/pages/inicio-repartidor/inicio-repartidor.module.ts","webpack:///src/app/pages/inicio-repartidor/inicio-repartidor.routing.ts","webpack:///src/app/pages/inicio-repartidor/main/main.component.html","webpack:///src/app/pages/inicio-repartidor/main/main.component.ts"],"names":["PushNotifications","InicioRepartidorModule","declarations","imports","routes","path","component","data","titulo","InicioRepartidorRoutingModule","forChild","exports","Geolocation","MainComponent","infoTokenService","pushNotificationService","geoPositionService","router","pedidoRepartidorService","utilitarioService","isOnNotificactionPush","isOnGeoPosition","isValid","getInfoUs","nomRepartidor","infoUsToken","usuario","nombre","cleanLocal","console","log","requestPermissions","then","result","receive","register","addListener","token","value","saveSuscripcion","error","alert","JSON","stringify","getIsTienePermiso","suscribirse","validConf","getGeoPosition","hasPermition","err","onGeoPosition","setTimeout","navigate","selector","templateUrl","styleUrls"],"mappings":"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","file":"pages-inicio-repartidor-inicio-repartidor-module-es5.js","sourcesContent":["/// <reference types=\"@capacitor/cli\" />\nexport {};\n//# sourceMappingURL=definitions.js.map","import { registerPlugin } from '@capacitor/core';\nconst PushNotifications = registerPlugin('PushNotifications', {});\nexport * from './definitions';\nexport { PushNotifications };\n//# sourceMappingURL=index.js.map","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MainComponent } from './main/main.component';\nimport { InicioRepartidorRoutingModule } from './inicio-repartidor.routing';\nimport { CoreModule } from 'src/app/core/core.module';\n\n\n\n@NgModule({\n  declarations: [MainComponent],\n  imports: [\n    CommonModule,\n    InicioRepartidorRoutingModule,\n    CoreModule\n  ]\n})\nexport class InicioRepartidorModule { }\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { MainComponent } from './main/main.component';\r\n\r\nconst routes: Routes = [{\r\n    path: '', component: MainComponent,\r\n    data: { titulo: 'Inicio' }\r\n}];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class InicioRepartidorRoutingModule { }\r\n","<div class=\"animated fadeIn\">\n    <div class=\"p-3 text-center w-100\">\n        <span>Hola</span>\n        <h5>{{ nomRepartidor }}</h5>\n        <hr>\n\n        <div>\n            <img src=\"assets/images/img-ini.png\" alt=\"img-ini\" style=\"max-width: 150px;\">\n        </div>\n        <br>\n\n\n        <p class=\"fs-17\" *ngIf=\"!isValid\">Para recibir pedidos es necesario que:</p>      \n        <br>\n        <ng-container *ngIf=\"!isOnGeoPosition\">\n            <div>\n                <div class=\"fw-100\">\n                    Active su ubicaci√≥n (GPS).\n                </div>\n                <div>\n                    <button mat-flat-button color=\"primary\" (click)=\"aceptarPosition()\">Activar</button>\n                    <!-- <button mat-flat-button color=\"primary\" (click)=\"aceptarPosition1()\">Activar 1 </button> -->\n                    <!-- <button mat-flat-button color=\"primary\" (click)=\"aceptarPosition2()\">Activar 2</button> -->\n                </div>\n            </div>            \n            <hr>\n        </ng-container>\n\n      \n        <ng-container *ngIf=\"!isOnNotificactionPush\">\n            <div>\n                <div>\n                    <div class=\"fw-100\">\n                        Active las notificaciones.\n                    </div>\n                    <div>\n                        <button mat-flat-button color=\"primary\" (click)=\"aceptarNotificacion()\">Activar</button>\n                    </div>\n                </div>            \n            </div>\n            <hr>\n        </ng-container>\n\n        <div *ngIf=\"isValid\">\n            <h6>Validando Permisos.</h6>\n        </div>\n\n       \n    </div>\n</div>","import { Component, OnInit, AfterViewInit } from '@angular/core';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\nimport { NotificacionPushService } from 'src/app/shared/services/notificacion-push.service';\nimport { GpsUbicacionRepartidorService } from 'src/app/shared/services/gps-ubicacion-repartidor.service';\n\nimport { Router } from '@angular/router';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\n\nimport {\n  ActionPerformed,\n  PushNotificationSchema,\n  PushNotifications,    \n  Token,\n} from '@capacitor/push-notifications';\n\nimport { Plugins } from '@capacitor/core';\nimport { UtilitariosService } from 'src/app/shared/services/utilitarios.service';\nimport { IS_NATIVE } from 'src/app/shared/config/config.const';\n\nconst { Geolocation } = Plugins;\n\n@Component({\n  selector: 'app-main',\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.css']\n})\nexport class MainComponent implements OnInit {\n  nomRepartidor: '';\n  isOnNotificactionPush = false;\n  isOnGeoPosition = false;\n  isValid = false;\n  is\n\n  constructor(\n    private infoTokenService: InfoTockenService,\n    private pushNotificationService: NotificacionPushService,\n    private geoPositionService: GpsUbicacionRepartidorService,\n    private router: Router,\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private utilitarioService: UtilitariosService\n  ) { }\n\n  ngOnInit(): void {\n\n    this.infoTokenService.getInfoUs();\n    // console.log(this.infoTokenService.getInfoUs());\n    this.nomRepartidor = this.infoTokenService.infoUsToken.usuario.nombre;\n\n    this.pedidoRepartidorService.cleanLocal();\n\n    console.log('aaa');\n\n    if (!IS_NATIVE) { return; }\n    PushNotifications.requestPermissions().then(result => {\n      console.log('result.receive', result.receive);\n      if (result.receive === 'granted') {\n        // Register with Apple / Google to receive push via APNS/FCM\n        PushNotifications.register()        \n      } else {\n        // Show some error\n        console.log('error al registrar');\n      }\n    });    \n     \n    // On success, we should be able to receive notifications\n    PushNotifications.addListener('registration',\n      (token: Token) => {        \n        console.log('addListener token.value ', token.value);\n        this.pushNotificationService.saveSuscripcion(token.value);\n      }\n    );    \n\n    // Some issue with our setup and push will not work\n    PushNotifications.addListener('registrationError',\n      (error: any) => {\n        alert('Error en registrar: ' + JSON.stringify(error));\n      }\n    );\n\n    // Show us the notification payload if the app is open on our device\n    // PushNotifications.addListener('pushNotificationReceived',\n    //   (notification: PushNotificationSchema) => {\n    //     alert('Push received: ' + JSON.stringify(notification));\n    //   }\n    // );\n\n    // Method called when tapping on a notification\n    // PushNotifications.addListener('pushNotificationActionPerformed',\n    //   (notification: ActionPerformed) => {\n    //     alert('Push action performed: ' + JSON.stringify(notification));\n    //   }\n    // );\n\n  }\n\n  async aceptarNotificacion() {\n    if (!IS_NATIVE) {\n      try {\n        if ( await this.pushNotificationService.getIsTienePermiso()) {\n          this.pushNotificationService.suscribirse();\n        }\n\n      } \n      catch (error) {\n      }\n    }\n\n    this.isOnNotificactionPush = true;\n    this.validConf();\n  }\n\n  // aceptarPosition() {\n  //   this.geoPositionService.onGeoPosition();\n\n  //   // setTimeout(() => {\n  //   //   this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n  //   //   this.pushNotificationService.suscribirse();\n  //   //   this.isOnGeoPosition = true;\n  //   //   this.validConf();\n  //   // }, 1500);\n  // }\n\n  aceptarPosition() {\n    try {\n      \n      Geolocation.requestPermissions().then(() => {\n        // Permisos de geolocalizaci√≥n aceptados\n        // GPS activado\n        this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n        // this.pushNotificationService.suscribirse();\n        this.isOnGeoPosition = true;\n        this.validConf();      \n      }, (err) => {\n        // Permisos de geolocalizaci√≥n rechazados\n        // GPS no activado\n        alert('Es necesario que active su ubicaci√≥n (GPS)')\n\n        this.geoPositionService.onGeoPosition();\n  \n        setTimeout(() => {\n          this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n          this.pushNotificationService.suscribirse();\n          this.isOnGeoPosition = true;\n          this.validConf();\n        }, 1500);\n      });\n\n    } catch (error) {\n      // navegador\n      this.geoPositionService.onGeoPosition();\n  \n      setTimeout(() => {\n        this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n        this.pushNotificationService.suscribirse();\n        this.isOnGeoPosition = true;\n        this.validConf();\n      }, 1500);\n    }\n\n  }\n\n  // aceptarPosition2() {\n  //   Geolocation.getCurrentPosition().then(position => {\n  //     alert(position);\n  //   });\n  // }\n\n  private validConf() {\n    this.isValid = this.isOnNotificactionPush && this.isOnGeoPosition;\n\n    if ( this.isValid ) {\n\n      setTimeout(() => {\n        this.router.navigate(['./main']);\n      }, 1400);\n\n    }\n  }\n\n}\n"]}