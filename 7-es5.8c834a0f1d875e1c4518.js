function _get(e,i,t){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,i,t){var o=_superPropBase(e,i);if(o){var a=Object.getOwnPropertyDescriptor(o,i);return a.get?a.get.call(t):a.value}})(e,i,t||e)}function _superPropBase(e,i){for(;!Object.prototype.hasOwnProperty.call(e,i)&&null!==(e=_getPrototypeOf(e)););return e}function _createSuper(e){return function(){var i,t=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var o=_getPrototypeOf(this).constructor;i=Reflect.construct(t,arguments,o)}else i=t.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,i){return!i||"object"!=typeof i&&"function"!=typeof i?_assertThisInitialized(e):i}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i&&_setPrototypeOf(e,i)}function _setPrototypeOf(e,i){return(_setPrototypeOf=Object.setPrototypeOf||function(e,i){return e.__proto__=i,e})(e,i)}function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,i,t){return i&&_defineProperties(e.prototype,i),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"6qA3":function(e,i,t){"use strict";var o=t("OAkW"),a=t("Z5tI"),n=t("poJ0"),s=t("ozli"),r=t("yRPT"),c=t("90cg"),d=t("GMZp"),l=t("VKeD"),p=t("zfKp");i.subscribeTo=function(e){if(e&&"function"==typeof e[p.observable])return s.subscribeToObservable(e);if(r.isArrayLike(e))return o.subscribeToArray(e);if(c.isPromise(e))return a.subscribeToPromise(e);if(e&&"function"==typeof e[l.iterator])return n.subscribeToIterable(e);var i=d.isObject(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},"8Xr9":function(e,i,t){"use strict";t.r(i),t.d(i,"RepartidorModule",(function(){return Lt}));var o,a,n=t("ofXK"),s=t("tyNb"),r=t("0IaG"),c=t("dDDv"),d=t("w/My"),l=t("zOUh"),p=t("jzV0"),b=t("eI2u"),u=t("fXoL"),h=t("kmnG"),f=t("qFsG"),v=t("bTqV"),m=((o=function(){function e(i,t,o,a,n){_classCallCheck(this,e),this.pushNotificationService=i,this.geoPositionService=t,this.infoTokenService=o,this.repartidorService=a,this.listenService=n,this.isOnNotificactionPush=!1,this.isOnGeoPosition=!1,this.importeIndicado=0,this.importe=""}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.isOnNotificactionPush=this.pushNotificationService.getIsTienePermiso()}},{key:"guardarEfectivoMano",value:function(){this.repartidorService.guardarEfectivo(this.importeIndicado,1),this.infoTokenService.setEfectivoMano(this.importeIndicado),this.listenService.setEfectivoMano(this.importeIndicado)}},{key:"validImporte",value:function(e){this.importeIndicado=isNaN(parseInt(e,0))?0:parseInt(e,0)}}]),e}()).\u0275fac=function(e){return new(e||o)(u.Ob(c.a),u.Ob(d.a),u.Ob(l.a),u.Ob(p.a),u.Ob(b.a))},o.\u0275cmp=u.Ib({type:o,selectors:[["app-dialog-efectivo-repartidor"]],decls:14,vars:1,consts:[[1,"w-100"],["type","number","matInput","","placeholder","Efectivo en mano","required","",3,"keyup"],["importe",""],[1,"fs-12","text-secondary","fw-100"],[1,"text-center"],["mat-flat-button","","color","primary","mat-dialog-close","",3,"disabled","click"]],template:function(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div"),u.Ub(1,"p"),u.Ec(2,"Parametros Iniciales: "),u.Tb(),u.Pb(3,"hr"),u.Ub(4,"div"),u.Ub(5,"mat-form-field",0),u.Ub(6,"input",1,2),u.cc("keyup",(function(){u.wc(t);var e=u.vc(7);return i.validImporte(e.value)})),u.Tb(),u.Tb(),u.Ub(8,"span",3),u.Ec(9,"Seg\xfan este importe se le asignaran pedidos que debe pagar en efectivo"),u.Tb(),u.Tb(),u.Pb(10,"hr"),u.Ub(11,"div",4),u.Ub(12,"button",5),u.cc("click",(function(){return i.guardarEfectivoMano()})),u.Ec(13,"Listo"),u.Tb(),u.Tb(),u.Tb()}2&e&&(u.Cb(12),u.mc("disabled",0===i.importeIndicado))},directives:[h.a,f.a,v.a,r.d],styles:[""]}),o),g=t("yFR0"),P=t("QB/n"),C=t("ds6q"),y=t("pLZG"),_=t("7o/Q"),T=function(){function e(i,t){_classCallCheck(this,e),this.bufferSize=i,this.startBufferEvery=t,this.subscriberClass=t&&i!==t?w:k}return _createClass(e,[{key:"call",value:function(e,i){return i.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))}}]),e}(),k=function(e){_inherits(t,e);var i=_createSuper(t);function t(e,o){var a;return _classCallCheck(this,t),(a=i.call(this,e)).bufferSize=o,a.buffer=[],a}return _createClass(t,[{key:"_next",value:function(e){var i=this.buffer;i.push(e),i.length==this.bufferSize&&(this.destination.next(i),this.buffer=[])}},{key:"_complete",value:function(){var e=this.buffer;e.length>0&&this.destination.next(e),_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}}]),t}(_.a),w=function(e){_inherits(t,e);var i=_createSuper(t);function t(e,o,a){var n;return _classCallCheck(this,t),(n=i.call(this,e)).bufferSize=o,n.startBufferEvery=a,n.buffers=[],n.count=0,n}return _createClass(t,[{key:"_next",value:function(e){var i=this.bufferSize,t=this.startBufferEvery,o=this.buffers,a=this.count;this.count++,a%t==0&&o.push([]);for(var n=o.length;n--;){var s=o[n];s.push(e),s.length===i&&(o.splice(n,1),this.destination.next(s))}}},{key:"_complete",value:function(){for(var e=this.buffers,i=this.destination;e.length>0;){var o=e.shift();o.length>0&&i.next(o)}_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}}]),t}(_.a),S=t("7RJT"),U=((a=function(){function e(i,t,o){_classCallCheck(this,e),this.router=i,this.infoTokenService=t,this.listenService=o,this.disabledBack=!1,this.resNavigatorSource=new S.BehaviorSubject([]),this.resNavigatorSourceObserve$=this.resNavigatorSource.asObservable(),this.pageActive="carta",this.resNavigator=[],this.historyNavigator=[],this.lastUrlHistory="",this.listenEventNavigator()}return _createClass(e,[{key:"listenEventNavigator",value:function(){var e=this;this.router.events.pipe(Object(y.a)((function(e){return e instanceof s.a})),function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(t){return t.lift(new T(e,i))}}(2,1)).subscribe((function(i){if(null!=i&&"popstate"===i[1].navigationTrigger){if(e.disabledBack)return!1;var t=i[0].url.indexOf(";")?i[0].url.substr(1).split(";")[1].split("=")[1]:i[0].url;t.length>0&&(e.lastUrlHistory=t)}}))}},{key:"setPageActive",value:function(e){this.pageActive=e,this.lastUrlHistory="carta"!==e?e:this.lastUrlHistory;var i=this.findPageActiveInHistory(e);this.addLink(i?i.url:e),this.resNavigator.pageActive=e,this.resNavigator.url=i?i.url:e,this.resNavigatorSource.next(this.resNavigator)}},{key:"saveHistoryPageActive",value:function(e,i){this.historyNavigator[e]=[],this.historyNavigator[e].key=e,this.historyNavigator[e].url=i}},{key:"findPageActiveInHistory",value:function(e){return Object.values(this.historyNavigator).filter((function(i){return i.key===e}))[0]}},{key:"addLink",value:function(e){this.router.navigate([".",{state:e}]),this.saveHistoryPageActive(this.pageActive,e)}},{key:"cerrarSession",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.infoTokenService.isDelivery()?this.router.navigate(["../zona-delivery"]):this.router.navigate(["../"]).then((function(){e&&window.location.reload()}))}},{key:"managerGoBack",value:function(e,i){var t="";switch(console.log("managerGoBack",e),e){case"carta-i-secciones-items":t="carta",this.addLink("carta-i-secciones");break;case"carta-i-secciones":t="carta",this.addLink("carta-i-");break;case"carta-i-":t="carta-o-",this.addLink("carta-o-"),console.log("=========================== listo para salir"),this.listoParaSalir();break;case"mipedido-confirma":t="mipedido",this.addLink("mipedido");break;case"mipedido":t="carta",this.addLink("carta"),this.listoParaSalir();break;case"estado":case"carta":t="carta";break;case"lanzar-encuesta":t="lanzar-encuesta"}""!==t&&(this.pageActive=t,this.setPageActive(t))}},{key:"_router",value:function(e){this.router.navigate([e])}},{key:"disableGoBack",value:function(){this.disabledBack=!0,history.pushState(null,null,location.href),window.onpopstate=function(){history.go(1)}}},{key:"listoParaSalir",value:function(){this.infoTokenService.isDelivery()&&this.listenService.setIsOutEstablecimientoDelivery(!0)}}]),e}()).\u0275fac=function(e){return new(e||a)(u.Yb(s.b),u.Yb(l.a),u.Yb(b.a))},a.\u0275prov=u.Kb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),R=t("3Pt+");function D(e,i){if(1&e&&(u.Ub(0,"p",8),u.Ec(1),u.Tb()),2&e){var t=u.gc();u.Cb(1),u.Fc(t.msj)}}function x(e,i){1&e&&(u.Sb(0),u.Pb(1,"i",9),u.Rb())}function E(e,i){1&e&&u.Ec(0," Guardar ")}var O,I=((O=function(){function e(i,t,o,a){_classCallCheck(this,e),this.dialogRef=i,this.repartidroService=o,this.infoToken=a,this.dataCliente={},this.msj="",this.loading=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"guardarClave",value:function(){var e=this;this.msj="",this.loading=!0,this.dataCliente.p1===this.infoToken.getInfoUs().usuario.pass?(this.repartidroService.guardarCamnioClave(this.dataCliente),setTimeout((function(){e.infoToken.getInfoUs().usuario.pass=e.dataCliente.p2,e.infoToken.set(),e.loading=!1,e.dialogRef.close()}),1500)):(this.msj="Contrase\xf1a actual no coicide",this.loading=!1)}}]),e}()).\u0275fac=function(e){return new(e||O)(u.Ob(r.g),u.Ob(r.a),u.Ob(p.a),u.Ob(l.a))},O.\u0275cmp=u.Ib({type:O,selectors:[["app-dialog-change-pass"]],decls:15,vars:6,consts:[[1,"w-100"],["type","password","matInput","","placeholder","Clave actual","required","",3,"ngModel","ngModelChange"],["type","password","matInput","","placeholder","Clave nueva","required","",3,"ngModel","ngModelChange"],["class","text-danger",4,"ngIf"],["mat-flat-button","","color","primary",1,"mr-1","mb-1",3,"disabled","click"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["mat-stroked-button","","mat-dialog-close",""],[1,"text-danger"],[1,"fa","fa-spinner","fa-spin"]],template:function(e,i){if(1&e&&(u.Ub(0,"p"),u.Ec(1,"Cmabiar Clave"),u.Tb(),u.Pb(2,"hr"),u.Ub(3,"mat-form-field",0),u.Ub(4,"input",1),u.cc("ngModelChange",(function(e){return i.dataCliente.p1=e})),u.Tb(),u.Tb(),u.Ub(5,"mat-form-field",0),u.Ub(6,"input",2),u.cc("ngModelChange",(function(e){return i.dataCliente.p2=e})),u.Tb(),u.Tb(),u.Cc(7,D,2,1,"p",3),u.Pb(8,"hr"),u.Ub(9,"button",4),u.cc("click",(function(){return i.guardarClave()})),u.Cc(10,x,2,0,"ng-container",5),u.Cc(11,E,1,0,"ng-template",null,6,u.Dc),u.Tb(),u.Ub(13,"button",7),u.Ec(14,"Cancelar"),u.Tb()),2&e){var t=u.vc(12);u.Cb(4),u.mc("ngModel",i.dataCliente.p1),u.Cb(2),u.mc("ngModel",i.dataCliente.p2),u.Cb(1),u.mc("ngIf",i.msj.length>0),u.Cb(2),u.mc("disabled",i.loading),u.Cb(1),u.mc("ngIf",i.loading)("ngIfElse",t)}},directives:[h.a,f.a,R.b,R.o,R.j,R.m,n.m,v.a,r.d],styles:[""]}),O),j=t("XhcP"),A=t("FKr1"),F=t("1jcm");function M(e,i){if(1&e){var t=u.Vb();u.Ub(0,"mat-slide-toggle",6),u.cc("change",(function(e){return u.wc(t),u.gc().repartidorOnLine(e)})),u.Tb()}if(2&e){var o=u.gc();u.mc("checked",o.isTogleActive)}}var L,G,V,N=((L=function(){function e(i,t){_classCallCheck(this,e),this.infoTokenService=i,this.repartidorService=t,this.changeTogle=new u.o(!1),this.openMenuLateral=new u.o(!1),this.isTogleActive=!1,this.isRepartidorPropio=!1,this.estadoOnline="En linea",this.nomRepatidor=""}return _createClass(e,[{key:"ngOnInit",value:function(){this.isTogleActive=this.infoTokenService.infoUsToken.isOnline,this.isRepartidorPropio=this.infoTokenService.infoUsToken.usuario.idsede_suscrito,this.estadoOnline=this.isRepartidorPropio||this.isTogleActive?"En linea":"Fuera de linea",this.nomRepatidor=this.infoTokenService.infoUsToken.usuario.nombre+" "+this.infoTokenService.infoUsToken.usuario.apellido,this.isRepartidorPropio&&this.infoTokenService.setisOnline(this.isTogleActive)}},{key:"repartidorOnLine",value:function(e){this.isTogleActive=e.checked,this.infoTokenService.setisOnline(this.isTogleActive),this.changeTogle.emit(this.isTogleActive),this.estadoOnline="En linea",this.isTogleActive||(this.estadoOnline="Fuera de linea",this.repartidorService.guardarEfectivo(0,0))}},{key:"abrirMenuLateral",value:function(){this.openMenuLateral.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||L)(u.Ob(l.a),u.Ob(p.a))},L.\u0275cmp=u.Ib({type:L,selectors:[["app-tool-bar-repartidor"]],outputs:{changeTogle:"changeTogle",openMenuLateral:"openMenuLateral"},decls:10,vars:5,consts:[[1,"header-app","p-3","d-flex","justify-content-between"],[1,"fa","fa-bars","pr-2",3,"click"],[1,"fs-14"],[1,"d-flex","align-items-center"],[1,"fs-12","pr-2"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div"),u.Ub(2,"i",1),u.cc("click",(function(){return i.abrirMenuLateral()})),u.Tb(),u.Ub(3,"span",2),u.Ec(4),u.hc(5,"titlecase"),u.Tb(),u.Tb(),u.Ub(6,"div",3),u.Ub(7,"span",4),u.Ec(8),u.Tb(),u.Cc(9,M,1,1,"mat-slide-toggle",5),u.Tb(),u.Tb()),2&e&&(u.Cb(4),u.Fc(u.ic(5,3,i.nomRepatidor)),u.Cb(4),u.Fc(i.estadoOnline),u.Cb(1),u.mc("ngIf",!i.isRepartidorPropio))},directives:[n.m,F.a],pipes:[n.u],styles:[""]}),L),z=function(e){return{loaded:e}},$=((V=function(){function e(i,t,o,a,n,s,r){_classCallCheck(this,e),this.dialog=i,this.socketService=t,this.repartidorService=o,this.infoTokeService=a,this.pedidoRepartidorService=n,this.router=s,this.navigatorService=r,this.destroy$=new C.Subject,this.isRepartidorPropio=!1,this.showPanelLeft=!1}return _createClass(e,[{key:"ngOnInit",value:function(){try{this.pedidoRepartidorService.init(),this.socketService.isSocketOpenReconect=!1,this.infoTokeService.getInfoUs(),this.isRepartidorPropio=this.infoTokeService.infoUsToken.usuario.idsede_suscrito,this.infoTokeService.infoUsToken.usuario.isRepartidorPropio=this.isRepartidorPropio,this.infoTokeService.set(),this.socketService.connect(),this.navigatorService.disableGoBack()}catch(e){this.router.navigate(["../"])}this.isRepartidorPropio?(this.repartidorService.guardarEfectivo(100),this.router.navigate(["/main/mapa-de-pedidos"])):this.router.navigate(["/main/pedidos"])}},{key:"ngOnDestroy",value:function(){this.destroy$.next(!0),this.destroy$.unsubscribe()}},{key:"repartidorOnLine",value:function(e){if(e){var i=new r.e;i.disableClose=!0,i.hasBackdrop=!0,this.dialog.open(m,i),this.socketService.connect()}}},{key:"cerrarSession",value:function(){this.repartidorService.guardarEfectivo(0,0),this.socketService.closeConnection(),this.router.navigate(["../"])}},{key:"openPanelLeft",value:function(e){this.showPanelLeft=!0}},{key:"openCambiarClave",value:function(){var e=new r.e;e.disableClose=!0,e.hasBackdrop=!0,this.dialog.open(I,e)}}]),e}()).\u0275fac=function(e){return new(e||V)(u.Ob(r.b),u.Ob(g.a),u.Ob(p.a),u.Ob(l.a),u.Ob(P.a),u.Ob(s.b),u.Ob(U))},V.\u0275cmp=u.Ib({type:V,selectors:[["app-main"]],decls:40,vars:9,consts:[[3,"ngClass"],[1,"wrapper"],["id","loader-wrapper"],["id","loader"],[1,"loader-msj"],[1,"loader-section","section-left"],[1,"loader-section","section-right"],[1,"xh-100"],["mode","over",1,"example-sidenav",3,"opened","closedStart"],["drawerIzq",""],[2,"min-width","250px"],[1,"p-3","border-bottom"],[1,"w-100","text-center"],["src","assets/icons/icon-72x72.png"],[1,"pt-1","fw-600","fs-12","text-secondary","m-0"],[1,"pt-1","fw-100","fs-11","text-secondary","m-0"],[1,"p-3","border-bottom","w-100",3,"click"],[1,"fw-600","fs-13"],[1,"fa","fa-arrow-left","pr-2"],[1,"fs-13"],["matRipple","",1,"border-bottom","p-3","xCursor",3,"click"],["aria-hidden","true",1,"fa","fa-key"],[1,"fa","fa-close","pr-2"],[1,"text-info","fs-11"],[1,"animated","fadeInDown","w-100","top-0"],[3,"changeTogle","openMenuLateral"],[1,"content-body"]],template:function(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",0),u.hc(1,"async"),u.Ub(2,"div",1),u.Ub(3,"div",2),u.Pb(4,"div",3),u.Ub(5,"div",4),u.Ec(6),u.hc(7,"async"),u.Tb(),u.Pb(8,"div",5),u.Pb(9,"div",6),u.Tb(),u.Tb(),u.Tb(),u.Ub(10,"mat-drawer-container",7),u.Ub(11,"mat-drawer",8,9),u.cc("closedStart",(function(){return i.showPanelLeft=!1})),u.Ub(13,"div",10),u.Ub(14,"div",11),u.Ub(15,"div",12),u.Pb(16,"img",13),u.Ub(17,"p",14),u.Ec(18,"Papaya Repartidor"),u.Tb(),u.Ub(19,"p",15),u.Ec(20,"papaya.com.pe"),u.Tb(),u.Tb(),u.Tb(),u.Ub(21,"div",16),u.cc("click",(function(){return u.wc(t),u.vc(12).toggle()})),u.Ub(22,"span",17),u.Pb(23,"i",18),u.Ec(24,"Opciones"),u.Tb(),u.Tb(),u.Ub(25,"div",19),u.Ub(26,"div",20),u.cc("click",(function(){u.wc(t);var e=u.vc(12);return i.openCambiarClave(),e.toggle()})),u.Pb(27,"i",21),u.Ec(28," Cambiar clave "),u.Tb(),u.Ub(29,"div",20),u.cc("click",(function(){return i.cerrarSession()})),u.Pb(30,"i",22),u.Ub(31,"span"),u.Ec(32," Cerrar Sesion"),u.Tb(),u.Pb(33,"br"),u.Ub(34,"span",23),u.Ec(35,"Al cerrar dejara de recibir pedidos."),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(36,"div",24),u.Ub(37,"app-tool-bar-repartidor",25),u.cc("changeTogle",(function(e){return i.repartidorOnLine(e)}))("openMenuLateral",(function(e){return i.openPanelLeft(e)})),u.Tb(),u.Ub(38,"div",26),u.Pb(39,"router-outlet"),u.Tb(),u.Tb(),u.Tb()}2&e&&(u.mc("ngClass",u.rc(7,z,u.ic(1,3,i.socketService.isSocketOpen$))),u.Cb(6),u.Fc(u.ic(7,5,i.socketService.msjConex$)),u.Cb(5),u.mc("opened",i.showPanelLeft))},directives:[n.k,j.b,j.a,A.e,N,s.e],pipes:[n.b],styles:[".content-body[_ngcontent-%COMP%]{padding-top:55px;overflow:auto;overscroll-behavior-y:auto}"]}),V),H=((G=function(){function e(){_classCallCheck(this,e),this.countdownTimerRef=null,this.init=0,this.maxTime=60,this.valPorcentaje=0,this.isPlayTimer=!1,this.countTimer=0,this.countdownSource=new S.BehaviorSubject(0),this.countdown$=this.countdownSource.asObservable(),this.countTimeSource=new S.BehaviorSubject(0),this.countTime$=this.countTimeSource.asObservable(),this.isTimeLimitSource=new S.BehaviorSubject(!1),this.isTimeLimitComplet$=this.isTimeLimitSource.asObservable(),this.isPorgressVisibleSource=new S.BehaviorSubject(!1),this.isPorgressVisible$=this.isPorgressVisibleSource.asObservable()}return _createClass(e,[{key:"destroy",value:function(){this.clearTimeout()}},{key:"playCountTimerLimit",value:function(){this.isPlayTimer||(this.isPlayTimer=!0,this.initCount())}},{key:"resetCountTimerLimit",value:function(){localStorage.getItem("sys::tcount")?(this.isPlayTimer=!0,this.initCount()):this.stopCountTimerLimit()}},{key:"initCount",value:function(){this.valPorcentaje=0,this.init=localStorage.getItem("sys::tcount")?parseInt(localStorage.getItem("sys::tcount"),0):0,this.isTimeLimitSource.next(!1),this.isPorgressVisibleSource.next(!0),this.countTimer=this.maxTime-this.setTimeDate(),this.progressCount()}},{key:"progressCount",value:function(){var e=this,i=0;this.isPlayTimer&&(this.countdownTimerRef=setTimeout((function(){e.init=e.setTimeDate(),e.countTimer--,e.valPorcentaje=Math.round(e.init/e.maxTime*100),localStorage.setItem("sys::tcount",e.init.toString()),e.init>e.maxTime?(e.init=e.maxTime,e.valPorcentaje=100,e.countdownSource.next(e.valPorcentaje),e.isTimeLimitSource.next(!0),e.stopCountTimerLimit()):(i!==e.valPorcentaje&&e.countdownSource.next(e.valPorcentaje),e.progressCount()),e.countTimeSource.next(e.countTimer),i=e.valPorcentaje}),1e3))}},{key:"setTimeDate",value:function(){var e=(new Date).getTime(),i=localStorage.getItem("sys::tnum")?parseInt(localStorage.getItem("sys::tnum"),0):e,t=Math.floor((e-i)/1e3);return localStorage.setItem("sys::tnum",i.toString()),t}},{key:"stopCountTimerLimit",value:function(){this.isPlayTimer=!1,this.init=0,this.valPorcentaje=0,this.countTimer=0,localStorage.removeItem("sys::tcount"),localStorage.removeItem("sys::tnum"),this.clearTimeout(),this.isPorgressVisibleSource.next(!1),this.isTimeLimitSource.next(!1)}},{key:"clearTimeout",value:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){this.countdownTimerRef&&(clearTimeout(this.countdownTimerRef),this.countdownTimerRef=null)}))}]),e}()).\u0275fac=function(e){return new(e||G)},G.\u0275prov=u.Kb({token:G,factory:G.\u0275fac,providedIn:"root"}),G),B=t("zB/H"),W=t("wZkO"),q=t("+lji");function K(e,i){if(1&e&&(u.Ub(0,"div",2),u.Ub(1,"div",3),u.Ub(2,"span",4),u.Ec(3,"Resumen del dia"),u.Tb(),u.Ub(4,"span"),u.Ec(5),u.Tb(),u.Tb(),u.Ub(6,"div",5),u.Ub(7,"div",6),u.Ub(8,"span"),u.Ec(9,"N\xb0 Pedidos entregados"),u.Tb(),u.Ub(10,"span"),u.Ec(11),u.Tb(),u.Tb(),u.Ub(12,"div",6),u.Ub(13,"span"),u.Ec(14,"Comision"),u.Tb(),u.Ub(15,"span"),u.Ec(16),u.Tb(),u.Tb(),u.Ub(17,"div",6),u.Ub(18,"span"),u.Ec(19,"Propina"),u.Tb(),u.Ub(20,"span"),u.Ec(21),u.Tb(),u.Tb(),u.Ub(22,"div",7),u.Ub(23,"span"),u.Ec(24,"Ganancia Total"),u.Tb(),u.Ub(25,"span"),u.Ec(26),u.Tb(),u.Tb(),u.Ub(27,"div",6),u.Ub(28,"span"),u.Ec(29,"Importe a depositar"),u.Tb(),u.Ub(30,"span"),u.Ec(31),u.Tb(),u.Tb(),u.Ub(32,"div",8),u.Ub(33,"span"),u.Ec(34,"Importe a debitar"),u.Tb(),u.Ub(35,"span"),u.Ec(36),u.Tb(),u.Tb(),u.Pb(37,"hr"),u.Ub(38,"div",7),u.Ub(39,"span"),u.Ec(40,"Neto a depositar"),u.Tb(),u.Ub(41,"span"),u.Ec(42),u.hc(43,"number"),u.Tb(),u.Tb(),u.Ub(44,"div",7),u.Ub(45,"span"),u.Ec(46,"Neto a debitar"),u.Tb(),u.Ub(47,"span"),u.Ec(48),u.hc(49,"number"),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e){var t=u.gc();u.Cb(5),u.Fc(t.listResumen.fecha),u.Cb(6),u.Fc(t.listResumen.num_pedidos),u.Cb(5),u.Fc(t.listResumen.comisionRepartidor),u.Cb(5),u.Fc(t.listResumen.propinaRepartidor),u.Cb(5),u.Fc(t.listResumen.costoTotalServicio),u.Cb(5),u.Fc(t.listResumen.importeDepositar),u.Cb(5),u.Fc(t.listResumen.importeDebitar),u.Cb(6),u.Fc(u.jc(43,9,t.importeNetoDepositar,".2")),u.Cb(6),u.Fc(u.jc(49,12,t.importeNetoDebitar,".2"))}}var Q,J=((Q=function(){function e(i){_classCallCheck(this,e),this.crudService=i,this.importeNetoDebitar=0,this.importeNetoDepositar=0}return _createClass(e,[{key:"ngOnInit",value:function(){this.xLoadResumenPedidos()}},{key:"xLoadPedidosAtendidos",value:function(){var e=this;this.crudService.getAll("repartidor","get-pedidos-entregados-dia",!1,!1,!0).subscribe((function(i){e.listPedidosEntregados=i.data[0]}))}},{key:"xLoadResumenPedidos",value:function(){var e=this;this.crudService.getAll("repartidor","get-pedidos-resumen-entregados-dia",!1,!1,!0).subscribe((function(i){e.listResumen=i.data[0][0],e.listResumen&&(e.importeNetoDebitar=parseFloat(e.listResumen.importeDepositar)-parseFloat(e.listResumen.importeDebitar),e.importeNetoDepositar=e.importeNetoDebitar<1?0:e.importeNetoDebitar,e.importeNetoDebitar=e.importeNetoDebitar<1?-1*e.importeNetoDebitar:0,e.xLoadPedidosAtendidos())}))}},{key:"tabIndex",set:function(e){1===e&&this.xLoadResumenPedidos()}}]),e}()).\u0275fac=function(e){return new(e||Q)(u.Ob(q.a))},Q.\u0275cmp=u.Ib({type:Q,selectors:[["app-pedidos-atendidos"]],inputs:{tabIndex:"tabIndex"},decls:2,vars:1,consts:[[1,"animated","fadeInRight","p-3"],["class","card-pedido fs-13",4,"ngIf"],[1,"card-pedido","fs-13"],[1,"card-pedido-head","mb-2","border-bottom","d-flex","justify-content-between"],[1,"fw-600"],[1,""],[1,"border-bottom","mb-2","d-flex","justify-content-between"],[1,"border-bottom","fw-600","mb-2","d-flex","justify-content-between"],[1,"d-flex","justify-content-between"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Cc(1,K,50,15,"div",1),u.Tb()),2&e&&(u.Cb(1),u.mc("ngIf",i.listResumen))},directives:[n.m],pipes:[n.e],styles:[".card-pedido[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;padding:15px;background-color:#eee}.card-pedido-head[_ngcontent-%COMP%]{align-items:center;margin-bottom:3px}.card-pedido-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}"]}),Q),Y=t("bv9b");function Z(e,i){if(1&e&&(u.Sb(0),u.Pb(1,"mat-progress-bar",1),u.hc(2,"async"),u.Rb()),2&e){var t=u.gc();u.Cb(1),u.mc("value",u.ic(2,1,t.timerLimitService.countdown$))}}var X,ee=((X=function(){function e(i){_classCallCheck(this,e),this.timerLimitService=i}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||X)(u.Ob(H))},X.\u0275cmp=u.Ib({type:X,selectors:[["app-progress-time-limit"]],decls:2,vars:3,consts:[[4,"ngIf"],["mode","determinate","color","accent",1,"animated","fadeInDown",3,"value"]],template:function(e,i){1&e&&(u.Cc(0,Z,3,3,"ng-container",0),u.hc(1,"async")),2&e&&u.mc("ngIf",u.ic(1,1,i.timerLimitService.isPorgressVisible$))},directives:[n.m,Y.a],pipes:[n.b],styles:[""]}),X);function ie(e,i){1&e&&u.Pb(0,"img",13)}var te,oe,ae=((oe=function(){function e(i,t){_classCallCheck(this,e),this.timerLimitService=i,this.pedidoRepartidorService=t,this.aceptaPedido=new u.o,this.estadoPedido=0,this.countPedidos=0,this.sumGananciaTotal=0,this.sumKmRecorrer=0,this.isHayPropina=!1}return _createClass(e,[{key:"ngOnChanges",value:function(){console.log(this.listPedidos)}},{key:"ngOnInit",value:function(){this.leerInfoGroup()}},{key:"leerInfoGroup",value:function(){var e=this;this.pedidoRepartidorService.init(),this.estadoPedido=this.pedidoRepartidorService.pedidoRepartidor.estado?this.pedidoRepartidorService.pedidoRepartidor.estado:this.listPedidos[0].estado,this.countPedidos=this.listPedidos.length,this.establecimientoOrden=this.listPedidos[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento,this.listPedidos.map((function(i){var t=i.json_datos_delivery.p_header.arrDatosDelivery.propina.value?parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.propina.value):0;e.sumGananciaTotal+=parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery)+t,e.sumKmRecorrer+=parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.c_km),e.isHayPropina||(e.isHayPropina=i.json_datos_delivery.p_header.arrDatosDelivery.propina.value>0)})),this.pedidoRepartidorService.pedidoRepartidor.sumGananciaTotal=this.sumGananciaTotal,this.pedidoRepartidorService.setLocal(),this.showPedido()}},{key:"showPedido",value:function(){var e=this;0===this.pedidoRepartidorService.pedidoRepartidor.pedido_paso_va&&(this.timerLimitService.isPlayTimer=!1,this.timerLimitService.playCountTimerLimit(),this.timerLimitService.isTimeLimitComplet$.subscribe((function(i){i&&0===e.estadoPedido&&e.timerLimitService.stopCountTimerLimit()})))}},{key:"aceptarPedido",value:function(){0===this.pedidoRepartidorService.pedidoRepartidor.pedido_paso_va&&(this.estadoPedido=1,this.pedidoRepartidorService.pedidoRepartidor.pedido_paso_va=1,this.pedidoRepartidorService.setPedidoPasoVa(1)),this.pedidoRepartidorService.asignarPedido(),this.pedidoRepartidorService.pedidoRepartidor.aceptado=!0,this.aceptaPedido.emit(this.establecimientoOrden)}}]),e}()).\u0275fac=function(e){return new(e||oe)(u.Ob(H),u.Ob(P.a))},oe.\u0275cmp=u.Ib({type:oe,selectors:[["app-item-pedido"]],inputs:{listPedidos:"listPedidos",importeAcumuladoPagar:"importeAcumuladoPagar"},outputs:{aceptaPedido:"aceptaPedido"},features:[u.Ab],decls:46,vars:19,consts:[[1,"animated","fadeInUp","card-pedido"],[1,"card-pedido-head","border-bottom","pb-2","d-flex","justify-content-between"],[1,"fw-600","text-secondary","fs-13","pr-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-arrow-right","pl-2"],[1,"card-pedido-timer"],[1,"card-pedido-body"],[1,"pt-3","fs-13"],[1,"fw-100"],[1,"fs-14"],[1,"d-flex","justify-content-between","fs-13","text-center"],[1,"fs-15","fw-600"],["class","img-propina","src","assets/images/r-propina-coin.png","alt","img-propina",4,"ngIf"],["src","assets/images/r-propina-coin.png","alt","img-propina",1,"img-propina"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div"),u.Ub(3,"span"),u.Ec(4),u.hc(5,"number"),u.Tb(),u.Tb(),u.Ub(6,"div"),u.Ub(7,"span",2),u.Ec(8),u.hc(9,"async"),u.Tb(),u.Ub(10,"button",3),u.cc("click",(function(){return i.aceptarPedido()})),u.Ub(11,"div"),u.Ec(12," Listo vamos "),u.Pb(13,"i",4),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(14,"div",5),u.Pb(15,"app-progress-time-limit"),u.Tb(),u.Ub(16,"div",6),u.Ub(17,"div",7),u.Ub(18,"p",8),u.Ec(19,"Comercio : "),u.Ub(20,"span",9),u.Ec(21),u.Tb(),u.Tb(),u.Ub(22,"p",8),u.Ec(23,"Direccion : "),u.Ub(24,"span",9),u.Ec(25),u.Tb(),u.Tb(),u.Tb(),u.Pb(26,"hr"),u.Ub(27,"div",10),u.Ub(28,"div"),u.Ub(29,"p",8),u.Ec(30,"Distancia"),u.Tb(),u.Ub(31,"span",11),u.Ec(32),u.Tb(),u.Tb(),u.Ub(33,"div"),u.Ub(34,"p",8),u.Ec(35,"Importe Pagar"),u.Tb(),u.Ub(36,"span",11),u.Ec(37),u.hc(38,"number"),u.Tb(),u.Tb(),u.Ub(39,"div"),u.Ub(40,"p",8),u.Ec(41,"Ganancia"),u.Tb(),u.Cc(42,ie,1,0,"img",12),u.Ub(43,"span",11),u.Ec(44),u.hc(45,"number"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Cb(4),u.Gc("Pedidos (",u.jc(5,8,i.countPedidos,"2."),")"),u.Cb(4),u.Gc(" ",u.ic(9,11,i.timerLimitService.countTime$),"''"),u.Cb(13),u.Fc(i.establecimientoOrden.nombre),u.Cb(4),u.Fc(i.establecimientoOrden.direccion),u.Cb(7),u.Gc("",i.sumKmRecorrer," Km"),u.Cb(5),u.Gc("S/. ",u.jc(38,13,i.importeAcumuladoPagar,".2"),""),u.Cb(5),u.mc("ngIf",i.isHayPropina),u.Cb(2),u.Gc("S/. ",u.jc(45,16,i.sumGananciaTotal,"0.2"),""))},directives:[ee,n.m],pipes:[n.e,n.b],styles:[".card-pedido[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;padding:15px;background-color:#eee}.card-pedido-head[_ngcontent-%COMP%]{align-items:center;margin-bottom:3px}.card-pedido-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.img-propina[_ngcontent-%COMP%]{width:20px;padding-right:5px}"]}),oe),ne=((te=function(){function e(i){switch(_classCallCheck(this,e),this.msj="",this.titleBtnCancel="No",this.titleBtnSuccess="Si, por favor",i?i.idMjs:0){case 0:this.msj="Desea que se le notifique cuando su pedido este listo?";break;case 1:this.msj="Desea saber cuando tenga descuentos y/o ofertas?";break;case 2:this.msj="Seguro de finalizar el pedido?"}}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||te)(u.Ob(r.a))},te.\u0275cmp=u.Ib({type:te,selectors:[["app-dialog-desicion"]],decls:10,vars:4,consts:[[1,"p-3"],[1,"fw-100","fs-15"],["mat-flat-button","","color","primary",3,"mat-dialog-close"],["mat-stroked-button","","mat-dialog-close","",1,"ml-1"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"span",1),u.Ec(2),u.Tb(),u.Pb(3,"hr"),u.Ub(4,"mat-dialog-actions"),u.Ub(5,"button",2),u.Ec(6),u.Tb(),u.Ub(7,"button",3),u.Ec(8),u.Tb(),u.Tb(),u.Pb(9,"br"),u.Tb()),2&e&&(u.Cb(2),u.Fc(i.msj),u.Cb(3),u.mc("mat-dialog-close",!0),u.Cb(1),u.Fc(i.titleBtnSuccess),u.Cb(2),u.Fc(i.titleBtnCancel))},directives:[r.c,v.a,r.d],styles:[""]}),te);function se(e,i){1&e&&(u.Ub(0,"span",23),u.Pb(1,"i",24),u.Tb())}function re(e,i){if(1&e&&(u.Ub(0,"p",25),u.Ec(1),u.Tb()),2&e){var t=u.gc(2);u.Cb(1),u.Fc(t.desde_referencia)}}function ce(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",22),u.cc("click",(function(){return u.wc(t),u.gc().irRuta(1)})),u.Ub(1,"p",2),u.Ec(2,"De donde: "),u.Cc(3,se,2,0,"span",15),u.Tb(),u.Ub(4,"p",5),u.Ec(5),u.Tb(),u.Cc(6,re,2,1,"p",16),u.Ub(7,"button",17),u.cc("click",(function(){return u.wc(t),u.gc().irRuta(1)})),u.Ec(8," Ver ruta "),u.Tb(),u.Tb()}if(2&e){var o=u.gc();u.Cb(3),u.mc("ngIf",o.goRutaDesde),u.Cb(2),u.Fc(o.desde),u.Cb(1),u.mc("ngIf",o.desde_referencia)}}function de(e,i){1&e&&(u.Ub(0,"span",23),u.Pb(1,"i",24),u.Tb())}function le(e,i){if(1&e&&(u.Ub(0,"p",25),u.Ec(1),u.Tb()),2&e){var t=u.gc();u.Cb(1),u.Fc(t.hasta_referencia)}}var pe,be=((pe=function(){function e(i,t){_classCallCheck(this,e),this.geoPositionService=i,this.dialog=t,this.pedidoEntregado=new u.o,this.metodoPago="",this.desde="",this.hasta="",this.desde_referencia="",this.hasta_referencia="",this.descripcion_pedido="",this.nomCliente="",this.telCliente="",this.isPagoYape=!1,this.isPedidoExpress=!1,this.isRetiroAtm=!1,this.goRutaHasta=!1,this.goRutaDesde=!1,this.sumKmRecorrer="",this.importe=0,this.numPedido=0}return _createClass(e,[{key:"ngOnInit",value:function(){var e,i,t,o;if(this.isPedidoExpress=1===(null===(e=this.elpedido.pedido_json)||void 0===e?void 0:e.is_express),this.isRetiroAtm=1===(null===(i=this.elpedido)||void 0===i?void 0:i.isretiroatm)||!!(null===(t=this.elpedido)||void 0===t?void 0:t.idatm_retiros),(null===(o=this.elpedido)||void 0===o?void 0:o.isretiroatm)&&(this.elpedido.idpedido_mandado=this.elpedido.idatm_retiros),this.isRetiroAtm)return this.metodoPago="Tarjeta",this.descripcion_pedido="Solicita retiro de dinero en efectivo S/."+parseFloat(this.elpedido.importe_solicita).toFixed(2),this.nomCliente=this.elpedido.json_entrega.cliente.nombres,this.telCliente=this.elpedido.json_entrega.cliente.telefono,this.numPedido=this.elpedido.idatm_retiros,this.desde="",this.dirHasta=this.elpedido.json_entrega.direccion,this.hasta=this.elpedido.json_entrega.direccion.direccion,this.hasta_referencia=this.elpedido.json_entrega.direccion.referencia,this.goRutaHasta=!0,this.importe=this.elpedido.c_entrega,void(this.sumKmRecorrer="");this.isPagoYape=3===this.elpedido.pedido_json.metodoPago.idtipo_pago,this.metodoPago=this.isPagoYape?"Yape":"Efectivo ".concat(this.elpedido.pedido_json.metodoPago.importe),this.descripcion_pedido=this.isPedidoExpress?this.elpedido.pedido_json.descripcion_paquete:this.elpedido.pedido_json.que_compramos,this.nomCliente=this.elpedido.nom_cliente,this.telCliente=this.elpedido.telefono,this.numPedido=this.elpedido.idpedido_mandado,this.isPedidoExpress?(this.dirDesde=this.elpedido.pedido_json.direccionA,this.desde=this.dirDesde.direccion,this.desde_referencia=this.dirDesde.referencia,this.dirHasta=this.elpedido.pedido_json.direccionB,this.hasta=this.dirHasta.direccion,this.hasta_referencia=this.dirHasta.referencia,this.goRutaDesde=!0,this.goRutaHasta=!0):(this.desde=this.elpedido.pedido_json.donde_compramos,this.desde_referencia=null,this.dirHasta=this.elpedido.pedido_json.direccionCliente,this.hasta=this.dirHasta.direccion,this.hasta_referencia=this.dirHasta.referencia,this.goRutaDesde=!1,this.goRutaHasta=!0),this.sumKmRecorrer=this.elpedido.pedido_json.distancia_km,this.importe=this.elpedido.pedido_json.importe_pagar}},{key:"irRuta",value:function(e){this.geoPositionService.get(),this.geoPositionActual=this.geoPositionService.getGeoPosition(),1===e?window.open("http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.dirHasta.latitude,",").concat(this.dirHasta.longitude),"_blank"):this.goRutaDesde&&window.open("http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.dirDesde.latitude,",").concat(this.dirDesde.longitude),"_blank")}},{key:"finalizarPedidoExpress",value:function(){var e=this,i=new r.e;i.disableClose=!0,i.hasBackdrop=!0,i.data={idMjs:2},console.log("show dialog DialogDesicionComponent"),this.dialog.open(ne,i).afterClosed().subscribe((function(i){i&&(console.log("aaaaaaaaaaaaaaaaaaaaaaaaa"),e.isRetiroAtm&&(e.elpedido.idpedido_mandado=e.elpedido.idatm_retiros),e.pedidoEntregado.emit(e.elpedido))}))}},{key:"redirectWhatsApp",value:function(){window.open("https://api.whatsapp.com/send?phone=51".concat(this.elpedido.telefono),"_blank")}},{key:"callPhone",value:function(){window.open("tel:".concat(this.elpedido.telefono))}}]),e}()).\u0275fac=function(e){return new(e||pe)(u.Ob(d.a),u.Ob(r.b))},pe.\u0275cmp=u.Ib({type:pe,selectors:[["app-item-pedido-express"]],inputs:{elpedido:"elpedido"},outputs:{pedidoEntregado:"pedidoEntregado"},decls:58,vars:14,consts:[[1,"animated","fadeInUp","card-pedido"],[1,"card-pedido-head","border-bottom","pb-2","d-flex","justify-content-between","align-items-center"],[1,"fs-11","fw-600","text-secondary"],[1,"card-pedido-body"],[1,"pt-3","fs-13"],[1,"fw-100"],[1,"fw-600"],[1,"d-flex","justify-content-between","mt-2"],["matRipple","",1,"col-6","border-right","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-phone"],["matRipple","",1,"col-6","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-commenting-o"],[1,"fw-100","fw-600","fs-15"],["matRipple","",3,"click",4,"ngIf"],["matRipple","",1,"d-flex","justify-content-between",3,"click"],["class","pl-2",4,"ngIf"],["class","fw-100 text-secondary",4,"ngIf"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"d-flex","justify-content-between","fs-13","text-center"],[1,"fs-15","fw-600"],[1,"w-100","text-center"],[1,"btn","btn-success",3,"click"],["matRipple","",3,"click"],[1,"pl-2"],[1,"fa","fa-arrow-right","text-success"],[1,"fw-100","text-secondary"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"span"),u.Ec(3),u.Tb(),u.Ub(4,"span",2),u.Ec(5),u.Tb(),u.Tb(),u.Ub(6,"div",3),u.Ub(7,"div",4),u.Ub(8,"p",2),u.Ec(9,"Cliente: "),u.Tb(),u.Ub(10,"p",5),u.Ec(11),u.Tb(),u.Ub(12,"p"),u.Ec(13,"Telefono: "),u.Ub(14,"span",6),u.Ec(15),u.Tb(),u.Tb(),u.Ub(16,"div",7),u.Ub(17,"div",8),u.cc("click",(function(){return i.callPhone()})),u.Pb(18,"i",9),u.Ec(19," LLamar"),u.Tb(),u.Ub(20,"div",10),u.cc("click",(function(){return i.redirectWhatsApp()})),u.Pb(21,"i",11),u.Ec(22," Enviar Mensaje"),u.Tb(),u.Tb(),u.Pb(23,"hr"),u.Ub(24,"p",2),u.Ec(25,"Pedido: "),u.Tb(),u.Ub(26,"p",12),u.Ec(27),u.Tb(),u.Pb(28,"hr"),u.Cc(29,ce,9,3,"div",13),u.Pb(30,"hr"),u.Ub(31,"div",14),u.cc("click",(function(){return i.irRuta(1)})),u.Ub(32,"div"),u.Ub(33,"p",2),u.Ec(34,"A donde lo llevamos: "),u.Cc(35,de,2,0,"span",15),u.Tb(),u.Ub(36,"p",5),u.Ec(37),u.Tb(),u.Cc(38,le,2,1,"p",16),u.Tb(),u.Ub(39,"button",17),u.cc("click",(function(){return i.irRuta(1)})),u.Ec(40," Ver ruta "),u.Tb(),u.Tb(),u.Pb(41,"hr"),u.Ub(42,"div",18),u.Ub(43,"div"),u.Ub(44,"p",5),u.Ec(45,"Distancia"),u.Tb(),u.Ub(46,"span",19),u.Ec(47),u.Tb(),u.Tb(),u.Ub(48,"div"),u.Ub(49,"p",5),u.Ec(50,"Costo de entrega"),u.Tb(),u.Ub(51,"span",19),u.Ec(52),u.hc(53,"number"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Pb(54,"hr"),u.Ub(55,"div",20),u.Ub(56,"button",21),u.cc("click",(function(){return i.finalizarPedidoExpress()})),u.Ec(57," Listo, pedido entregado."),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Cb(3),u.Gc("Pedidos Express #",i.numPedido,""),u.Cb(2),u.Gc("Paga con: ",i.metodoPago,""),u.Cb(6),u.Gc(" ",i.nomCliente," "),u.Cb(4),u.Gc(" ",i.telCliente," "),u.Cb(12),u.Gc(" ",i.descripcion_pedido," "),u.Cb(2),u.mc("ngIf",""!==i.desde),u.Cb(6),u.mc("ngIf",i.goRutaHasta),u.Cb(2),u.Fc(i.hasta),u.Cb(1),u.mc("ngIf",i.hasta_referencia),u.Cb(9),u.Gc("",i.sumKmRecorrer," Km"),u.Cb(5),u.Gc("S/. ",u.jc(53,11,i.importe,".2"),""))},directives:[A.e,n.m],pipes:[n.e],styles:[".card-pedido[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;padding:15px;background-color:#eee}.card-pedido-head[_ngcontent-%COMP%]{margin-bottom:3px}.card-pedido-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.img-propina[_ngcontent-%COMP%]{width:20px;padding-right:5px}"]}),pe);function ue(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",13),u.Ub(1,"button",14),u.cc("click",(function(){return u.wc(t),u.gc(2).recargarPedido()})),u.Ec(2,"Recargar ..."),u.Tb(),u.Pb(3,"br"),u.Pb(4,"br"),u.Ub(5,"button",15),u.cc("click",(function(){return u.wc(t),u.gc(2).goScanCodeBar()})),u.Pb(6,"i",16),u.Ec(7," Escanear codigo barras"),u.Tb(),u.Tb()}}function he(e,i){if(1&e&&(u.Sb(0),u.Cc(1,ue,8,0,"div",12),u.Rb()),2&e){var t=u.gc();u.Cb(1),u.mc("ngIf",!t.isExpress)}}function fe(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div"),u.Ub(1,"app-item-pedido",17),u.cc("aceptaPedido",(function(e){return u.wc(t),u.gc().aceptaPedido(e)})),u.Tb(),u.Tb()}if(2&e){var o=u.gc();u.Cb(1),u.mc("listPedidos",o.listPedidosGroup)("importeAcumuladoPagar",o.sumAcumuladoPagar)}}function ve(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",19),u.Ub(1,"app-item-pedido-express",20),u.cc("pedidoEntregado",(function(e){return u.wc(t),u.gc(2).pedidoExpressEntregado(e)})),u.Tb(),u.Tb()}if(2&e){var o=i.$implicit;u.Cb(1),u.mc("elpedido",o)}}function me(e,i){if(1&e&&(u.Ub(0,"div"),u.Cc(1,ve,2,1,"div",18),u.Tb()),2&e){var t=u.gc();u.Cb(1),u.mc("ngForOf",t.pedido_express)}}var ge,Pe,Ce=((ge=function(){function e(i,t,o,a,n,s,r,c){_classCallCheck(this,e),this.infoTokenService=i,this.socketService=t,this.pedidoRepartidorService=o,this.router=a,this.listenService=n,this.timerLimitService=s,this.geoPositionService=r,this.repartidorServcice=c,this.efectivoMano=0,this.listPedidos=[],this.listPedidosGroup=[],this._tabIndex=0,this.sumAcumuladoPagar=0,this.isExpress=!1,this.yaQuitoPedido=0,this.destroy$=new C.Subject,this.unsubscribeSocket=new B.Subscription,this.unsubscribeSocketClearPedido=new B.Subscription}return _createClass(e,[{key:"ngOnInit",value:function(){this.efectivoMano=this.infoTokenService.infoUsToken.efectivoMano,this.listenService.setEfectivoMano(this.efectivoMano)}},{key:"ngAfterViewInit",value:function(){this.geoPositionService.onGeoPosition(),this.geoPositionService.onGeoWatchPosition(),this.listenPedidos()}},{key:"ngOnDestroy",value:function(){this.unsubscribeSocket.unsubscribe(),this.unsubscribeSocketClearPedido.unsubscribe(),this.destroy$.next(!0),this.destroy$.unsubscribe()}},{key:"listenPedidos",value:function(){var e=this;this.listenService.efectivoManoMano$.subscribe((function(i){e.efectivoMano=0===i?e.infoTokenService.infoUsToken.efectivoMano:i})),this.pedidoRepartidor=this.pedidoRepartidorService.pedidoRepartidor,this.unsubscribeSocket=this.socketService.onRepartidorGetPedidoPendienteAceptar().subscribe((function(i){if(console.log("repartidor-get-pedido-pendiente-aceptar",i[0]),e.dataPedidos=i[0].pedido_por_aceptar,e.isExpress=!(!e.dataPedidos||!e.dataPedidos.isexpress&&!e.dataPedidos.isretiroatm||1!==e.dataPedidos.isexpress&&1!==e.dataPedidos.isretiroatm),e.pedidoRepartidorService.setPedidoPorAceptar(e.dataPedidos),!e.isExpress)return null===e.dataPedidos||1===i[0].solicita_liberar_pedido?(e.listPedidosGroup=[],e.pedidoRepartidorService.cleanLocal(),void e.timerLimitService.stopCountTimerLimit()):void(e.dataPedidos&&(e.dataPedidos.pedido_paso_va=i[0].pedido_paso_va,e.yaQuitoPedido=2,e.pedidoRepartidorService.setPedidoPasoVa(e.dataPedidos.pedido_paso_va),e.darFormatoGrupoPedidosRecibidos(e.dataPedidos)));e.showPedidoExpress()})),this.unsubscribeSocket=this.socketService.onRepartidorNuevoPedido().subscribe((function(i){var t=i[1];e.yaQuitoPedido=1,e.pedidoRepartidorService.setPedidoPasoVa(0),e.pedidoRepartidorService.setPedidoPorAceptar(t),e.darFormatoGrupoPedidosRecibidos(t)})),this.unsubscribeSocketClearPedido=this.socketService.onRepartidorServerQuitaPedido().subscribe((function(i){1===e.yaQuitoPedido&&(e.pedidoRepartidorService.setPedidoPasoVa(0),e.pedidoRepartidorService.setPasoVa(0),e.pedidoRepartidorService.setPedidoPorAceptar(null),e.listPedidosGroup=[],e.pedidoRepartidorService.cleanLocal(),e.timerLimitService.stopCountTimerLimit(),e.yaQuitoPedido=0)}))}},{key:"darFormatoGrupoPedidosRecibidos",value:function(e){var i=this;e&&(this.sumAcumuladoPagar=e.importe_pagar,this.pedidoRepartidorService.loadPedidosRecibidos(e.pedidos.join(",")).subscribe((function(t){var o,a=t.map((function(e){return e.json_datos_delivery=JSON.parse(e.json_datos_delivery),o=0===(o=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal))?parseFloat(e.json_datos_delivery.p_subtotales[e.json_datos_delivery.p_subtotales.length-1].importe):o,e.importe_pagar_comercio=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal)-parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery),e.importe_pagar_comercio=2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago?0:e.importe_pagar_comercio,e}));i.listPedidosGroup=JSON.parse(JSON.stringify(a)),i.pedidoRepartidorService.setLocalIds(e),i.pedidoRepartidorService.setLocalItems(i.listPedidosGroup),i.pedidoRepartidorService.playAudioNewPedido()})))}},{key:"showPedidoExpress",value:function(){this.pedido_express=this.dataPedidos.pedidos}},{key:"aceptaPedido",value:function(e){console.log("this.dataPedidos",e),this.socketService.emit("repartidor-acepta-pedido",e),this.pedidoRepartidorService.pedidoRepartidor.aceptado||(this.positionNow=this.geoPositionService.get(),this.dataPedidos.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,this.dataPedidos.nombre=this.infoTokenService.infoUsToken.usuario.nombre,this.dataPedidos.apellido=this.infoTokenService.infoUsToken.usuario.apellido,this.dataPedidos.telefono=this.infoTokenService.infoUsToken.usuario.telefono,this.dataPedidos.position_now=this.positionNow,this.pedidoRepartidorService.pedidoRepartidor.aceptado=!0,this.pedidoRepartidorService.setLocal()),this.router.navigate(["./main/list-grupo-pedidos"])}},{key:"clickTab",value:function(e){console.log("$event.index",e.index),this._tabIndex=e.index}},{key:"recargarPedido",value:function(){location.reload()}},{key:"goScanCodeBar",value:function(){this.router.navigate(["./main/mapa-de-pedidos"])}},{key:"pedidoExpressEntregado",value:function(e){console.log("finaliza el pedido"),e.quitar=!0,this.quitarPedidoExpress(e.idpedido_mandado),this.pedidoRepartidorService.finalizarPedidoExpress(e,this.dataPedidos)}},{key:"quitarPedidoExpress",value:function(e){this.pedido_express=this.pedido_express.filter((function(i){return i.idpedido_mandado!==e})),this.dataPedidos.pedidos=this.pedido_express,0===this.pedido_express.length&&(this.isExpress=!1,this.pedido_express=null,this.pedidoRepartidorService.cleanLocal())}}]),e}()).\u0275fac=function(e){return new(e||ge)(u.Ob(l.a),u.Ob(g.a),u.Ob(P.a),u.Ob(s.b),u.Ob(b.a),u.Ob(H),u.Ob(d.a),u.Ob(p.a))},ge.\u0275cmp=u.Ib({type:ge,selectors:[["app-pedidos"]],decls:20,vars:8,consts:[[1,"animated","fadeInDown"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"w-100"],["mat-stretch-tabs","",3,"selectedTabChange"],["label","Pendientes"],[1,"p-3","x-h-size"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[4,"ngIf"],["label","Entregados"],[1,"x-h-size"],[3,"tabIndex"],["class","text-center",4,"ngIf"],[1,"text-center"],["mat-stroked-button","",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"fa","fa-barcode","pr-"],[3,"listPedidos","importeAcumuladoPagar","aceptaPedido"],["class","mb-3 animated fadeInDown",4,"ngFor","ngForOf"],[1,"mb-3","animated","fadeInDown"],[3,"elpedido","pedidoEntregado"]],template:function(e,i){if(1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div"),u.Ub(3,"span"),u.Ec(4,"Efectivo en mano"),u.Tb(),u.Tb(),u.Ub(5,"div"),u.Ub(6,"span"),u.Ec(7),u.hc(8,"number"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(9,"div",2),u.Ub(10,"mat-tab-group",3),u.cc("selectedTabChange",(function(e){return i.clickTab(e)})),u.Ub(11,"mat-tab",4),u.Ub(12,"div",5),u.Cc(13,he,2,1,"ng-container",6),u.Cc(14,fe,2,2,"ng-template",null,7,u.Dc),u.Cc(16,me,2,1,"div",8),u.Tb(),u.Tb(),u.Ub(17,"mat-tab",9),u.Ub(18,"div",10),u.Pb(19,"app-pedidos-atendidos",11),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e){var t=u.vc(15);u.Cb(7),u.Gc("S/. ",u.jc(8,5,i.efectivoMano,".2"),""),u.Cb(6),u.mc("ngIf",0===i.listPedidosGroup.length)("ngIfElse",t),u.Cb(3),u.mc("ngIf",i.isExpress),u.Cb(3),u.mc("tabIndex",i._tabIndex)}},directives:[W.b,W.a,n.m,J,v.a,ae,n.l,be],pipes:[n.e],styles:[".x-h-size[_ngcontent-%COMP%]{height:calc(100vh - 155px)}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}.btn-footer[_ngcontent-%COMP%]{padding:15px;display:flex;justify-content:center;align-items:center}"]}),ge),ye=t("VhxH"),_e=((Pe=function(){function e(){_classCallCheck(this,e),this.directionsService=new google.maps.DirectionsService,this.origin={},this.destination={}}return _createClass(e,[{key:"calculateRoute",value:function(e,i){var t=i.c_minimo,o=i.c_km;this.origin={lat:e.latitude,lng:e.longitude},this.destination={lat:i.latitude,lng:i.longitude};var a={origin:this.origin,destination:this.destination,travelMode:google.maps.TravelMode.DRIVING},n=0;return this.directionsService.route(a,(function(e,a){"OK"===a&&(n=e.routes[0].legs[0].distance.value,(n=parseInt((n/1e3).toFixed(),0))>1&&(t=(n-1)*o+t,i.c_servicio=t))})),setTimeout((function(){return i.c_servicio=t,t}),500),i.c_servicio=t,t}},{key:"calcDistancia",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;i.latitude="string"==typeof i.latitude?parseFloat(i.latitude):i.latitude,i.longitude="string"==typeof i.longitude?parseFloat(i.longitude):i.longitude;var o={lat:i.latitude,lon:i.longitude};return Object(ye.insideCircle)({lat:e.latitude,lon:e.longitude},o,t)}},{key:"reglaKm",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Pe)},Pe.\u0275prov=u.Kb({token:Pe,factory:Pe.\u0275fac,providedIn:"root"}),Pe),Te=t("IW2O"),ke=function e(){_classCallCheck(this,e)},we=t("ojS6");function Se(e,i){if(1&e&&(u.Ub(0,"div"),u.Ub(1,"span",5),u.Ec(2),u.Tb(),u.Tb()),2&e){var t=u.gc(2);u.Cb(2),u.Gc(" ",t.dataCalificado.titulo," ")}}function Ue(e,i){if(1&e&&(u.Ub(0,"div"),u.Ub(1,"span",6),u.Ec(2),u.Tb(),u.Pb(3,"br"),u.Pb(4,"br"),u.Tb()),2&e){var t=u.gc(2);u.Cb(2),u.Fc(t.dataCalificado.nombre)}}function Re(e,i){if(1&e){var t=u.Vb();u.Sb(0),u.Ub(1,"div",2),u.Cc(2,Se,3,1,"div",3),u.Cc(3,Ue,5,1,"div",3),u.Tb(),u.Ub(4,"star-rating",4),u.cc("ratingChange",(function(e){return u.wc(t),u.gc().onRatingChange(e)})),u.Tb(),u.Rb()}if(2&e){var o=u.gc();u.Cb(2),u.mc("ngIf",o.dataCalificado.showTitulo),u.Cb(1),u.mc("ngIf",o.dataCalificado.showNombre),u.Cb(1),u.mc("starType","svg")}}function De(e,i){1&e&&(u.Ub(0,"div",7),u.Ub(1,"span"),u.Ec(2," Muchas gracias, su calificaci\xf3n se tomara en cuenta."),u.Tb(),u.Pb(3,"hr"),u.Ub(4,"button",8),u.Ec(5,"Ok"),u.Tb(),u.Tb())}var xe,Ee,Oe=((Ee=function(){function e(i){_classCallCheck(this,e),this.crudService=i,this.countFin=2,this.intervalConteo=null}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onRatingChange",value:function(e){console.log("calificacion",e),this.dataCalificado.calificacion=e.rating,this.dataCalificado.showMsjTankyou&&(this.countFin=2,this.cuentaRegresivaCalificacion())}},{key:"cuentaRegresivaCalificacion",value:function(){this.countFin<=0?(this.intervalConteo=null,this.guardarCalificacion()):this.conteoFinEncuesta()}},{key:"conteoFinEncuesta",value:function(){var e=this;this.intervalConteo=setTimeout((function(){e.countFin--,e.cuentaRegresivaCalificacion()}),1e3)}},{key:"guardarCalificacion",value:function(){this.crudService.postFree({dataCalificacion:this.dataCalificado},"delivery","calificar-servicio",!1).subscribe((function(e){return console.log(e)}))}}]),e}()).\u0275fac=function(e){return new(e||Ee)(u.Ob(q.a))},Ee.\u0275cmp=u.Ib({type:Ee,selectors:[["app-comp-calificacion"]],inputs:{dataCalificado:"dataCalificado"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["msjAgradece",""],[1,"text-center"],[4,"ngIf"],["size","large","speed","slow",3,"starType","ratingChange"],[1,"fw-600","fs-13","text-secondary"],[1,"fs-15"],[1,"text-center","fs-18","fw-100"],["mat-flat-button","","color","primary","mat-dialog-close",""]],template:function(e,i){if(1&e&&(u.Cc(0,Re,5,3,"ng-container",0),u.Cc(1,De,6,0,"ng-template",null,1,u.Dc)),2&e){var t=u.vc(2);u.mc("ngIf",i.countFin>0)("ngIfElse",t)}},directives:[n.m,we.a,v.a,r.d],styles:[""]}),Ee),Ie=((xe=function(){function e(i){_classCallCheck(this,e),this._dataCalificado=i.dataCalificado}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||xe)(u.Ob(r.a))},xe.\u0275cmp=u.Ib({type:xe,selectors:[["app-dialog-calificacion"]],decls:2,vars:1,consts:[[1,"p-2"],[3,"dataCalificado"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Pb(1,"app-comp-calificacion",1),u.Tb()),2&e&&(u.Cb(1),u.mc("dataCalificado",i._dataCalificado))},directives:[Oe],styles:[""]}),xe),je=t("+XMS"),Ae=t("pxUr"),Fe=function(){return{height:25,width:25}},Me=function(e){return{url:"./assets/images/delivery-man.png",scaledSize:e}};function Le(e,i){if(1&e&&u.Pb(0,"agm-marker",4),2&e){var t=u.gc(2);u.mc("latitude",t.miPosition.lat)("longitude",t.miPosition.lng)("label",t.Repartidor)("iconUrl",u.rc(5,Me,u.qc(4,Fe)))}}function Ge(e,i){if(1&e&&(u.Ub(0,"agm-map",1),u.Pb(1,"agm-marker",2),u.Cc(2,Le,1,7,"agm-marker",3),u.Tb()),2&e){var t=u.gc();u.mc("latitude",t.coordenadas.latitude)("longitude",t.coordenadas.longitude)("zoom",t.coordenadas.zoom),u.Cb(1),u.mc("latitude",t.coordenadas.latitude)("longitude",t.coordenadas.longitude)("markerDraggable",!1),u.Cb(1),u.mc("ngIf",t.miPosition)}}var Ve,Ne=((Ve=function(){function e(i,t,o,a,n){_classCallCheck(this,e),this.mapsAPILoader=i,this.socketService=t,this.pedidoRepartidorService=o,this.repartidorService=a,this.geoUbicationService=n,this.bounds=null}return _createClass(e,[{key:"ngOnInit",value:function(){this.coordenadas.zoom=15,console.log("mapa solo",this.coordenadas),this.idSedeDesarrollo=this.pedidoRepartidorService.pedidoRepartidor.datosComercio.idsede,this.geoUbicationService.onGeoPosition(),this.miPosition=this.geoUbicationService.geoPosition,this.miPosition={lat:this.miPosition.latitude,lng:this.miPosition.longitude},this.listenUbicaion()}},{key:"markerDragEnd",value:function(e){var i={latitude:e.coords.lat,longitude:e.coords.lng};this.geoUbicationService.geoPosition=i,this.repartidorService.emitPositionNow(i,this.pedidoRepartidorService.pedidoRepartidor,this.idSedeDesarrollo)}},{key:"listenUbicaion",value:function(){var e=this;this.geoUbicationService.onGeoWatchPosition(),this.geoUbicationService.geoPositionNow$.subscribe((function(i){e.miPosition={lat:i.latitude,lng:i.longitude};var t=new je.a;t.latitude=e.miPosition.lat,t.longitude=e.miPosition.lng,e.geoUbicationService.geoPosition=t,e.geoUbicationService.set(),e.repartidorService.emitPositionNow(e.miPosition,e.pedidoRepartidorService.pedidoRepartidor,e.idSedeDesarrollo)}))}}]),e}()).\u0275fac=function(e){return new(e||Ve)(u.Ob(Ae.d),u.Ob(g.a),u.Ob(P.a),u.Ob(p.a),u.Ob(d.a))},Ve.\u0275cmp=u.Ib({type:Ve,selectors:[["app-mapa-solo"]],inputs:{coordenadas:"coordenadas"},decls:1,vars:1,consts:[[3,"latitude","longitude","zoom",4,"ngIf"],[3,"latitude","longitude","zoom"],[3,"latitude","longitude","markerDraggable"],[3,"latitude","longitude","label","iconUrl",4,"ngIf"],[3,"latitude","longitude","label","iconUrl"]],template:function(e,i){1&e&&u.Cc(0,Ge,3,7,"agm-map",0),2&e&&u.mc("ngIf",i.coordenadas)},directives:[n.m,Ae.b,Ae.c],styles:["agm-map[_ngcontent-%COMP%]{height:200px}"]}),Ve);function ze(e,i){1&e&&(u.Ub(0,"div"),u.Pb(1,"hr"),u.Ub(2,"p",19),u.Ec(3,"Ver detalle del pedido."),u.Tb(),u.Tb())}function $e(e,i){if(1&e&&(u.Ub(0,"p",9),u.Ub(1,"span",14),u.Ec(2,"Referencia: "),u.Tb(),u.Ec(3),u.Tb()),2&e){var t=u.gc();u.Cb(3),u.Gc(" ",t.dataPedido.datosDelivery.referencia,"")}}function He(e,i){if(1&e&&(u.Ub(0,"div",9),u.Ub(1,"p"),u.Ub(2,"span",14),u.Ec(3,"Importe a cobrar: "),u.Tb(),u.Ec(4),u.hc(5,"number"),u.Tb(),u.Ub(6,"p"),u.Ub(7,"span",14),u.Ec(8,"Cliente paga con: "),u.Tb(),u.Ec(9),u.Tb(),u.Tb()),2&e){var t=u.gc();u.Cb(4),u.Gc(" S/. ",u.jc(5,2,t.importeEfectivoPedido,".2"),""),u.Cb(5),u.Gc(" ",t.dataPedido.datosDelivery.paga_con,"")}}function Be(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div"),u.Pb(1,"hr"),u.Ub(2,"div",20),u.Ub(3,"div",21),u.cc("click",(function(){return u.wc(t),u.gc().callPhone()})),u.Pb(4,"i",22),u.Ec(5," LLamar"),u.Tb(),u.Ub(6,"div",23),u.cc("click",(function(){return u.wc(t),u.gc().redirectWhatsApp()})),u.Pb(7,"i",24),u.Ec(8," Enviar Mensaje"),u.Tb(),u.Tb(),u.Tb()}}var We,qe,Ke=function(e){return{success:e}},Qe=function(e,i){return{active:e,success:i}},Je=((We=function(){function e(i,t,o,a,n,s,r,c,d,l){_classCallCheck(this,e),this.pedidoRepartidorService=i,this.repartidorService=t,this.geoPositionService=o,this.calcDistanciaService=a,this.router=n,this.socketService=s,this.infoTokenService=r,this.dialog=c,this.timerService=d,this.listenService=l,this.coordenadasDestino={},this.importeEfectivoPedido=0,this.btnTitlePasos="Empezar",this.btnIsVisible=!0,this.btnTerminarVisible=!1,this._desAccionComprar="RECOGER",this.radioUbicacionActiva=60,this.destroy$=new C.Subject}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor,this.pedidoRepartidorService.verificarEstadoPedido(this.pedidoRepartidorService.pedidoRepartidor.idpedido).subscribe((function(i){e.dataPedido.estado=i,e.pedidoRepartidorService.setLocal(),e.loadInit()})),this.idClienteNotifyPos=this.dataPedido.datosCliente.idcliente,this.idSedeNotifiPos=this.dataPedido.datosComercio.idsede,this.dataPedido.datosDelivery.paga_con=this.dataPedido.datosDelivery.paga_con.replace("undefined",""),this._desAccionComprar=0===this.dataPedido.datosComercio.pwa_delivery_comision_fija_no_afiliado?"RECOGER":"COMPRAR"}},{key:"ngOnDestroy",value:function(){this.destroy$.next(!0),this.destroy$.unsubscribe()}},{key:"loadInit",value:function(){var e=this;switch(this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor,"4"===this.dataPedido.estado.toString()&&(this.btnTerminarVisible=!0,this.dataPedido.paso_va=4,this.pedidoRepartidorService.setPasoVa(4)),this.dataPedido.datosDelivery.metodoPago.idtipo_pago){case 1:this.descripcionPago="Pagar S/. ".concat(parseFloat(this.dataPedido.importePedido).toFixed(2)),this.importeEfectivoPedido=parseFloat(this.dataPedido.importePagaCliente);break;case 2:this.descripcionPago="El pedido ya esta pagado, solo entregar.";break;case 3:this.descripcionPago="Pagar S/. ".concat(parseFloat(this.dataPedido.importePedido).toFixed(2)),this.importeEfectivoPedido=parseFloat(this.dataPedido.importePagaCliente)}this.showPasos(),setTimeout((function(){e.listenGeoPosition()}),600)}},{key:"listenGeoPosition",value:function(){var e=this;this.geoPositionActual=this.geoPositionService.geoPosition,this.listenService.myPosition$.pipe(Object(Te.takeUntil)(this.destroy$)).subscribe((function(i){(i=(null==i?void 0:i.latitude)?i:e.geoPositionActual).latitude&&(e.geoPositionActual=i,!!e.coordenadasDestino.latitude&&e.calcDistanciaService.calcDistancia(e.geoPositionActual,e.coordenadasDestino,e.radioUbicacionActiva)&&1===e.dataPedido.paso_va&&(e.dataPedido.paso_va=2,e.pedidoRepartidorService.setPasoVa(2),e.showPasos()),3===e.dataPedido.paso_va&&(e.dataPedido.paso_va=4,e.pedidoRepartidorService.setPasoVa(4),e.showPasos()))})),this.socketService.onDeliveryPedidoFin().pipe(Object(Te.takeUntil)(this.destroy$)).subscribe((function(i){e.openDialogCalificacion()}))}},{key:"openDialogCalificacion",value:function(){var e,i=this;if(null===(e=this.dataPedido)||void 0===e?void 0:e.idpedido){var t=new ke;t.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,t.idcliente=this.dataPedido.datosCliente.idcliente,t.idpedido=this.dataPedido.idpedido,t.tipo=2,t.showNombre=!0,t.nombre=this.dataPedido.datosDelivery.nombre,t.titulo="Como calificas al cliente?",t.showTitulo=!0,t.showMsjTankyou=!0;var o=new r.e;o.disableClose=!0,o.hasBackdrop=!0,o.data={dataCalificado:t},this.dialog.open(Ie,o).afterClosed().subscribe((function(e){i.timerService.stopCountTimerLimit(),i.pedidoRepartidorService.finalizarPedido()}))}}},{key:"showPasos",value:function(){switch(this.dataPedido.paso_va=this.dataPedido.paso_va?this.dataPedido.paso_va:1,this.dataPedido.paso_va){case 1:this.coordenadasDestino.latitude=this.dataPedido.datosComercio.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosComercio.longitude,this.btnTitlePasos="Empezar",this.radioUbicacionActiva=350;break;case 2:case 3:this.btnIsVisible=!0,this.coordenadasDestino.latitude=this.dataPedido.datosCliente.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosCliente.longitude,this.btnTitlePasos="Paso 3 Empezar",this.radioUbicacionActiva=350;break;case 4:this.btnIsVisible=!0,this.coordenadasDestino.latitude=this.dataPedido.datosCliente.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosCliente.longitude,this.radioUbicacionActiva=350,this.btnTitlePasos="Entregado, terminar.";break;default:this.coordenadasDestino.latitude=this.dataPedido.datosCliente.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosCliente.longitude}}},{key:"btnEjecutar",value:function(){var e="";switch(this.dataPedido.paso_va){case 1:e="http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.coordenadasDestino.latitude,",").concat(this.coordenadasDestino.longitude),window.open(e,"_blank"),this.btnIsVisible=!1;break;case 2:case 3:e="http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.coordenadasDestino.latitude,",").concat(this.coordenadasDestino.longitude),window.open(e,"_blank"),this.btnIsVisible=!1,this.dataPedido.paso_va=3,this.pedidoRepartidorService.setPasoVa(3);break;case 4:this.openDialogCalificacion()}this.socketEmitEstadoPedido(this.dataPedido.paso_va)}},{key:"showDetallePedido",value:function(){this.dataPedido.paso_va>=2&&this.router.navigate(["./main/pedido-detalle"])}},{key:"redirectWhatsApp",value:function(){window.open("https://api.whatsapp.com/send?phone=51".concat(this.dataPedido.datosDelivery.telefono),"_blank")}},{key:"callPhone",value:function(){window.open("tel:".concat(this.dataPedido.datosDelivery.telefono))}},{key:"socketEmitEstadoPedido",value:function(e){this.socketService.emit("repartidor-notifica-estado-pedido",{idcliente:this.dataPedido.datosCliente.idcliente,idpedido:this.dataPedido.idpedido,estado:e})}}]),e}()).\u0275fac=function(e){return new(e||We)(u.Ob(P.a),u.Ob(p.a),u.Ob(d.a),u.Ob(_e),u.Ob(s.b),u.Ob(g.a),u.Ob(l.a),u.Ob(r.b),u.Ob(H),u.Ob(b.a))},We.\u0275cmp=u.Ib({type:We,selectors:[["app-indicaciones-pedido"]],decls:56,vars:28,consts:[[1,"animated","fadeInDown","container-body"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"border"],[3,"coordenadas"],[1,"p-3"],[1,"item-paso","d-flex","active",3,"ngClass"],[1,"num"],[1,"instrunccion","p-2","fs-13"],[1,"text-secondary","fw-600","fs-12"],[1,"fw-100"],["matRipple","",1,"item-paso","d-flex",3,"ngClass","click"],[1,"fw-600","fs-12"],[1,"fw-600","fs-15","text-dark"],[1,"text-secondary"],[1,"fw-600"],[4,"ngIf"],[1,"item-paso","d-flex",3,"ngClass"],["class","fw-100",4,"ngIf"],["matRipple","",1,"xfooter","bg-success","w-100","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"hidden","click"],[1,"text-info"],[1,"row","text-center"],["matRipple","",1,"col-6","border-right","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-phone"],["matRipple","",1,"col-6","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-commenting-o"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div"),u.Ub(3,"span"),u.Ec(4,"Pasos para entregar el pedido"),u.Tb(),u.Tb(),u.Ub(5,"div"),u.Ub(6,"span"),u.Ec(7),u.Tb(),u.Tb(),u.Tb(),u.Ub(8,"div",2),u.Pb(9,"app-mapa-solo",3),u.Tb(),u.Ub(10,"div",4),u.Ub(11,"div",5),u.Ub(12,"div",6),u.Ec(13,"1"),u.Tb(),u.Ub(14,"div",7),u.Ub(15,"p",8),u.Ec(16,"Dirigirse al comercio:"),u.Tb(),u.Ub(17,"p",9),u.Ec(18),u.Tb(),u.Ub(19,"p",9),u.Ec(20),u.Tb(),u.Tb(),u.Tb(),u.Ub(21,"div",10),u.cc("click",(function(){return i.showDetallePedido()})),u.Ub(22,"div",6),u.Ec(23,"2"),u.Tb(),u.Ub(24,"div",7),u.Ub(25,"p",11),u.Ub(26,"span",12),u.Ec(27),u.Tb(),u.Ub(28,"span",13),u.Ec(29),u.Tb(),u.Tb(),u.Ub(30,"p",14),u.Ec(31),u.Tb(),u.Ub(32,"p",9),u.Ec(33,"Pedir comprobante."),u.Tb(),u.Cc(34,ze,4,0,"div",15),u.Tb(),u.Tb(),u.Ub(35,"div",16),u.Ub(36,"div",6),u.Ec(37,"3"),u.Tb(),u.Ub(38,"div",7),u.Ub(39,"p",8),u.Ec(40,"Entregar Pedido:"),u.Tb(),u.Ub(41,"p",9),u.Ub(42,"span",14),u.Ec(43,"En: "),u.Tb(),u.Ec(44),u.Tb(),u.Cc(45,$e,4,1,"p",17),u.Ub(46,"p",9),u.Ub(47,"span",14),u.Ec(48,"A: "),u.Tb(),u.Ec(49),u.hc(50,"titlecase"),u.Tb(),u.Cc(51,He,10,5,"div",17),u.Cc(52,Be,9,0,"div",15),u.Tb(),u.Tb(),u.Tb(),u.Ub(53,"div",18),u.cc("click",(function(){return i.btnEjecutar()})),u.Ub(54,"span"),u.Ec(55),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Cb(7),u.Gc("#",i.dataPedido.idpedido,""),u.Cb(2),u.mc("coordenadas",i.coordenadasDestino),u.Cb(2),u.mc("ngClass",u.rc(20,Ke,i.dataPedido.paso_va>1)),u.Cb(7),u.Fc(i.dataPedido.datosComercio.nombre),u.Cb(2),u.Fc(i.dataPedido.datosComercio.direccion),u.Cb(1),u.mc("ngClass",u.sc(22,Qe,2===i.dataPedido.paso_va,i.dataPedido.paso_va>2)),u.Cb(6),u.Fc(i._desAccionComprar),u.Cb(2),u.Gc(" el pedido #",i.dataPedido.idpedido,": "),u.Cb(2),u.Fc(i.descripcionPago),u.Cb(3),u.mc("ngIf",i.dataPedido.paso_va>=2),u.Cb(1),u.mc("ngClass",u.sc(25,Qe,3===i.dataPedido.paso_va,i.dataPedido.paso_va>3)),u.Cb(9),u.Gc(" ",i.dataPedido.datosDelivery.direccion,""),u.Cb(1),u.mc("ngIf",i.dataPedido.datosDelivery.referencia),u.Cb(4),u.Gc(" ",u.ic(50,18,i.dataPedido.datosDelivery.nombre),""),u.Cb(2),u.mc("ngIf",i.dataPedido.datosDelivery.metodoPago.idtipo_pago),u.Cb(1),u.mc("ngIf",i.dataPedido.paso_va>=3),u.Cb(1),u.mc("hidden",!i.btnIsVisible),u.Cb(2),u.Fc(i.btnTitlePasos))},directives:[Ne,n.k,A.e,n.m],pipes:[n.u,n.e],styles:[".container-body[_ngcontent-%COMP%]{padding-bottom:3.5rem}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%;padding:14px}.item-paso[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;margin-bottom:5px;background-color:#eee;opacity:.6}.item-paso[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.item-paso[_ngcontent-%COMP%]   .num[_ngcontent-%COMP%]{padding:10px;font-size:23px;font-weight:600;line-height:2em;background:#e0e0e0;border-right:1px solid #d3d3d3;border-radius:4px 0 0 4px}.item-paso[_ngcontent-%COMP%]   .instrunccion[_ngcontent-%COMP%]{width:100%;padding:10px}.item-paso.success[_ngcontent-%COMP%]{border-color:#bdbdbd!important;opacity:1}.item-paso.success[_ngcontent-%COMP%]   .num[_ngcontent-%COMP%]{background:#00b14f}.item-paso.success[_ngcontent-%COMP%]   .instrunccion[_ngcontent-%COMP%]{background:#e0e0e0}.item-paso.active[_ngcontent-%COMP%]{opacity:1;border-color:#f9a825}"]}),We),Ye=t("NEqF"),Ze=((qe=function(){function e(i){_classCallCheck(this,e),this.url_img=Ye.d,this.itemProducto=i.item}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||qe)(u.Ob(r.a))},qe.\u0275cmp=u.Ib({type:qe,selectors:[["app-dialog-img-item"]],decls:11,vars:5,consts:[[1,"w-100"],[1,"img-thumbnail","w-100",3,"src","alt"],[1,"text-center","fs-13","pt-2"],[1,"text-center"],["mat-flat-button","","color","primary","mat-dialog-close",""]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Pb(1,"img",1),u.Tb(),u.Ub(2,"div",2),u.Ub(3,"p"),u.Ec(4),u.Tb(),u.Ub(5,"p"),u.Ec(6),u.Tb(),u.Tb(),u.Pb(7,"hr"),u.Ub(8,"div",3),u.Ub(9,"button",4),u.Ec(10,"Cerrar"),u.Tb(),u.Tb()),2&e&&(u.Cb(1),u.pc("src","",i.url_img,"",i.itemProducto.img,"",u.xc),u.nc("alt",i.itemProducto.img),u.Cb(3),u.Fc(i.itemProducto.des),u.Cb(2),u.Gc("Cantidad: ",i.itemProducto.cantidad_seleccionada,""))},directives:[v.a,r.d],styles:["p[_ngcontent-%COMP%]{margin:0}"]}),qe);function Xe(e,i){if(1&e&&(u.Ub(0,"li",20),u.Ub(1,"div",21),u.Ec(2),u.hc(3,"number"),u.Tb(),u.Ub(4,"div",22),u.Ec(5),u.hc(6,"number"),u.Tb(),u.Tb()),2&e){var t=i.$implicit,o=u.gc(9);u.mc("matRippleColor",o.rippleColorSubItem),u.Cb(2),u.Hc(" ",u.jc(3,5,t.cantidad_seleccionada,"2.")," ",t.des," "),u.Cb(2),u.mc("hidden",0===t.precio),u.Cb(1),u.Gc(" + ",u.jc(6,8,t.precio,"0.2")," ")}}function ei(e,i){if(1&e&&(u.Sb(0),u.Ub(1,"div"),u.Ub(2,"ul",13),u.Cc(3,Xe,7,11,"li",19),u.Tb(),u.Tb(),u.Rb()),2&e){var t=u.gc(2).$implicit;u.Cb(3),u.mc("ngForOf",t.subitems_view)}}function ii(e,i){if(1&e){var t=u.Vb();u.Sb(0),u.Ub(1,"li",14),u.cc("click",(function(){u.wc(t);var e=u.gc().$implicit;return u.gc(6).showImg(e)})),u.Ub(2,"div",15),u.Ec(3),u.hc(4,"number"),u.Tb(),u.Ub(5,"div",16),u.Ec(6),u.hc(7,"lowercase"),u.Ub(8,"span",17),u.Ec(9),u.Tb(),u.Tb(),u.Ub(10,"div",18),u.Ec(11),u.hc(12,"number"),u.Tb(),u.Tb(),u.Cc(13,ei,4,1,"ng-container",7),u.Rb()}if(2&e){var o=u.gc().$implicit,a=u.gc(6);u.Cb(1),u.mc("matRippleColor",a.rippleColor),u.Cb(2),u.Fc(u.jc(4,7,o.cantidad_seleccionada,"2.")),u.Cb(3),u.Gc("",u.ic(7,10,o.des)," "),u.Cb(2),u.mc("hidden",!o.indicaciones),u.Cb(1),u.Gc("( ",o.indicaciones," )"),u.Cb(2),u.Fc(u.jc(12,12,o.precio_print,"0.2")),u.Cb(2),u.mc("ngIf",o.subitems_view)}}function ti(e,i){if(1&e&&(u.Ub(0,"div"),u.Cc(1,ii,14,15,"ng-container",7),u.Tb()),2&e){var t=i.$implicit;u.Cb(1),u.mc("ngIf",t.cantidad_seleccionada>0)}}function oi(e,i){if(1&e&&(u.Sb(0),u.Ub(1,"div",11),u.Ub(2,"span"),u.Ec(3),u.hc(4,"titlecase"),u.Tb(),u.Ub(5,"div",12),u.Ec(6),u.Tb(),u.Tb(),u.Ub(7,"ul",13),u.Cc(8,ti,2,1,"div",10),u.Tb(),u.Rb()),2&e){var t=u.gc().$implicit;u.Cb(3),u.Fc(u.ic(4,3,t.des)),u.Cb(3),u.Fc(t.count_items),u.Cb(2),u.mc("ngForOf",t.items)}}function ai(e,i){if(1&e&&(u.Ub(0,"div"),u.Cc(1,oi,9,5,"ng-container",7),u.Tb()),2&e){var t=i.$implicit;u.Cb(1),u.mc("ngIf",t.count_items>0)}}function ni(e,i){if(1&e&&(u.Sb(0),u.Ub(1,"div",8),u.Ub(2,"span"),u.Ec(3,"Detalle del pedido"),u.Tb(),u.Ub(4,"div",9),u.Ec(5),u.Tb(),u.Tb(),u.Cc(6,ai,2,1,"div",10),u.Rb()),2&e){var t=u.gc().$implicit;u.Cb(5),u.Fc(t.count_items_seccion),u.Cb(1),u.mc("ngForOf",t.secciones)}}function si(e,i){if(1&e&&(u.Ub(0,"div",6),u.Cc(1,ni,7,2,"ng-container",7),u.Tb()),2&e){var t=i.$implicit;u.Cb(1),u.mc("ngIf",t.count_items_seccion>0)}}function ri(e,i){if(1&e&&(u.Ub(0,"li",23),u.Ub(1,"div",13),u.Ec(2),u.hc(3,"titlecase"),u.Tb(),u.Ub(4,"div"),u.Ec(5),u.hc(6,"number"),u.Tb(),u.Tb()),2&e){var t=i.$implicit,o=u.gc(2);u.mc("matRippleColor",o.rippleColor),u.Cb(2),u.Fc(u.ic(3,3,t.descripcion)),u.Cb(3),u.Fc(u.jc(6,5,t.importe,"0.2"))}}function ci(e,i){if(1&e&&(u.Ub(0,"div",1),u.Cc(1,si,2,1,"div",2),u.Ub(2,"div",3),u.Ub(3,"ul",4),u.Cc(4,ri,7,8,"li",5),u.Tb(),u.Tb(),u.Tb()),2&e){var t=u.gc();u.Cb(1),u.mc("ngForOf",t._miPedido.tipoconsumo),u.Cb(3),u.mc("ngForOf",t._arrSubtotales)}}var di,li,pi=((li=function(){function e(i,t,o){_classCallCheck(this,e),this.crudService=i,this.pedidoRepartidorService=t,this.dialog=o,this.showAllSubtotal=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.loadPedido()}},{key:"loadPedido",value:function(){console.log("ini service pedido");var e=!!this.pedidoRepartidorService.getPedidoSelect(),i=this.pedidoRepartidorService.getPedidoSelect()||this.pedidoRepartidorService.pedidoRepartidor,t=e?i.json_datos_delivery.p_body:this.pedidoRepartidorService.pedidoRepartidor.datosItems,o=e?this.pedidoRepartidorService.darFormatoSubTotales(i.json_datos_delivery.p_header.arrDatosDelivery.subTotales,e?i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.pwa_delivery_comercio_paga_entrega:null,e?i.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery:null):this.pedidoRepartidorService.pedidoRepartidor.datosSubtotalesShow;this._miPedido=this.pedidoRepartidorService.darFormatoPedidoLocal(t,o),this._arrSubtotales=this.showAllSubtotal?e?i.json_datos_delivery.p_subtotales:this.pedidoRepartidorService.pedidoRepartidor.datosSubtotalesShow:o}},{key:"showImg",value:function(e){if(e.img&&""!==e.img){var i=new r.e;i.disableClose=!0,i.hasBackdrop=!0,i.data={item:e},this.dialog.open(Ze,i)}}}]),e}()).\u0275fac=function(e){return new(e||li)(u.Ob(q.a),u.Ob(P.a),u.Ob(r.b))},li.\u0275cmp=u.Ib({type:li,selectors:[["app-comp-pedido-detalle"]],inputs:{infoPedido:"infoPedido",showAllSubtotal:"showAllSubtotal"},decls:1,vars:1,consts:[["class","w-100 div-resumen-pedido",4,"ngIf"],[1,"w-100","div-resumen-pedido"],["class","xCursor",4,"ngFor","ngForOf"],[1,"div-total"],[1,"w-100","ul-total"],["class","d-flex div-plr li-item","matRipple","",3,"matRippleColor",4,"ngFor","ngForOf"],[1,"xCursor"],[4,"ngIf"],[1,"div-plr","titulo-tpc"],[1,"countItem","countTpc"],[4,"ngFor","ngForOf"],[1,"div-plr","titulo-seccion"],[1,"countItem","countSeccion"],[1,"w-100"],["matRipple","",1,"d-flex","div-plr","li-item",3,"matRippleColor","click"],[1,"pr-2","fw-100"],[1,"w-100","fw-100"],[3,"hidden"],[1,"fw-100"],["class","d-flex div-plr li-item fw-100 fs-12 text-secondary subitem-content-resumen","matRipple","",3,"matRippleColor",4,"ngFor","ngForOf"],["matRipple","",1,"d-flex","div-plr","li-item","fw-100","fs-12","text-secondary","subitem-content-resumen",3,"matRippleColor"],[1,"d-flex","w-100","pl-4"],[1,"fs-11","text-right",2,"width","45px",3,"hidden"],["matRipple","",1,"d-flex","div-plr","li-item",3,"matRippleColor"]],template:function(e,i){1&e&&u.Cc(0,ci,5,2,"div",0),2&e&&u.mc("ngIf",i._miPedido)},directives:[n.m,n.l,A.e],pipes:[n.u,n.e,n.j],styles:[".div-plr[_ngcontent-%COMP%]{padding-left:7px;padding-right:7px}.div-content-all[_ngcontent-%COMP%]{top:0;position:-webkit-sticky;position:sticky}.titulo-tpc[_ngcontent-%COMP%]{background:#424242;color:#e0e0e0}.titulo-seccion[_ngcontent-%COMP%], .titulo-tpc[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}.titulo-seccion[_ngcontent-%COMP%]{background:#ffebcd}.li-item[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px;border-top:1px solid #e0e0e0}.div-total[_ngcontent-%COMP%]{border-top:2px dashed #9e9e9e}.ul-total[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{font-size:20px;font-weight:800}.countItem[_ngcontent-%COMP%]{padding:4px 7px;border-radius:90%;line-height:1;font-size:12px;margin-top:2px}.countTpc[_ngcontent-%COMP%]{float:right;background:#212121;color:#bdbdbd}.countSeccion[_ngcontent-%COMP%]{float:right;color:#616161;background:#ffcc80}"]}),li),bi=((di=function(){function e(i,t,o){_classCallCheck(this,e),this.repartidorPedidoService=i,this.infoTokenService=t,this.router=o,this.infoPedido={},this.indicacionesComprobante="",this.comprobanteSolicitar=""}return _createClass(e,[{key:"ngOnInit",value:function(){var e="",i="",t=this.repartidorPedidoService.getPedidoSelect();if(t){this.infoPedido=t;var o=t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni?t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni:"";return e=""===o?"":o.length>8?"RUC ":"DNI ",i=t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro?t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro:"",this.indicacionesComprobante=""===o?"Publico en general.":e+" "+o+" - "+i,void(this.comprobanteSolicitar=t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.descripcion)}this.infoPedido=this.repartidorPedidoService.pedidoRepartidor,this.infoPedido.idpedido=this.repartidorPedidoService.pedidoRepartidor.idpedido,this.infoPedido.idsede=this.repartidorPedidoService.pedidoRepartidor.datosComercio.idsede,this.infoPedido.idorg=this.repartidorPedidoService.pedidoRepartidor.datosComercio.idorg,this.infoPedido.datosDelivery.tipoComprobante.dni=this.infoPedido.datosDelivery.tipoComprobante.dni?this.infoPedido.datosDelivery.tipoComprobante.dni:"",e=""===this.infoPedido.datosDelivery.tipoComprobante.dni?"":this.infoPedido.datosDelivery.tipoComprobante.dni.length>8?"RUC ":"DNI ",i=this.infoPedido.datosDelivery.tipoComprobante.otro?this.infoPedido.datosDelivery.tipoComprobante.otro:"",this.indicacionesComprobante=""===this.infoPedido.datosDelivery.tipoComprobante.dni?"Publico en general.":e+" "+this.infoPedido.datosDelivery.tipoComprobante.dni+" - "+i}},{key:"goBack",value:function(){this.router.navigate(["/main/list-grupo-pedidos"])}}]),e}()).\u0275fac=function(e){return new(e||di)(u.Ob(P.a),u.Ob(l.a),u.Ob(s.b))},di.\u0275cmp=u.Ib({type:di,selectors:[["app-pedido-detalle"]],decls:18,vars:4,consts:[[1,"animated","fadeInRight"],[3,"infoPedido","showAllSubtotal"],[1,"xfooter","animated","fadeInUp","delay-0-5s"],[1,"p-2","div-comprobante"],[1,"fw-600"],[1,"fw-100"],["matRipple","",1,"bg-success","w-100","fs-20","text-white","p-3",3,"click"],[1,"fa","fa-arrow-left"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Pb(1,"app-comp-pedido-detalle",1),u.Pb(2,"hr"),u.Pb(3,"br"),u.Pb(4,"br"),u.Pb(5,"br"),u.Pb(6,"br"),u.Ub(7,"div",2),u.Ub(8,"div",3),u.Ub(9,"p"),u.Ub(10,"span",4),u.Ec(11),u.Tb(),u.Ub(12,"span",5),u.Ec(13),u.Tb(),u.Tb(),u.Tb(),u.Ub(14,"div",6),u.cc("click",(function(){return i.goBack()})),u.Ub(15,"span"),u.Pb(16,"i",7),u.Ec(17," Listo, regresar"),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Cb(1),u.mc("infoPedido",i.infoPedido)("showAllSubtotal",!1),u.Cb(10),u.Gc("Solicitar ",i.comprobanteSolicitar,": "),u.Cb(2),u.Fc(i.indicacionesComprobante))},directives:[pi,A.e],styles:[".div-comprobante[_ngcontent-%COMP%]{background:#d3d3d3}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}"]}),di);function ui(e,i){1&e&&(u.Sb(0),u.Ub(1,"span",23),u.Ec(2,"Entregado"),u.Tb(),u.Rb())}function hi(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",24),u.Pb(1,"hr"),u.Ub(2,"div",25),u.cc("click",(function(){return u.wc(t),u.gc().callPhone()})),u.Pb(3,"i",26),u.Ec(4," LLamar"),u.Tb(),u.Ub(5,"div",27),u.cc("click",(function(){return u.wc(t),u.gc().redirectWhatsApp()})),u.Pb(6,"i",28),u.Ec(7," Enviar Mensaje"),u.Tb(),u.Tb()}}function fi(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div"),u.Ub(1,"button",29),u.cc("click",(function(){return u.wc(t),u.gc().goDireccion()})),u.Ub(2,"span",21),u.Pb(3,"i",10),u.Ec(4," Ir a la direccion"),u.Tb(),u.Tb(),u.Pb(5,"hr"),u.Tb()}}var vi,mi,gi,Pi=((gi=function(){function e(i,t,o,a){_classCallCheck(this,e),this.pedidoRepartidorService=i,this.geoPositionService=t,this.calcDistanciaService=o,this.socketService=a,this.closeWindow=new u.o(!1),this.coordenadasDestino={},this.geoPositionComercio=new je.a,this.isLlegoDestino=!1,this.importeEfectivo="",this.indicacionesComprobante="",this.comprobanteSolicitar=""}return _createClass(e,[{key:"ngOnInit",value:function(){var e;console.log("la orden",this.orden),this.pedidoRepartidorService.darFormatoLocalPedidoRepartidorModel(this.orden),this.pedidoRepartidorService.setLocal(),this.geoPositionService.get(),this.geoPositionActual=this.geoPositionService.getGeoPosition(),this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor,this.importeEfectivo=(null===(e=this.dataPedido.datosDelivery.metodoPago)||void 0===e?void 0:e.importe)||"",this.coordenadasDestino={latitude:this.dataPedido.datosCliente.latitude,longitude:this.dataPedido.datosCliente.longitude};var i=this.orden.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni||"";this.indicacionesComprobante=""===i?"Publico en general.":(""===i?"":i.length>8?"RUC ":"DNI ")+" "+i+" - "+(this.orden.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro||""),this.comprobanteSolicitar=this.orden.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.descripcion,this.isLlegoDestino=this.calcDistanciaService.calcDistancia(this.geoPositionActual,this.coordenadasDestino,120)}},{key:"cerrarDetalles",value:function(e){e&&this.closeWindow.emit(e)}},{key:"goDireccion",value:function(){var e=this;window.open("http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.coordenadasDestino.latitude,",").concat(this.coordenadasDestino.longitude),"_blank"),setTimeout((function(){e.cerrarDetalles(!0)}),500)}},{key:"redirectWhatsApp",value:function(){window.open("https://api.whatsapp.com/send?phone=51".concat(this.dataPedido.datosDelivery.telefono),"_blank")}},{key:"irAlComercio",value:function(){this.geoPositionComercio.latitude="string"==typeof this.dataPedido.datosDelivery.establecimiento.latitude?parseFloat(this.dataPedido.datosDelivery.establecimiento.latitude):this.dataPedido.datosDelivery.establecimiento.latitude,this.geoPositionComercio.longitude="string"==typeof this.dataPedido.datosDelivery.establecimiento.longitude?parseFloat(this.dataPedido.datosDelivery.establecimiento.longitude):this.dataPedido.datosDelivery.establecimiento.longitude,window.open("http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.geoPositionComercio.latitude,",").concat(this.geoPositionComercio.longitude),"_blank")}},{key:"callPhone",value:function(){window.open("tel:".concat(this.dataPedido.datosDelivery.telefono))}},{key:"PedidoEntregado",value:function(){var e=this;this.orden.pwa_estado="E",this.orden.estado=2,this.orden.isRepartidorRed?this.pedidoRepartidorService.finalizarPedido(!0):this.pedidoRepartidorService.finalizarPedidoPropioRepartidor(),setTimeout((function(){e.cerrarDetalles(e.orden)}),500)}}]),e}()).\u0275fac=function(e){return new(e||gi)(u.Ob(P.a),u.Ob(d.a),u.Ob(_e),u.Ob(g.a))},gi.\u0275cmp=u.Ib({type:gi,selectors:[["app-comp-orden-detalle"]],inputs:{orden:"orden"},outputs:{closeWindow:"closeWindow"},decls:70,vars:14,consts:[[1,"animated","fadeIn"],[1,"d-flex","justify-content-between"],[1,"fw-600"],[4,"ngIf"],["type","button","mat-dialog-close","",1,"btn","btn-secondary"],[1,"fa","fa-close"],[1,"fs-13","fw-600","text-secondary"],[1,"row"],[1,"fs-13","col-6"],[1,"fa","fa-user"],[1,"fa","fa-map-marker"],[1,"col-6","w-100"],[1,"d-flex","justify-content-end"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fs-13"],[1,"fa","fa-phone"],[1,"pl-2"],[1,"fw-100"],["class","row text-center",4,"ngIf"],[1,"text-center"],[1,"btn","btn-success",2,"width","85%",3,"click"],[1,"fs-18"],[1,"fa","fa-thumbs-up"],[1,"fw-600","fs-15","text-success"],[1,"row","text-center"],["matRipple","",1,"col-6","border-right","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-phone"],["matRipple","",1,"col-6","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-commenting-o"],[1,"btn","btn-info",2,"width","85%",3,"click"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div"),u.Ub(3,"p",2),u.Ec(4),u.Tb(),u.Cc(5,ui,3,0,"ng-container",3),u.Tb(),u.Ub(6,"div"),u.Ub(7,"button",4),u.Pb(8,"i",5),u.Tb(),u.Tb(),u.Tb(),u.Pb(9,"hr"),u.Ub(10,"div"),u.Ub(11,"span",6),u.Ec(12,"Comercio: "),u.Tb(),u.Ub(13,"div",7),u.Ub(14,"div",8),u.Ub(15,"p"),u.Pb(16,"i",9),u.Ec(17),u.Tb(),u.Ub(18,"p"),u.Pb(19,"i",10),u.Ec(20),u.Tb(),u.Tb(),u.Ub(21,"div",11),u.Ub(22,"div",12),u.Ub(23,"button",13),u.cc("click",(function(){return i.irAlComercio()})),u.Ec(24,"Ir al comercio"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Pb(25,"hr"),u.Ub(26,"div"),u.Ub(27,"div",14),u.Ub(28,"span",6),u.Ec(29,"Cliente: "),u.Tb(),u.Ub(30,"p"),u.Pb(31,"i",9),u.Ec(32),u.Tb(),u.Ub(33,"p"),u.Pb(34,"i",10),u.Ec(35),u.Tb(),u.Ub(36,"p"),u.Pb(37,"i",10),u.Ec(38),u.Tb(),u.Ub(39,"p"),u.Pb(40,"i",15),u.Ec(41),u.Tb(),u.Pb(42,"hr"),u.Ub(43,"div"),u.Ub(44,"span",6),u.Ec(45,"Cliente paga con: "),u.Tb(),u.Ub(46,"p"),u.Ec(47),u.Ub(48,"span",16),u.Ec(49),u.Tb(),u.Tb(),u.Tb(),u.Pb(50,"hr"),u.Ub(51,"div"),u.Ub(52,"span",6),u.Ec(53,"Solicitar: "),u.Tb(),u.Ub(54,"p"),u.Ub(55,"span",2),u.Ec(56),u.Tb(),u.Ub(57,"span",17),u.Ec(58),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Pb(59,"hr"),u.Cc(60,hi,8,0,"div",18),u.Tb(),u.Pb(61,"hr"),u.Pb(62,"app-comp-pedido-detalle"),u.Pb(63,"hr"),u.Ub(64,"div",19),u.Cc(65,fi,6,0,"div",3),u.Ub(66,"button",20),u.cc("click",(function(){return i.PedidoEntregado()})),u.Ub(67,"span",21),u.Pb(68,"i",22),u.Ec(69," Listo, Pedido Entregado"),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Cb(4),u.Gc("Pedido #",i.orden.idpedido,""),u.Cb(1),u.mc("ngIf","4"===i.orden.pwa_delivery_status),u.Cb(12),u.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.nombre,""),u.Cb(3),u.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.direccion,""),u.Cb(12),u.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.nombre,""),u.Cb(3),u.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.direccion,""),u.Cb(3),u.Gc(" Ref: ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.referencia,""),u.Cb(3),u.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.telefono,""),u.Cb(6),u.Gc("",i.orden.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion," "),u.Cb(2),u.Fc(i.importeEfectivo),u.Cb(7),u.Gc("",i.comprobanteSolicitar,": "),u.Cb(2),u.Fc(i.indicacionesComprobante),u.Cb(2),u.mc("ngIf","4"!==i.orden.pwa_delivery_status),u.Cb(5),u.mc("ngIf",!i.isLlegoDestino))},directives:[n.m,r.d,pi,A.e],styles:["p[_ngcontent-%COMP%]{margin:0}"]}),gi),Ci=((mi=function(){function e(i,t){_classCallCheck(this,e),this.dialogRef=i,this.laOrden=t.laOrden,console.log("orden desde dialog-orden-detalle",this.laOrden)}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"cerrarDialog",value:function(e){e&&this.dialogRef.close(this.laOrden)}}]),e}()).\u0275fac=function(e){return new(e||mi)(u.Ob(r.g),u.Ob(r.a))},mi.\u0275cmp=u.Ib({type:mi,selectors:[["app-dialog-orden-detalle"]],decls:1,vars:1,consts:[[3,"orden","closeWindow"]],template:function(e,i){1&e&&(u.Ub(0,"app-comp-orden-detalle",0),u.cc("closeWindow",(function(e){return i.cerrarDialog(e)})),u.Tb()),2&e&&u.mc("orden",i.laOrden)},directives:[Pi],styles:[""]}),mi),yi=((vi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"primeraConMayusculas",value:function(e){return(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1)}},{key:"reformatDate",value:function(e){var i=e.split("-");return i[2]+"/"+i[1]+"/"+i[0]}},{key:"xTiempoTranscurridos_2",value:function(e){var i=this.xDevolverHora().split(":"),t=e.split(":"),o=new Date,a=new Date;null===t[2]&&(t[2]="00"),a.setHours(i[0],i[1],i[2]),o.setHours(t[0],t[1],t[2]);var n=Math.floor((a-o)/1e3),s=n%60,r=Math.floor(n/60),c=r%60,d=Math.floor(r/60);return this.xCeroIzq(d%24,2)+":"+this.xCeroIzq(c,2)+":"+this.xCeroIzq(s,2)}},{key:"xTiempoTranscurridos_en_minutos",value:function(e){var i=this.xDevolverHora().split(":"),t=e.split(":"),o=new Date,a=new Date;null===t[2]&&(t[2]="00"),a.setHours(i[0],i[1],i[2]),o.setHours(t[0],t[1],t[2]);var n=Math.floor((a-o)/1e3),s=Math.floor(n/60),r=s%60,c=Math.floor(s/60);return this.xCeroIzq(c%24*60+r,2)}},{key:"xDevolverHora",value:function(){var e=new Date;return this.xCeroIzq(e.getHours(),2)+":"+this.xCeroIzq(e.getMinutes(),2)+":"+this.xCeroIzq(e.getSeconds(),2)}},{key:"xCeroIzq",value:function(e,i){for(e=e.toString();e.length<i;)e="0"+e;return e}}]),e}()).\u0275fac=function(e){return new(e||vi)},vi.\u0275prov=u.Kb({token:vi,factory:vi.\u0275fac,providedIn:"root"}),vi),_i=t("5YjC"),Ti=t("IyRd");function ki(e,i){1&e&&(u.Ub(0,"p",7),u.Ec(1,"Obteniendo Camara..."),u.Tb())}function wi(e,i){1&e&&(u.Ub(0,"p",8),u.Ec(1,"Codigo no valido"),u.Tb())}function Si(e,i){1&e&&u.Pb(0,"div",9)}function Ui(e,i){if(1&e){var t=u.Vb();u.Ub(0,"button",10),u.cc("click",(function(){return u.wc(t),u.gc(2).onDeviceSelectChange()})),u.Pb(1,"i",11),u.Ub(2,"span",12),u.Ec(3,"Rotar"),u.Tb(),u.Tb()}}function Ri(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",1),u.Ub(1,"p"),u.Ec(2,"Scanear codigo"),u.Tb(),u.Cc(3,ki,2,0,"p",2),u.Cc(4,wi,2,0,"p",3),u.Ub(5,"zxing-scanner",4),u.cc("deviceChange",(function(e){return u.wc(t),u.gc().currentDevice=e}))("camerasFound",(function(e){return u.wc(t),u.gc().onCamerasFound(e)}))("permissionResponse",(function(e){return u.wc(t),u.gc().onHasPermission(e)}))("scanSuccess",(function(e){return u.wc(t),u.gc().scanSuccessHandler(e)})),u.Tb(),u.Cc(6,Si,1,0,"div",5),u.Pb(7,"br"),u.Cc(8,Ui,4,0,"button",6),u.Tb()}if(2&e){var o=u.gc();u.Cb(3),u.mc("ngIf",!o.isCameraReady),u.Cb(1),u.mc("ngIf",!o.isCodigoQrValido),u.Cb(1),u.mc("device",o.currentDevice)("formats",o.allowedFormats),u.Cb(1),u.mc("ngIf",o.isCameraReady),u.Cb(2),u.mc("ngIf",o.isOptionChangeCamera)}}var Di,xi=((Di=function(){function e(){_classCallCheck(this,e),this.codeScanSucces=new u.o,this.codQR="",this.hasPermission=!0,this.hasPermissionPosition=!0,this.isProcesando=!1,this.currentDevice=null,this.indexSelectCamera=0,this.isOptionChangeCamera=!1,this.isCodigoQrValido=!0,this.isCameraReady=!1,this.allowedFormats=[_i.BarcodeFormat.QR_CODE,_i.BarcodeFormat.EAN_8,_i.BarcodeFormat.EAN_13,_i.BarcodeFormat.CODABAR,_i.BarcodeFormat.MAXICODE,,_i.BarcodeFormat.CODE_128]}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onCamerasFound",value:function(e){this.availableDevices=e,this.hasDevices=Boolean(e&&e.length),this.indexSelectCamera=e.length-1,this.isOptionChangeCamera=this.indexSelectCamera>0,this.deviceSelectChange()}},{key:"onDeviceSelectChange",value:function(){this.isCameraReady=!1,this.indexSelectCamera=this.indexSelectCamera===this.availableDevices.length-1?0:this.indexSelectCamera+1,this.deviceSelectChange()}},{key:"deviceSelectChange",value:function(){var e=this;this.currentDevice=this.availableDevices[this.indexSelectCamera]||null,setTimeout((function(){e.isCameraReady=!0}),1e3)}},{key:"onHasPermission",value:function(e){this.hasPermission=e}},{key:"scanSuccessHandler",value:function(e){this.codQR=e,this.leerDatosQR()}},{key:"leerDatosQR",value:function(){this.isCodigoQrValido=!0,console.log("codigo escaneado",this.codQR);var e=this.codQR.split("-");this.isCodigoQrValido="369"===e[0].toString(),console.log("_codQr",e),console.log("_codQr",e[1]),this.isCodigoQrValido&&this.codeScanSucces.emit(e[1])}}]),e}()).\u0275fac=function(e){return new(e||Di)},Di.\u0275cmp=u.Ib({type:Di,selectors:[["app-scan-code-pedido"]],outputs:{codeScanSucces:"codeScanSucces"},decls:2,vars:1,consts:[["class","video text-center",4,"ngIf"],[1,"video","text-center"],["class","fw-100",4,"ngIf"],["class","fw-600 text-danger animated pulse",4,"ngIf"],[1,"video-scan",3,"device","formats","deviceChange","camerasFound","permissionResponse","scanSuccess"],["class","linea-scan",4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],[1,"fw-100"],[1,"fw-600","text-danger","animated","pulse"],[1,"linea-scan"],["mat-button","",3,"click"],["aria-hidden","true",1,"fa","fa-undo"],[1,"pl-2"]],template:function(e,i){1&e&&(u.Ub(0,"div"),u.Cc(1,Ri,9,6,"div",0),u.Tb()),2&e&&(u.Cb(1),u.mc("ngIf",!i.isProcesando))},directives:[n.m,Ti.a,v.a],styles:["[_nghost-%COMP%]   zxing-scanner[_ngcontent-%COMP%]  video{max-width:300px;max-height:225px}.container-scan[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;background:hsla(0,0%,62%,.31)}.container-scan[_ngcontent-%COMP%]   .video[_ngcontent-%COMP%]{max-width:300px}.video[_ngcontent-%COMP%]{width:300px;margin:0 auto}.video-scan[_ngcontent-%COMP%]{max-width:300px;max-height:225px}.linea-scan[_ngcontent-%COMP%]{height:20px;background:rgba(0,230,118,.5);position:relative;-webkit-animation:updown 3s infinite;animation:updown 3s infinite}@-webkit-keyframes updown{0%{bottom:15px}50%{bottom:235px}to{bottom:15px}}@keyframes updown{0%{bottom:15px}50%{bottom:235px}to{bottom:15px}}"]}),Di),Ei=t("+0xr");function Oi(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",14),u.Ub(1,"app-scan-code-pedido",15),u.cc("codeScanSucces",(function(e){return u.wc(t),u.gc(3).succesScan(e)})),u.Tb(),u.Ub(2,"button",16),u.cc("click",(function(){return u.wc(t),u.gc(3).scanCode=!1})),u.Ub(3,"span",17),u.Ec(4," Cancelar"),u.Tb(),u.Tb(),u.Tb()}}function Ii(e,i){1&e&&(u.Sb(0),u.Ub(1,"div",21),u.Pb(2,"i",22),u.Ub(3,"p"),u.Ec(4,"Obteniendo Datos ..."),u.Tb(),u.Tb(),u.Rb())}function ji(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",21),u.Ub(1,"p"),u.Ec(2),u.Tb(),u.Ub(3,"p"),u.Ec(4),u.Tb(),u.Pb(5,"hr"),u.Ub(6,"div",23),u.Ub(7,"button",24),u.cc("click",(function(){return u.wc(t),u.gc(4).isResulScan=!1})),u.Ub(8,"span",17),u.Ec(9,"Escanear Otro"),u.Tb(),u.Tb(),u.Ub(10,"button",16),u.cc("click",(function(){u.wc(t);var e=u.gc(4);return e.scanCode=!1,e.isResulScan=!1})),u.Ub(11,"span",17),u.Ec(12,"Finalizar Escaneo"),u.Tb(),u.Tb(),u.Tb(),u.Tb()}if(2&e){var o=u.gc(4);u.Cb(2),u.Gc("Pedido Asinado: ",o.ordenAsingadaScan.idpedido,""),u.Cb(2),u.Fc(o.ordenAsingadaScan.json_datos_delivery.p_header.arrDatosDelivery.nombre)}}function Ai(e,i){if(1&e&&(u.Ub(0,"div",18),u.Cc(1,Ii,5,0,"ng-container",19),u.Cc(2,ji,13,2,"ng-template",null,20,u.Dc),u.Tb()),2&e){var t=u.vc(3),o=u.gc(3);u.Cb(1),u.mc("ngIf",o.loadingScan)("ngIfElse",t)}}function Fi(e,i){if(1&e&&(u.Ub(0,"div",12),u.Cc(1,Oi,5,0,"div",13),u.Cc(2,Ai,4,2,"div",9),u.Tb()),2&e){var t=u.gc(2);u.Cb(1),u.mc("ngIf",!t.isResulScan),u.Cb(1),u.mc("ngIf",t.isResulScan)}}function Mi(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div"),u.Ub(1,"button",31),u.cc("click",(function(){return u.wc(t),u.gc(4).goBackRepartidorRed()})),u.Pb(2,"i",32),u.Ec(3," Atas"),u.Tb(),u.Tb()}}function Li(e,i){if(1&e&&(u.Ub(0,"div",29),u.Pb(1,"img",30),u.Pb(2,"br"),u.Pb(3,"br"),u.Cc(4,Mi,4,0,"div",8),u.Tb()),2&e){var t=u.gc(3);u.Cb(4),u.mc("ngIf",t.isRepartidorRed)}}function Gi(e,i){1&e&&(u.Ub(0,"th",45),u.Ec(1," Pedido "),u.Tb())}var Vi=function(e){return{"text-danger":e}};function Ni(e,i){if(1&e&&(u.Ub(0,"td",46),u.Ub(1,"p",47),u.Ec(2),u.Tb(),u.Ub(3,"p",48),u.Ub(4,"span",49),u.Ec(5),u.Tb(),u.Tb(),u.Tb()),2&e){var t=i.$implicit;u.Cb(2),u.Fc(t.idpedido),u.Cb(2),u.mc("ngClass",u.rc(3,Vi,t.hora_show>30)),u.Cb(1),u.Gc(" ",t.hora_show," min ")}}function zi(e,i){1&e&&(u.Ub(0,"th",50),u.Ec(1," Cliente "),u.Tb())}var $i=function(e,i,t){return{"badge-primary":e,"badge-info":i,"badge-secondary":t}};function Hi(e,i){if(1&e&&(u.Ub(0,"td",51),u.Ub(1,"p",47),u.Ec(2),u.hc(3,"titlecase"),u.Tb(),u.Ub(4,"p",52),u.Ub(5,"span",53),u.Ec(6),u.hc(7,"titlecase"),u.Tb(),u.Ub(8,"span",54),u.Ec(9),u.Tb(),u.Tb(),u.Tb()),2&e){var t=i.$implicit;u.Cb(2),u.Gc(" ",u.ic(3,4,t.json_datos_delivery.p_header.arrDatosDelivery.nombre)," "),u.Cb(3),u.mc("ngClass",u.tc(8,$i,3===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,2===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,1===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)),u.Cb(1),u.Gc(" ",u.ic(7,6,t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion)," "),u.Cb(3),u.Gc(" ",t.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km," Km ")}}function Bi(e,i){1&e&&(u.Ub(0,"th",55),u.Ec(1," Importe "),u.Tb())}function Wi(e,i){1&e&&(u.Ub(0,"p",58),u.Ec(1," pagado con tarjeta "),u.Tb())}function qi(e,i){if(1&e&&(u.Ub(0,"td",56),u.Ub(1,"p",47),u.Ec(2),u.hc(3,"number"),u.Tb(),u.Cc(4,Wi,2,0,"p",57),u.Tb()),2&e){var t=i.$implicit;u.Cb(2),u.Gc(" ",u.jc(3,2,t.importe_pagar_comercio,".2")," "),u.Cb(2),u.mc("ngIf",2===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)}}function Ki(e,i){1&e&&u.Pb(0,"tr",59)}var Qi=function(e){return{"color-checked":e}};function Ji(e,i){if(1&e){var t=u.Vb();u.Ub(0,"tr",60),u.cc("click",(function(){u.wc(t);var e=i.$implicit;return u.gc(4).showDetallePedido(e)})),u.Tb()}2&e&&u.mc("ngClass",u.rc(1,Qi,"E"===i.$implicit.pwa_estado))}function Yi(e,i){if(1&e&&(u.Ub(0,"table",33),u.Sb(1,34),u.Cc(2,Gi,2,0,"th",35),u.Cc(3,Ni,6,5,"td",36),u.Rb(),u.Sb(4,37),u.Cc(5,zi,2,0,"th",38),u.Cc(6,Hi,10,12,"td",39),u.Rb(),u.Sb(7,40),u.Cc(8,Bi,2,0,"th",41),u.Cc(9,qi,5,5,"td",42),u.Rb(),u.Cc(10,Ki,1,0,"tr",43),u.Cc(11,Ji,1,3,"tr",44),u.Tb()),2&e){var t=u.gc(3);u.mc("dataSource",t.listPedidos),u.Cb(10),u.mc("matHeaderRowDef",t.displayedColumns),u.Cb(1),u.mc("matRowDefColumns",t.displayedColumns)}}function Zi(e,i){if(1&e&&(u.Ub(0,"div",61),u.Ub(1,"div",62),u.Ub(2,"div"),u.Ub(3,"span",63),u.Ec(4,"Total a pagar: "),u.Tb(),u.Ub(5,"span",64),u.Ec(6),u.hc(7,"number"),u.Tb(),u.Tb(),u.Ub(8,"div"),u.Ub(9,"span",65),u.Ec(10,"Comision Entrega: "),u.Tb(),u.Ub(11,"span",66),u.Ec(12),u.hc(13,"number"),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e){var t=u.gc(3);u.Cb(6),u.Gc(" ",u.jc(7,2,t.sumListPedidos,".2")," "),u.Cb(6),u.Gc(" ",u.jc(13,5,t.sumGananciaTotal,".2")," ")}}function Xi(e,i){if(1&e&&(u.Ub(0,"div"),u.Ub(1,"p",25),u.Ec(2,"Lista de pedidos asignados:"),u.Tb(),u.Cc(3,Li,5,1,"div",26),u.Cc(4,Yi,12,3,"table",27),u.Cc(5,Zi,14,8,"div",28),u.Pb(6,"br"),u.Pb(7,"br"),u.Tb()),2&e){var t=u.gc(2);u.Cb(3),u.mc("ngIf",!t.scanCode&&!t.listPedidos),u.Cb(1),u.mc("ngIf",t.listPedidos),u.Cb(1),u.mc("ngIf",t.listPedidos)}}function et(e,i){if(1&e&&(u.Ub(0,"div"),u.Cc(1,Fi,3,2,"div",11),u.Cc(2,Xi,8,3,"div",8),u.Tb()),2&e){var t=u.gc();u.Cb(1),u.mc("ngIf",t.scanCode),u.Cb(1),u.mc("ngIf",!t.scanCode)}}function it(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",18),u.Pb(1,"app-pedidos-atendidos"),u.Ub(2,"div",67),u.Ub(3,"button",68),u.cc("click",(function(){return u.wc(t),u.gc().isShowResumen=!1})),u.Pb(4,"i",69),u.Ec(5," Atras "),u.Tb(),u.Tb(),u.Tb()}}function tt(e,i){if(1&e){var t=u.Vb();u.Sb(0),u.Ub(1,"div",71),u.cc("click",(function(){return u.wc(t),u.gc(2).entregaTodo()})),u.Ub(2,"span"),u.Ec(3,"Listo, pedidos entregados."),u.Tb(),u.Tb(),u.Rb()}}function ot(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",72),u.cc("click",(function(){return u.wc(t),u.gc(2).goRuta()})),u.Ub(1,"span"),u.Ec(2,"Ver Ruta"),u.Tb(),u.Ub(3,"p",73),u.Ec(4,"Ruta mas corta."),u.Tb(),u.Tb()}}function at(e,i){if(1&e&&(u.Ub(0,"div",70),u.Cc(1,tt,4,0,"ng-container",19),u.Cc(2,ot,5,0,"ng-template",null,20,u.Dc),u.Tb()),2&e){var t=u.vc(3),o=u.gc();u.Cb(1),u.mc("ngIf",o.isEntregadoAll)("ngIfElse",t)}}var nt,st=((nt=function(){function e(i,t,o,a,n,s,r,c,d,l){_classCallCheck(this,e),this.infoTokenService=i,this.utilService=t,this.socketService=o,this.dialog=a,this.repartidorService=n,this.pedidoRepartidorService=s,this.gpsPositionService=r,this.listeService=c,this.geoPositionService=d,this.router=l,this.nomRepartidor="",this.sumListPedidos=0,this.sumGananciaTotal=0,this.listRepartidoresInformativo=[],this.isShowResumen=!1,this.scanCode=!1,this.loadingScan=!1,this.isResulScan=!1,this.isEntregadoAll=!1,this.isRepartidorRed=!1,this.destroy$=new C.Subject,this.geoPositionActual=new je.a,this.displayedColumns=["Pedido","Cliente","Importe"]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.infoToken=this.infoTokenService.getInfoUs(),console.log("this.infoToken lista pedidos",this.infoToken),this.isRepartidorRed=!this.infoToken.usuario.idsede_suscrito,this.nomRepartidor=this.infoToken.usuario.nombre+" "+this.infoToken.usuario.apellido,this.loadPedidosPendiente(),this.listenNewPedidos(),console.log("this.isRepartidorRed",this.isRepartidorRed),this.scanCode=this.isRepartidorRed,this.geoPositionService.onGeoWatchPosition(),this.geoPositionActual=this.geoPositionService.geoPosition,this.geoPositionService.geoPositionNow$.pipe(Object(Te.takeUntil)(this.destroy$)).subscribe((function(i){(i=(null==i?void 0:i.latitude)?i:e.geoPositionActual).latitude&&(e.geoPositionActual=i)}))}},{key:"ngOnDestroy",value:function(){this.destroy$.next(!0),this.destroy$.unsubscribe()}},{key:"loadPedidosPendiente",value:function(){var e=this;this.socketService.onRepartidorGetPedidoPendienteAceptar().subscribe((function(i){console.log(i),e.pedidoRepartidorService.setPedidoPorAceptar(i[0].pedido_por_aceptar),e.darFormatoGrupoPedidosRecibidos(i[0].pedido_por_aceptar),e.pedidoRepartidorService.setPedidoPorAceptar(i[0].pedido_por_aceptar)}))}},{key:"succesScan",value:function(e){var i=this;this.loadingScan=!0,this.pedidoRepartidorService.confirmarAsignacionReadBarCode(e).subscribe((function(e){i.loadingScan=!1,i.isResulScan=!0,i.ordenAsingadaScan=e.elPedido,console.log(e),i.darFormatoGrupoPedidosRecibidos(e.pedidos_repartidor),console.log(e)}))}},{key:"darFormatoGrupoPedidosRecibidos",value:function(e){var i=this;e&&this.pedidoRepartidorService.loadPedidosRecibidos(e.pedidos.join(",")).subscribe((function(t){var o;console.log("res",t);var a=t.map((function(e){e.json_datos_delivery=JSON.parse(e.json_datos_delivery),o=0===(o=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal))?parseFloat(e.json_datos_delivery.p_subtotales[e.json_datos_delivery.p_subtotales.length-1].importe):o,e.importe_pagar_comercio=parseFloat(o)-parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery),e.importe_pagar_comercio=2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago?0:e.importe_pagar_comercio;var i=e.json_datos_delivery.p_header.arrDatosDelivery.propina.value?parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.propina.value):0;return e.comsion_entrea_total=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery)+i,e}));i.establecimientoIni=a[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento,i.establecimientoIni.longitude=parseFloat(i.establecimientoIni.longitude),i.establecimientoIni.latitude=parseFloat(i.establecimientoIni.latitude);var n=JSON.parse(JSON.stringify(a));i.pedidoRepartidorService.setLocalIds(e),i.pedidoRepartidorService.setLocalItems(n),i.iniComponente()}))}},{key:"iniComponente",value:function(){this.pedidoRepartidorService.init(),this.dataPedido=this.pedidoRepartidorService.getLocal(),this.listPedidos=this.pedidoRepartidorService.getLocalItems(),this.listPedidos=this.listPedidos.sort((function(e,i){return parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)-parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)})),this.checkIsEntregaALL(),this.dataPedido.idsede=this.listPedidos[0].idsede,this.pedidoRepartidorService.setLocal(),this.sumListPedidos=this.listPedidos.map((function(e){return e.importe_pagar_comercio})).reduce((function(e,i){return e+i}),0),this.sumGananciaTotal=this.listPedidos.map((function(e){return e.comsion_entrea_total})).reduce((function(e,i){return e+i}),0),this.calcHora()}},{key:"calcHora",value:function(){var e=this;this.calHoraList(),this.timerRun=setInterval((function(){e.calHoraList()}),6e4)}},{key:"calHoraList",value:function(){var e=this;this.listPedidos.map((function(i){i.hora_show=e.utilService.xTiempoTranscurridos_en_minutos(i.hora)}))}},{key:"showDetallePedido",value:function(e){var i=this,t=new r.e;e.isRepartidorRed=!0,t.disableClose=!0,t.hasBackdrop=!0,t.width="700px",t.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],t.data={laOrden:e},this.pedidoRepartidorService.setPedidoSelect(e),this.dialog.open(Ci,t).afterClosed().subscribe((function(e){console.log("el pedido",e),i.checkIsEntregaALL(),"E"===e.pwa_estado&&i.openDialogCalificacion(e)}))}},{key:"checkIsEntregaALL",value:function(){var e=this.listPedidos.filter((function(e){return"E"!==e.pwa_estado}));this.isEntregadoAll=0===e.length}},{key:"listenNewPedidos",value:function(){var e=this;this.socketService.onPedidoAsignadoFromComercio().subscribe((function(i){console.log("nuevo pedido asignado",i);var t=e.pedidoRepartidorService.addPedidoInListPedidosPendientes(i);console.log(t),e.darFormatoGrupoPedidosRecibidos(t.pedidos_repartidor)})),this.socketService.onDeliveryPedidoFin().pipe(Object(Te.takeUntil)(this.destroy$)).subscribe((function(i){e.openDialogCalificacion(i)}))}},{key:"loadPedidosPropios",value:function(){var e=this;this.repartidorService.getMisPedidosPropiosAsignados().subscribe((function(i){i.map((function(e){e.json_datos_delivery=JSON.parse(e.json_datos_delivery)})),e.listPedidos=i}))}},{key:"openDialogCalificacion",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor;var i=new ke;i.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,i.idcliente=this.dataPedido.datosCliente.idcliente,i.idpedido=this.dataPedido.idpedido,i.tipo=2,i.showNombre=!0,i.nombre=this.dataPedido.datosDelivery.nombre,i.titulo="Como calificas al cliente?",i.showTitulo=!0,i.showMsjTankyou=!0;var t=new r.e;t.disableClose=!0,t.hasBackdrop=!0,t.data={dataCalificado:i},this.dialog.open(Ie,t).afterClosed().subscribe((function(i){e.pedidoRepartidorService.finalizarPedidoPropioRepartidor()}))}},{key:"goRuta",value:function(){var e="";this.listPedidos.map((function(i){e+="".concat(i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude,",").concat(i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude,"+to:")})),e=e.slice(0,-4),window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=".concat(this.establecimientoIni.latitude,",").concat(this.establecimientoIni.longitude,"&daddr=").concat(e),"_blank")}},{key:"entregaTodo",value:function(){this.pedidoRepartidorService.listaPedidosEntregados(),this.listPedidos=null,this.sumListPedidos=0,this.sumGananciaTotal=0}},{key:"resumenDelDia",value:function(){this.isShowResumen=!0}},{key:"goBackRepartidorRed",value:function(){this.router.navigate(["./main/pedidos"])}}]),e}()).\u0275fac=function(e){return new(e||nt)(u.Ob(l.a),u.Ob(yi),u.Ob(g.a),u.Ob(r.b),u.Ob(p.a),u.Ob(P.a),u.Ob(d.a),u.Ob(b.a),u.Ob(d.a),u.Ob(s.b))},nt.\u0275cmp=u.Ib({type:nt,selectors:[["app-mapa-pedidos"]],decls:13,vars:3,consts:[[1,"container-body","animated","fadeInDown"],[1,"bg-dark","text-white","fs-13","d-flex","justify-content-between","align-items-center","p-2"],["matRipple","",1,"pl-2","btn-link-2","xCursor",3,"click"],[1,"d-flex","align-items-center"],[1,"fa","fa-qrcode","fa-2x"],[1,"fs-11","pl-2"],["matRipple","",1,"pr-2",3,"click"],[1,"btn-link-2","xCursor"],[4,"ngIf"],["class","animated fadeIn",4,"ngIf"],["class","xfooter p-2",4,"ngIf"],["class","w-100 center-div-screen",4,"ngIf"],[1,"w-100","center-div-screen"],["class","animated fadeIn text-center",4,"ngIf"],[1,"animated","fadeIn","text-center"],[3,"codeScanSucces"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fs-12"],[1,"animated","fadeIn"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"w-100","text-center"],[1,"fa","fa-spinner","fa-spin","fa-2x","fa-fw"],[1,"d-flex","justify-content-center"],[1,"btn","btn-sm","btn-success","mr-1",3,"click"],[1,"p-3"],["class","p-5 w-100 text-center",4,"ngIf"],["mat-table","","class","w-100",3,"dataSource",4,"ngIf"],["class","w-100 pt-3",4,"ngIf"],[1,"p-5","w-100","text-center"],["src","./assets/images/waiting.JPG","width","250px","alt","waiting"],["mat-stroked-button","",3,"click"],[1,"fa","fa-arrow-left","pr-2"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","Pedido"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Cliente"],["mat-header-cell","","class","text-left",4,"matHeaderCellDef"],["mat-cell","","class","text-left",4,"matCellDef"],["matColumnDef","Importe"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"fw-600","fs-12"],[1,"fw-100","text-secondary","fs-12"],[1,"text-success","fs-10",3,"ngClass"],["mat-header-cell","",1,"text-left"],["mat-cell","",1,"text-left"],[1,"fw-100","fs-12"],[1,"fw-600","badge",3,"ngClass"],[1,"text-secondary","fs-10","ml-1"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["class","badge badge-info",4,"ngIf"],[1,"badge","badge-info"],["mat-header-row",""],["mat-row","",3,"ngClass","click"],[1,"w-100","pt-3"],[1,"text-right","pr-4"],[1,"text-secondary","pr-2"],[1,"fw-600","fs-18"],[1,"text-secondary","fs-13","pr-2"],[1,"fw-600","fs-13","badge","badge-info"],[1,"text-center","w-100"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"fa","fa-arrow-left"],[1,"xfooter","p-2"],["matRipple","",1,"btn","btn-secondary","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],["matRipple","",1,"btn","btn-success","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],[1,"fs-11","fw-100"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div",2),u.cc("click",(function(){return i.scanCode=!0})),u.Ub(3,"div",3),u.Pb(4,"i",4),u.Ub(5,"span",5),u.Ec(6,"Escanear Codigo"),u.Tb(),u.Tb(),u.Tb(),u.Ub(7,"div",6),u.cc("click",(function(){return i.resumenDelDia()})),u.Ub(8,"span",7),u.Ec(9,"Resumen"),u.Tb(),u.Tb(),u.Tb(),u.Cc(10,et,3,2,"div",8),u.Cc(11,it,6,0,"div",9),u.Cc(12,at,4,2,"div",10),u.Tb()),2&e&&(u.Cb(10),u.mc("ngIf",!i.isShowResumen),u.Cb(1),u.mc("ngIf",i.isShowResumen),u.Cb(1),u.mc("ngIf",i.listPedidos))},directives:[A.e,n.m,xi,v.a,Ei.j,Ei.c,Ei.e,Ei.b,Ei.g,Ei.i,Ei.d,Ei.a,n.k,Ei.f,Ei.h,J],pipes:[n.u,n.e],styles:[".content-body-mapa[_ngcontent-%COMP%]{height:calc(100vh - 109px);overflow:auto}.btn-link-2[_ngcontent-%COMP%]:hover{text-decoration:none;color:gold;cursor:pointer}.center-div-screen[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:80vh;overflow:hidden}p[_ngcontent-%COMP%]{margin:0}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}.color-checked[_ngcontent-%COMP%]{background-color:#e8f5e9}"]}),nt);function rt(e,i){1&e&&(u.Ub(0,"th",33),u.Ec(1," Pedido "),u.Tb())}var ct=function(e){return{"text-danger":e}};function dt(e,i){if(1&e&&(u.Ub(0,"td",34),u.Ub(1,"p",35),u.Ec(2),u.Tb(),u.Ub(3,"p",36),u.Ub(4,"span",37),u.Ec(5),u.Tb(),u.Tb(),u.Tb()),2&e){var t=i.$implicit;u.Cb(2),u.Fc(t.idpedido),u.Cb(2),u.mc("ngClass",u.rc(3,ct,t.hora_show>30)),u.Cb(1),u.Gc(" ",t.hora_show," min ")}}function lt(e,i){1&e&&(u.Ub(0,"th",38),u.Ec(1," Cliente "),u.Tb())}function pt(e,i){1&e&&(u.Ub(0,"span",44),u.Ec(1," APP "),u.Tb())}var bt=function(e,i,t){return{"badge-primary":e,"badge-info":i,"badge-secondary":t}};function ut(e,i){if(1&e&&(u.Ub(0,"td",39),u.Ub(1,"p",35),u.Ec(2),u.hc(3,"titlecase"),u.Tb(),u.Ub(4,"p",40),u.Cc(5,pt,2,0,"span",41),u.Ub(6,"span",42),u.Ec(7),u.hc(8,"titlecase"),u.Tb(),u.Ub(9,"span",43),u.Ec(10),u.Tb(),u.Tb(),u.Tb()),2&e){var t=i.$implicit;u.Cb(2),u.Gc(" ",u.ic(3,5,t.json_datos_delivery.p_header.arrDatosDelivery.nombre)," "),u.Cb(3),u.mc("ngIf",1===t.json_datos_delivery.p_header.isCliente),u.Cb(1),u.mc("ngClass",u.tc(9,bt,3===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,2===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,1===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)),u.Cb(1),u.Gc(" ",u.ic(8,7,t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion)," "),u.Cb(3),u.Gc(" ",t.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km," Km ")}}function ht(e,i){1&e&&(u.Ub(0,"th",45),u.Ec(1," Importe "),u.Tb())}function ft(e,i){1&e&&(u.Ub(0,"p",48),u.Ec(1," pagado con tarjeta "),u.Tb())}function vt(e,i){if(1&e&&(u.Ub(0,"td",46),u.Ub(1,"p",35),u.Ec(2),u.hc(3,"number"),u.Tb(),u.Cc(4,ft,2,0,"p",47),u.Tb()),2&e){var t=i.$implicit;u.Cb(2),u.Gc(" ",u.jc(3,2,t.importe_pagar_comercio,".2")," "),u.Cb(2),u.mc("ngIf",2===t.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)}}function mt(e,i){1&e&&u.Pb(0,"tr",49)}var gt=function(e){return{"color-checked":e}};function Pt(e,i){if(1&e){var t=u.Vb();u.Ub(0,"tr",50),u.cc("click",(function(){u.wc(t);var e=i.$implicit;return u.gc().showDetallePedido(e)})),u.Tb()}2&e&&u.mc("ngClass",u.rc(1,gt,"E"===i.$implicit.pwa_estado))}function Ct(e,i){if(1&e){var t=u.Vb();u.Sb(0),u.Ub(1,"div",54),u.cc("click",(function(){return u.wc(t),u.gc(2).entregaTodo()})),u.Ub(2,"span"),u.Ec(3,"Listo, pedidos entregados."),u.Tb(),u.Tb(),u.Rb()}}function yt(e,i){if(1&e){var t=u.Vb();u.Ub(0,"div",55),u.cc("click",(function(){return u.wc(t),u.gc(2).goRuta()})),u.Ub(1,"span"),u.Ec(2,"Ver Ruta"),u.Tb(),u.Ub(3,"p",56),u.Ec(4,"Ruta mas corta."),u.Tb(),u.Tb()}}function _t(e,i){if(1&e&&(u.Ub(0,"div",51),u.Cc(1,Ct,4,0,"ng-container",52),u.Cc(2,yt,5,0,"ng-template",null,53,u.Dc),u.Tb()),2&e){var t=u.vc(3),o=u.gc();u.Cb(1),u.mc("ngIf",o.isEntregadoAll)("ngIfElse",t)}}var Tt,kt=((Tt=function(){function e(i,t,o,a,n,s,r,c,d,l){_classCallCheck(this,e),this.infoTokenService=i,this.pedidoRepartidorService=t,this.utilService=o,this.geoPositionService=a,this.listenService=n,this.calcDistanciaService=s,this.router=r,this.dialog=c,this.repartidorServcice=d,this.socketService=l,this.sumListPedidos=0,this.sumGananciaTotal=0,this.btnShow=!0,this.btnTitlePasos="Vamos, vamos!!",this.displayedColumns=["Pedido","Cliente","Importe"],this.geoPositionActual=new je.a,this.geoPositionComercio=new je.a,this.destroy$=new C.Subject,this.isEntregadoAll=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.iniComponente(),this.geoPositionService.onGeoWatchPosition(),this.listenGeoPosition(),this.socketService.onRepartidorGetPedidoPendienteAceptar().subscribe((function(i){e.pedidoRepartidorService.setPedidoPorAceptar(i[0].pedido_por_aceptar),e.darFormatoGrupoPedidosRecibidos(i[0].pedido_por_aceptar)}))}},{key:"iniComponente",value:function(){this.pedidoRepartidorService.init(),this.dataPedido=this.pedidoRepartidorService.getLocal(),this.listPedidos=this.pedidoRepartidorService.getLocalItems(),this.listPedidos=this.listPedidos.sort((function(e,i){return parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)-parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)})),this.checkIsEntregaALL(),this.comercioPedido=this.listPedidos[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento,this.dataPedido.idsede=this.listPedidos[0].idsede,this.pedidoRepartidorService.setLocal(),this.geoPositionComercio.latitude="string"==typeof this.comercioPedido.latitude?parseFloat(this.comercioPedido.latitude):this.comercioPedido.latitude,this.geoPositionComercio.longitude="string"==typeof this.comercioPedido.longitude?parseFloat(this.comercioPedido.longitude):this.comercioPedido.longitude,this.sumListPedidos=this.listPedidos.map((function(e){return e.importe_pagar_comercio})).reduce((function(e,i){return e+i}),0),this.sumGananciaTotal=this.dataPedido.sumGananciaTotal,this.showPasos(),this.calcHora()}},{key:"ngOnDestroy",value:function(){clearInterval(this.timerRun),this.destroy$.next(!0),this.destroy$.unsubscribe()}},{key:"darFormatoGrupoPedidosRecibidos",value:function(e){var i=this;e&&this.pedidoRepartidorService.loadPedidosRecibidos(e.pedidos.join(",")).subscribe((function(t){var o=t.map((function(e){return e.json_datos_delivery=JSON.parse(e.json_datos_delivery),e.importe_pagar_comercio=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal)-parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery),e.importe_pagar_comercio=2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago?0:e.importe_pagar_comercio,e})),a=JSON.parse(JSON.stringify(o));i.pedidoRepartidorService.setLocalIds(e),i.pedidoRepartidorService.setLocalItems(a),i.iniComponente()}))}},{key:"calcHora",value:function(){var e=this;this.calHoraList(),this.timerRun=setInterval((function(){e.calHoraList()}),6e4)}},{key:"calHoraList",value:function(){var e=this;this.listPedidos.map((function(i){i.hora_show=e.utilService.xTiempoTranscurridos_en_minutos(i.hora)}))}},{key:"listenGeoPosition",value:function(){var e=this;this.geoPositionActual=this.geoPositionService.geoPosition,this.geoPositionService.geoPositionNow$.pipe(Object(Te.takeUntil)(this.destroy$)).subscribe((function(i){(i=(null==i?void 0:i.latitude)?i:e.geoPositionActual).latitude&&(e.geoPositionActual=i,e.geoPositionComercio.latitude&&e.calcDistanciaService.calcDistancia(e.geoPositionActual,e.geoPositionComercio,120)||1===e.dataPedido.pedido_paso_va&&(e.dataPedido.pedido_paso_va=2,e.pedidoRepartidorService.setPedidoPasoVa(2),e.dataPedido.pedido_paso_va=2,console.log("guarda paso va 2"),e.repartidorServcice.guardarPasoVa(2),e.showPasos()))}))}},{key:"showPasos",value:function(){switch(this.dataPedido.pedido_paso_va){case null:case 1:this.btnTitlePasos="Empezar";break;default:this.btnShow=!1,this.btnTitlePasos="Ir a Entregar"}}},{key:"goRuta",value:function(){var e="";this.listPedidos.map((function(i){e+="".concat(i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude,",").concat(i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude,"+to:")})),e=e.slice(0,-4),window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(e),"_blank")}},{key:"entregaTodo",value:function(){this.pedidoRepartidorService.listaPedidosEntregados(),this.listPedidos=null,this.sumListPedidos=0,this.sumGananciaTotal=0,this.router.navigate(["./main/pedidos"])}},{key:"btnEjecutar",value:function(){switch(this.dataPedido.pedido_paso_va){case 1:var e="";this.listPedidos.map((function(i){e+="".concat(i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude,",").concat(i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude,"+to:")})),e=e.slice(0,-4),window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(e),"_blank");break;default:this.pedidoRepartidorService.setPedidoPasoVa(3),this.dataPedido.pedido_paso_va=3,this.repartidorServcice.guardarPasoVa(3),this.router.navigate(["/main/indicaciones-mapa-grupo"])}}},{key:"irAlComercio",value:function(){window.open("http://maps.google.com/maps?saddr=".concat(this.geoPositionActual.latitude,",").concat(this.geoPositionActual.longitude,"&daddr=").concat(this.geoPositionComercio.latitude,",").concat(this.geoPositionComercio.longitude),"_blank")}},{key:"showDetallePedido",value:function(e){var i=this,t=new r.e;e.isRepartidorRed=!0,t.disableClose=!0,t.hasBackdrop=!0,t.width="700px",t.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],t.data={laOrden:e},this.pedidoRepartidorService.setPedidoSelect(e),this.dialog.open(Ci,t).afterClosed().subscribe((function(e){console.log("el pedido",e),i.checkIsEntregaALL(),"E"===e.pwa_estado&&i.openDialogCalificacion(e)}))}},{key:"checkIsEntregaALL",value:function(){var e=this.listPedidos.filter((function(e){return"E"!==e.pwa_estado}));this.isEntregadoAll=0===e.length}},{key:"openDialogCalificacion",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor;var i=new ke;i.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,i.idcliente=this.dataPedido.datosCliente.idcliente,i.idpedido=this.dataPedido.idpedido,i.tipo=2,i.showNombre=!0,i.nombre=this.dataPedido.datosDelivery.nombre,i.titulo="Como calificas al cliente?",i.showTitulo=!0,i.showMsjTankyou=!0;var t=new r.e;t.disableClose=!0,t.hasBackdrop=!0,t.data={dataCalificado:i},this.dialog.open(Ie,t).afterClosed().subscribe((function(i){e.pedidoRepartidorService.finalizarPedidoPropioRepartidor()}))}}]),e}()).\u0275fac=function(e){return new(e||Tt)(u.Ob(l.a),u.Ob(P.a),u.Ob(yi),u.Ob(d.a),u.Ob(b.a),u.Ob(_e),u.Ob(s.b),u.Ob(r.b),u.Ob(p.a),u.Ob(g.a))},Tt.\u0275cmp=u.Ib({type:Tt,selectors:[["app-list-grupo-pedidos"]],decls:54,vars:14,consts:[[1,"animated","fadeInDown","container-body"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"p-4"],[1,"fw-600","text-secondary"],[1,"row"],[1,"col-6"],[1,"fw-100","fs-13"],[1,"fw-100","fs-12","text-secondary"],[1,"fw-100","fs-13","text-secondary"],[1,"w-100","d-flex","justify-content-end"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"m-0"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","Pedido"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Cliente"],["mat-header-cell","","class","text-left",4,"matHeaderCellDef"],["mat-cell","","class","text-left",4,"matCellDef"],["matColumnDef","Importe"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"w-100","pt-3"],[1,"text-right","pr-4"],[1,"text-secondary","pr-2"],[1,"fw-600","fs-18"],[1,"text-secondary","fs-13","pr-2"],[1,"fw-600","fs-13","badge","badge-info"],[1,"p-2"],[1,"fw-100","fs-12","text-info"],["class","xfooter p-2",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"fw-600","fs-12"],[1,"fw-100","text-secondary","fs-12"],[1,"text-success","fs-10",3,"ngClass"],["mat-header-cell","",1,"text-left"],["mat-cell","",1,"text-left"],[1,"fw-100","fs-12"],["class","fw-600 badge badge-success mr-1",4,"ngIf"],[1,"fw-600","badge",3,"ngClass"],[1,"text-secondary","fs-10","ml-1"],[1,"fw-600","badge","badge-success","mr-1"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["class","badge badge-info",4,"ngIf"],[1,"badge","badge-info"],["mat-header-row",""],["mat-row","",3,"ngClass","click"],[1,"xfooter","p-2"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["matRipple","",1,"btn","btn-secondary","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],["matRipple","",1,"btn","btn-success","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],[1,"fs-11","fw-100"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div"),u.Ub(3,"span"),u.Ec(4,"Lista de pedidos"),u.Tb(),u.Tb(),u.Tb(),u.Ub(5,"div"),u.Ub(6,"div",2),u.Ub(7,"p",3),u.Ec(8,"Dir\xedjase hacia el comercio:"),u.Tb(),u.Ub(9,"div",4),u.Ub(10,"div",5),u.Ub(11,"p",6),u.Ec(12),u.Tb(),u.Ub(13,"p",7),u.Ec(14),u.Tb(),u.Ub(15,"p",8),u.Ec(16," Pedidos Asignados: "),u.Tb(),u.Tb(),u.Ub(17,"div",5),u.Ub(18,"div",9),u.Ub(19,"button",10),u.cc("click",(function(){return i.irAlComercio()})),u.Ec(20,"Ir al comercio"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Pb(21,"hr",11),u.Ub(22,"table",12),u.Sb(23,13),u.Cc(24,rt,2,0,"th",14),u.Cc(25,dt,6,5,"td",15),u.Rb(),u.Sb(26,16),u.Cc(27,lt,2,0,"th",17),u.Cc(28,ut,11,13,"td",18),u.Rb(),u.Sb(29,19),u.Cc(30,ht,2,0,"th",20),u.Cc(31,vt,5,5,"td",21),u.Rb(),u.Cc(32,mt,1,0,"tr",22),u.Cc(33,Pt,1,3,"tr",23),u.Tb(),u.Ub(34,"div",24),u.Ub(35,"div",25),u.Ub(36,"div"),u.Ub(37,"span",26),u.Ec(38,"Total a pagar: "),u.Tb(),u.Ub(39,"span",27),u.Ec(40),u.hc(41,"number"),u.Tb(),u.Tb(),u.Ub(42,"div"),u.Ub(43,"span",28),u.Ec(44,"Ganancia: "),u.Tb(),u.Ub(45,"span",29),u.Ec(46),u.hc(47,"number"),u.Tb(),u.Tb(),u.Ub(48,"div",30),u.Ub(49,"span",31),u.Ec(50,"Cuando sea posible elige pagar cero contacto: Yape \xf3 Tarjeta"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Pb(51,"br"),u.Pb(52,"br"),u.Tb(),u.Cc(53,_t,4,2,"div",32),u.Tb()),2&e&&(u.Cb(12),u.Gc(" ",i.comercioPedido.nombre," "),u.Cb(2),u.Gc(" ",i.comercioPedido.direccion," "),u.Cb(8),u.mc("dataSource",i.listPedidos),u.Cb(10),u.mc("matHeaderRowDef",i.displayedColumns),u.Cb(1),u.mc("matRowDefColumns",i.displayedColumns),u.Cb(7),u.Gc(" ",u.jc(41,8,i.sumListPedidos,".2")," "),u.Cb(6),u.Gc(" ",u.jc(47,11,i.sumGananciaTotal,".2")," "),u.Cb(7),u.mc("ngIf",i.listPedidos))},directives:[Ei.j,Ei.c,Ei.e,Ei.b,Ei.g,Ei.i,n.m,Ei.d,Ei.a,n.k,Ei.f,Ei.h,A.e],pipes:[n.e,n.u],styles:["p[_ngcontent-%COMP%]{margin:0}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}.color-checked[_ngcontent-%COMP%]{background-color:#e8f5e9}"]}),Tt),wt=t("3sZV");function St(e,i){if(1&e&&u.Pb(0,"map-marker",3,4),2&e){var t=i.$implicit,o=u.gc();u.mc("position",t.position)("label",t.label)("title",t.title)("options",o.markerOptionsRepartidorProduccion)}}function Ut(e,i){if(1&e){var t=u.Vb();u.Ub(0,"map-marker",5,4),u.cc("mapClick",(function(){u.wc(t);var e=i.index;return u.gc().openPedido(e)})),u.Tb()}if(2&e){var o=i.$implicit;u.mc("position",o.position)("label",o.label)("title",o.title)("options",o.options)}}var Rt,Dt,xt,Et,Ot=((Rt=function(){function e(i,t,o,a){_classCallCheck(this,e),this.geoUbicationService=i,this.pedidoRepartidorService=t,this.repartidorService=o,this.listenService=a,this.infowindow=new google.maps.InfoWindow,this.pedidoOpen=new u.o,this.zoom=15,this.options={zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0},this.trazarRuta=!1,this.markerOptionsPedido={draggable:!1,icon:"./assets/images/marker-1.png"},this.markersPedidos=[],this.markerOptionsRepartidorDesarrollo={draggable:!0,icon:"./assets/images/delivery-man.png"},this.markersRepartidorDesarrollo=[],this.markerOptionsRepartidorProduccion={icon:"./assets/images/delivery-man.png"},this.markersRepartidorProduccion=[],this._isSedeFirtPedido=0,this._isFirtPedido=0}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.trazarRuta&&(this.listPedidos=this.pedidoRepartidorService.getLocalItems(),this._isSedeFirtPedido=this.listPedidos[0].idsede,this._isFirtPedido=this.listPedidos[0],this.listPedidos=this.listPedidos.sort((function(e,i){return parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)-parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)})),this.addMarkerPedidos()),this.listenUbicaion(),this.trazarRuta&&this.directionMap(),this.listenPedidos()}},{key:"listenPedidos",value:function(){var e=this;this.listenService.newPedidoRepartoPropio$.subscribe((function(i){i&&(i.idpedido="string"==typeof i.idpedido?parseInt(i.idpedido,0):i.idpedido,e.listPedidos.filter((function(e){return e.idpedido===i.idpedido}))[0]||e.listPedidos.push(i),e.addMarkerPedidos())})),this.listenService.pedidoModificado$.subscribe((function(i){i&&(e.markersPedidos.filter((function(e){return e.idpedido===i.idpedido}))[0].options={animation:0,draggable:!1,icon:"./assets/images/marker-3.png"})}))}},{key:"enviarUbicacion",value:function(e){this.repartidorService.emitPositionNow(e,this.pedidoRepartidorService.pedidoRepartidor,this.trazarRuta?this._isSedeFirtPedido:this.pedidoRepartidorService.pedidoRepartidor.idsede||null)}},{key:"listenUbicaion",value:function(){var e=this,i=this.geoUbicationService.getGeoPosition();this.geoUbicationService.geoPositionNow$.subscribe((function(t){e.center={lat:(t=t.latitude?t:i).latitude,lng:t.longitude};var o=new je.a;o.latitude=e.center.lat,o.longitude=e.center.lng,e.geoUbicationService.geoPosition=o,e.geoUbicationService.set(),e.enviarUbicacion(e.center),e.addMyMarkert()})),this.geoUbicationService.onGeoWatchPosition()}},{key:"addMyMarkert",value:function(){this.markersRepartidorProduccion.push({position:this.center,label:{fontWeight:"600",text:"Yo"},title:"Repartidor",info:"Repartidor",options:{animation:google.maps.Animation.BOUNCE}})}},{key:"addMarkerPedidos",value:function(){var e=this;this.markersPedidos=[];var i=this.listPedidos.length-1;this.listPedidos.map((function(t,o){var a="marker-1.png",n="Pedido "+(o+1),s=t.json_datos_delivery.p_header.arrDatosDelivery;t.isLast=i===o,"4"===t.pwa_delivery_status.toString()&&(a="marker-3.png",n="-"),e.markersPedidos.push({idpedido:t.idpedido,position:{lat:s.direccionEnvioSelected.latitude,lng:s.direccionEnvioSelected.longitude},label:{color:"#0d47a1",fontWeight:"600",text:n},title:"Pedido",info:t.idpedido,options:{draggable:!1,animation:t.isLast?google.maps.Animation.BOUNCE:0,icon:"./assets/images/".concat(a)}})}))}},{key:"openPedido",value:function(e){this.pedidoOpen.emit(this.listPedidos[e])}},{key:"directionMap",value:function(){var e=new google.maps.DirectionsService,i=[];this.markersPedidos.map((function(e){i.push({location:e.position,stopover:!0})}));var t={origin:this.center,destination:this.markersPedidos[this.markersPedidos.length-1].position,waypoints:i,optimizeWaypoints:!0,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL,durationInTraffic:!1,avoidHighways:!0,avoidTolls:!0},o=new google.maps.DirectionsRenderer({preserveViewport:!1,suppressMarkers:!0});o.setMap(this.map._googleMap),e.route(t,(function(e,i){i===google.maps.DirectionsStatus.OK&&o.setDirections(e)}))}},{key:"addMyMarkertDesarrolllo",value:function(){this.markersRepartidorDesarrollo.push({position:this.center,label:{fontWeight:"600",text:"Yo"},title:"Repartidor",info:"Repartidor",options:{animation:google.maps.Animation.BOUNCE}})}},{key:"listeDesarrolloUbicacion",value:function(){this.center={lat:-6.029306,lng:-76.969725},this.addMyMarkertDesarrolllo()}},{key:"updateUbicationDesarrollo",value:function(e){console.log("new ubicacion",e),this.center.lat=e.latLng.lat(),this.center.lng=e.latLng.lng();var i=new je.a;i.latitude=this.center.lat,i.longitude=this.center.lng,this.geoUbicationService.geoPosition=i,this.geoUbicationService.set(),this.enviarUbicacion(this.center)}},{key:"listaPedidos",set:function(e){this.listPedidos=e,e&&this.addMarkerPedidos()}}]),e}()).\u0275fac=function(e){return new(e||Rt)(u.Ob(d.a),u.Ob(P.a),u.Ob(p.a),u.Ob(b.a))},Rt.\u0275cmp=u.Ib({type:Rt,selectors:[["app-mapa-ordenes"]],viewQuery:function(e,i){var t;1&e&&u.Jc(wt.a,!0),2&e&&u.uc(t=u.dc())&&(i.map=t.first)},inputs:{trazarRuta:"trazarRuta",listaPedidos:"listaPedidos"},outputs:{pedidoOpen:"pedidoOpen"},decls:3,vars:5,consts:[["height","100%","width","100%",3,"zoom","center","options"],[3,"position","label","title","options",4,"ngFor","ngForOf"],[3,"position","label","title","options","mapClick",4,"ngFor","ngForOf"],[3,"position","label","title","options"],["markerElem",""],[3,"position","label","title","options","mapClick"]],template:function(e,i){1&e&&(u.Ub(0,"google-map",0),u.Cc(1,St,2,4,"map-marker",1),u.Cc(2,Ut,2,4,"map-marker",2),u.Tb()),2&e&&(u.mc("zoom",i.zoom)("center",i.center)("options",i.options),u.Cb(1),u.mc("ngForOf",i.markersRepartidorProduccion),u.Cb(1),u.mc("ngForOf",i.markersPedidos))},directives:[wt.a,n.l,wt.c],styles:[""]}),Rt),It=[{path:"",component:$,data:{titulo:"Inicio"},children:[{path:"pedidos",component:Ce,data:{titulo:"Pedido"}},{path:"indicaciones",component:Je,data:{titulo:"Indicaciones Pedido"}},{path:"pedido-detalle",component:bi,data:{titulo:"Indicaciones Pedido"}},{path:"pedidos-atendidos",component:J,data:{titulo:"Pedidos Atendidos"}},{path:"mapa-de-pedidos",component:st,data:{titulo:"Mapa de pedidos"}},{path:"list-grupo-pedidos",component:kt,data:{titulo:"Grupo de pedidos"}},{path:"indicaciones-mapa-grupo",component:(Dt=function(){function e(i,t){_classCallCheck(this,e),this.dialog=i,this.pedidoRepartidorService=t}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"openDialogOrden",value:function(e){var i=new r.e;e.isRepartidorRed=!0,i.disableClose=!0,i.hasBackdrop=!0,i.width="700px",i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],i.data={laOrden:e},this.pedidoRepartidorService.setPedidoSelect(e),this.dialog.open(Ci,i)}}]),e}(),Dt.\u0275fac=function(e){return new(e||Dt)(u.Ob(r.b),u.Ob(P.a))},Dt.\u0275cmp=u.Ib({type:Dt,selectors:[["app-indicaciones-grupo-mapa"]],decls:7,vars:1,consts:[[1,"animated","fadeInDown","container-body"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"content-body-mapa"],[3,"trazarRuta","pedidoOpen"]],template:function(e,i){1&e&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div"),u.Ub(3,"span"),u.Ec(4,"Pedidos - Ruta mas corta"),u.Tb(),u.Tb(),u.Tb(),u.Ub(5,"div",2),u.Ub(6,"app-mapa-ordenes",3),u.cc("pedidoOpen",(function(e){return i.openDialogOrden(e)})),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Cb(6),u.mc("trazarRuta",!0))},directives:[Ot],styles:[".content-body-mapa[_ngcontent-%COMP%]{height:calc(100vh - 109px);overflow:auto}"]}),Dt),data:{titulo:"Indicaciones en el mapa"}}]}],jt=((xt=function e(){_classCallCheck(this,e)}).\u0275mod=u.Mb({type:xt}),xt.\u0275inj=u.Lb({factory:function(e){return new(e||xt)},imports:[[s.d.forChild(It)],s.d]}),xt),At=t("rsRi"),Ft=t("pKmL"),Mt=t("lSLK"),Lt=((Et=function e(){_classCallCheck(this,e)}).\u0275mod=u.Mb({type:Et}),Et.\u0275inj=u.Lb({factory:function(e){return new(e||Et)},imports:[[n.c,jt,Ft.a,Mt.a,At.a]]}),Et)},"90cg":function(e,i,t){"use strict";i.isPromise=function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}},IW2O:function(e,i,t){"use strict";var o,a=this&&this.__extends||(o=function(e,i){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}o(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),n=t("Y4kR"),s=t("cSoz");i.takeUntil=function(e){return function(i){return i.lift(new r(e))}};var r=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,i){var t=new c(e),o=s.subscribeToResult(t,this.notifier);return o&&!t.seenValue?(t.add(o),i.subscribe(t)):t},e}(),c=function(e){function i(i){var t=e.call(this,i)||this;return t.seenValue=!1,t}return a(i,e),i.prototype.notifyNext=function(e,i,t,o,a){this.seenValue=!0,this.complete()},i.prototype.notifyComplete=function(){},i}(n.OuterSubscriber)},OAkW:function(e,i,t){"use strict";i.subscribeToArray=function(e){return function(i){for(var t=0,o=e.length;t<o&&!i.closed;t++)i.next(e[t]);i.complete()}}},VKeD:function(e,i,t){"use strict";function o(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}i.getSymbolIterator=o,i.iterator=o(),i.$$iterator=i.iterator},Vi6O:function(e,i,t){"use strict";var o,a=this&&this.__extends||(o=function(e,i){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}o(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)});i.InnerSubscriber=function(e){function i(i,t,o){var a=e.call(this)||this;return a.parent=i,a.outerValue=t,a.outerIndex=o,a.index=0,a}return a(i,e),i.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},i.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},i}(t("FWf1").Subscriber)},Y4kR:function(e,i,t){"use strict";var o,a=this&&this.__extends||(o=function(e,i){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}o(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)});i.OuterSubscriber=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return a(i,e),i.prototype.notifyNext=function(e,i,t,o,a){this.destination.next(i)},i.prototype.notifyError=function(e,i){this.destination.error(e)},i.prototype.notifyComplete=function(e){this.destination.complete()},i}(t("FWf1").Subscriber)},Z5tI:function(e,i,t){"use strict";var o=t("MkmW");i.subscribeToPromise=function(e){return function(i){return e.then((function(e){i.closed||(i.next(e),i.complete())}),(function(e){return i.error(e)})).then(null,o.hostReportError),i}}},cSoz:function(e,i,t){"use strict";var o=t("Vi6O"),a=t("6qA3"),n=t("Q1FS");i.subscribeToResult=function(e,i,t,s,r){if(void 0===r&&(r=new o.InnerSubscriber(e,t,s)),!r.closed)return i instanceof n.Observable?i.subscribe(r):a.subscribeTo(i)(r)}},ozli:function(e,i,t){"use strict";var o=t("zfKp");i.subscribeToObservable=function(e){return function(i){var t=e[o.observable]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(i)}}},poJ0:function(e,i,t){"use strict";var o=t("VKeD");i.subscribeToIterable=function(e){return function(i){for(var t=e[o.iterator]();;){var a=t.next();if(a.done){i.complete();break}if(i.next(a.value),i.closed)break}return"function"==typeof t.return&&i.add((function(){t.return&&t.return()})),i}}},yRPT:function(e,i,t){"use strict";i.isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}}}]);