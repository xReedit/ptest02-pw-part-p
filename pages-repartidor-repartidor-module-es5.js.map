{"version":3,"sources":["webpack:///node_modules/rxjs/internal/operators/takeUntil.js","webpack:///src/app/pages/repartidor/indicaciones-grupo-mapa/indicaciones-grupo-mapa.component.ts","webpack:///src/app/pages/repartidor/indicaciones-grupo-mapa/indicaciones-grupo-mapa.component.html","webpack:///src/app/pages/repartidor/indicaciones-pedido/indicaciones-pedido.component.ts","webpack:///src/app/pages/repartidor/indicaciones-pedido/indicaciones-pedido.component.html","webpack:///src/app/pages/repartidor/list-grupo-pedidos/list-grupo-pedidos.component.ts","webpack:///src/app/pages/repartidor/list-grupo-pedidos/list-grupo-pedidos.component.html","webpack:///src/app/pages/repartidor/main/main.component.ts","webpack:///src/app/pages/repartidor/main/main.component.html","webpack:///src/app/pages/repartidor/mapa-pedidos/mapa-pedidos.component.ts","webpack:///src/app/pages/repartidor/mapa-pedidos/mapa-pedidos.component.html","webpack:///src/app/pages/repartidor/pedido-detalle/pedido-detalle.component.ts","webpack:///src/app/pages/repartidor/pedido-detalle/pedido-detalle.component.html","webpack:///src/app/pages/repartidor/pedidos-atendidos/pedidos-atendidos.component.ts","webpack:///src/app/pages/repartidor/pedidos-atendidos/pedidos-atendidos.component.html","webpack:///src/app/pages/repartidor/pedidos/pedidos.component.ts","webpack:///src/app/pages/repartidor/pedidos/pedidos.component.html","webpack:///src/app/pages/repartidor/repartidor.module.ts","webpack:///src/app/pages/repartidor/repartidor.rounting.ts","webpack:///src/app/shared/services/navigator-link.service.ts"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","OuterSubscriber_1","subscribeToResult_1","takeUntil","notifier","source","lift","TakeUntilOperator","call","subscriber","takeUntilSubscriber","TakeUntilSubscriber","notifierSubscription","subscribeToResult","seenValue","add","subscribe","_super","destination","_this","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","complete","notifyComplete","OuterSubscriber","IndicacionesGrupoMapaComponent","dialog","pedidoRepartidorService","orden","_dialogConfig","isRepartidorRed","disableClose","hasBackdrop","width","panelClass","data","laOrden","setPedidoSelect","dialogRef","open","openDialogOrden","selector","templateUrl","styleUrls","IndicacionesPedidoComponent","repartidorService","geoPositionService","calcDistanciaService","router","socketService","infoTokenService","timerService","listenService","coordenadasDestino","importeEfectivoPedido","btnTitlePasos","btnIsVisible","btnTerminarVisible","_desAccionComprar","radioUbicacionActiva","destroy$","dataPedido","pedidoRepartidor","verificarEstadoPedido","idpedido","res","estado","setLocal","loadInit","idClienteNotifyPos","datosCliente","idcliente","idSedeNotifiPos","datosComercio","idsede","datosDelivery","paga_con","replace","pwa_delivery_comision_fija_no_afiliado","next","unsubscribe","toString","paso_va","setPasoVa","metodoPago","idtipo_pago","descripcionPago","parseFloat","importePedido","toFixed","importePagaCliente","showPasos","setTimeout","listenGeoPosition","geoPositionActual","geoPosition","myPosition$","pipe","latitude","isLLego","calcDistancia","onDeliveryPedidoFin","openDialogCalificacion","dataCalificado","idrepartidor","infoUsToken","usuario","tipo","showNombre","nombre","titulo","showTitulo","showMsjTankyou","afterClosed","stopCountTimerLimit","finalizarPedido","longitude","linkGPS","window","socketEmitEstadoPedido","navigate","_link","telefono","_estado","_data","emit","showDetallePedido","btnEjecutar","ListGrupoPedidosComponent","utilService","repartidorServcice","sendMsjService","sumListPedidos","sumGananciaTotal","btnShow","displayedColumns","geoPositionComercio","isEntregadoAll","iniComponente","get","getGeoPosition","onGeoWatchPosition","onGeoWatchPositionCapacitor","onRepartidorGetPedidoPendienteAceptar","setPedidoPorAceptar","pedido_por_aceptar","darFormatoGrupoPedidosRecibidos","isSocketOpen$","init","getLocal","listPedidos","getLocalItems","map","time_line","sort","a","json_datos_delivery","p_header","arrDatosDelivery","establecimiento","distancia_km","checkIsEntregaALL","comercioPedido","importe_pagar_comercio","reduce","calcHora","clearInterval","timerRun","pedidos","sumAcumuladoPagar","importe_pagar","loadPedidosRecibidos","join","response","_listAsignar","JSON","parse","importeTotal","costoTotalDelivery","listPedidosGroup","stringify","setLocalIds","setLocalItems","calHoraList","setInterval","hora_show","xTiempoTranscurridos_en_minutos","hora","geoPositionNow$","checkLLegoComercio","pedido_paso_va","_addDir","direccionEnvioSelected","slice","listaPedidosEntregados","setPedidoPasoVa","guardarPasoVa","pedido","_res","filter","pwa_estado","length","_pedido","finalizarPedidoPropioRepartidor","item","_newTimeLinePedido","paso","llego_al_comercio","msjClienteTimeLine","en_camino_al_cliente","location","reload","recargarPedido","MainComponent","infoTokeService","navigatorService","storageService","isRepartidorPropio","showPanelLeft","isSocketOpenReconect","getInfoUs","idsede_suscrito","set","connect","disableGoBack","error","guardarEfectivo","closeConnection","clearLoginUser","val","openCambiarClave","cerrarSession","repartidorOnLine","openPanelLeft","MapaPedidosComponent","gpsPositionService","listeService","nomRepartidor","listRepartidoresInformativo","isShowResumen","scanCode","loadingScan","isResulScan","infoToken","console","log","apellido","loadPedidosPendiente","listenNewPedidos","$event","confirmarAsignacionReadBarCode","ordenAsingadaScan","elPedido","pedidos_repartidor","importeTotalPedido","p_subtotales","importe","propina","comsion_entrea_total","establecimientoIni","onPedidoAsignadoFromComercio","addPedidoInListPedidosPendientes","pedidoFin","getMisPedidosPropiosAsignados","x","resumenDelDia","PedidoDetalleComponent","repartidorPedidoService","infoPedido","indicacionesComprobante","comprobanteSolicitar","_dniRuc","_otro","_getPedidoSelectGroup","getPedidoSelect","_dni","tipoComprobante","dni","otro","descripcion","idorg","goBack","PedidosAtendidosComponent","crudService","importeNetoDebitar","importeNetoDepositar","xLoadResumenPedidos","getAll","listPedidosEntregados","listResumen","importeDepositar","importeDebitar","xLoadPedidosAtendidos","PedidosComponent","timerLimitService","efectivoMano","_tabIndex","isExpress","yaQuitoPedido","unsubscribeSocket","unsubscribeSocketClearPedido","setEfectivoMano","listenPedidos","efectivoManoMano$","dataPedidos","isexpress","isretiroatm","showPedidoExpress","solicita_liberar_pedido","cleanLocal","onRepartidorNuevoPedido","onRepartidorServerQuitaPedido","idpedido_res","_idSend","from","Set","pedido_express","_establecimiento","aceptado","positionNow","position_now","index","pedidoFinalizado","quitar","quitarPedidoExpress","idpedido_mandado","finalizarPedidoExpress","_idpedido_mandado","clickTab","RepartidorModule","declarations","imports","routes","path","component","children","RepartidorRoutingModule","forChild","NavigatorLinkService","disabledBack","resNavigatorSource","resNavigatorSourceObserve$","asObservable","pageActive","resNavigator","historyNavigator","lastUrlHistory","listenEventNavigator","events","e","undefined","navigationTrigger","elUrl","_url","indexOf","substr","split","_pageActive","itemHistory","findPageActiveInHistory","addLink","url","key","_key","values","params","state","saveHistoryPageActive","isDelivery","then","previusUrl","nexturl","listoParaSalir","setPageActive","link","history","pushState","href","onpopstate","go","setIsOutEstablecimientoDelivery","providedIn"],"mappings":"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","file":"pages-repartidor-repartidor-module-es5.js","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar OuterSubscriber_1 = require(\"../OuterSubscriber\");\nvar subscribeToResult_1 = require(\"../util/subscribeToResult\");\nfunction takeUntil(notifier) {\n    return function (source) { return source.lift(new TakeUntilOperator(notifier)); };\n}\nexports.takeUntil = takeUntil;\nvar TakeUntilOperator = (function () {\n    function TakeUntilOperator(notifier) {\n        this.notifier = notifier;\n    }\n    TakeUntilOperator.prototype.call = function (subscriber, source) {\n        var takeUntilSubscriber = new TakeUntilSubscriber(subscriber);\n        var notifierSubscription = subscribeToResult_1.subscribeToResult(takeUntilSubscriber, this.notifier);\n        if (notifierSubscription && !takeUntilSubscriber.seenValue) {\n            takeUntilSubscriber.add(notifierSubscription);\n            return source.subscribe(takeUntilSubscriber);\n        }\n        return takeUntilSubscriber;\n    };\n    return TakeUntilOperator;\n}());\nvar TakeUntilSubscriber = (function (_super) {\n    __extends(TakeUntilSubscriber, _super);\n    function TakeUntilSubscriber(destination) {\n        var _this = _super.call(this, destination) || this;\n        _this.seenValue = false;\n        return _this;\n    }\n    TakeUntilSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.seenValue = true;\n        this.complete();\n    };\n    TakeUntilSubscriber.prototype.notifyComplete = function () {\n    };\n    return TakeUntilSubscriber;\n}(OuterSubscriber_1.OuterSubscriber));\n//# sourceMappingURL=takeUntil.js.map","import { Component, OnInit } from '@angular/core';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { MatDialogConfig, MatDialog } from '@angular/material/dialog';\nimport { DialogOrdenDetalleComponent } from 'src/app/componentes/dialog-orden-detalle/dialog-orden-detalle.component';\n\n@Component({\n  selector: 'app-indicaciones-grupo-mapa',\n  templateUrl: './indicaciones-grupo-mapa.component.html',\n  styleUrls: ['./indicaciones-grupo-mapa.component.css']\n})\nexport class IndicacionesGrupoMapaComponent implements OnInit {\n  // _listPedidos: any;\n\n\n  constructor(\n    private dialog: MatDialog,\n    private pedidoRepartidorService: PedidoRepartidorService,\n  ) { }\n\n  ngOnInit(): void {\n\n    // this._listPedidos = JSON.parse(JSON.stringify(this.pedidoRepartidorService.getLocalItems()));\n  }\n\n\n  openDialogOrden(orden: any): void {\n    const _dialogConfig = new MatDialogConfig();\n\n    // marcador para que no cierrre como repartidor propio en orden detalle.\n    orden.isRepartidorRed = true;\n\n    _dialogConfig.disableClose = true;\n    _dialogConfig.hasBackdrop = true;\n    _dialogConfig.width = '700px';\n    _dialogConfig.panelClass = ['my-dialog-orden-detalle', 'my-dialog-scrool'];\n    _dialogConfig.data = {\n      laOrden: orden\n    };\n\n    // console.log('orden openDialogOrden', orden);\n    this.pedidoRepartidorService.setPedidoSelect(orden);\n    const dialogRef = this.dialog.open(DialogOrdenDetalleComponent, _dialogConfig);\n  }\n\n}\n","<div class=\"animated fadeInDown container-body\">\n    <div class=\"p-3 bg-dark text-white fs-13 d-flex justify-content-between\">\n        <div>\n            <span>Pedidos - Ruta mas corta</span>\n        </div>        \n    </div>\n\n    <!-- mapa -->\n\n    <div class=\"content-body-mapa\">\n        <app-mapa-ordenes [trazarRuta]=\"true\" (pedidoOpen)=\"openDialogOrden($event)\"></app-mapa-ordenes>\n    </div>\n\n</div>","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { PedidoRepartidorModel } from 'src/app/modelos/pedido.repartidor.model';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { GpsUbicacionRepartidorService } from 'src/app/shared/services/gps-ubicacion-repartidor.service';\nimport { GeoPositionModel } from 'src/app/modelos/geoposition.model';\nimport { CalcDistanciaService } from 'src/app/shared/services/calc-distancia.service';\nimport { Router } from '@angular/router';\nimport { SocketService } from 'src/app/shared/services/socket.service';\nimport { takeUntil } from 'rxjs/internal/operators/takeUntil';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { DatosCalificadoModel } from 'src/app/modelos/datos.calificado.model';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\nimport { MatDialogConfig, MatDialog } from '@angular/material/dialog';\nimport { DialogCalificacionComponent } from 'src/app/componentes/dialog-calificacion/dialog-calificacion.component';\nimport { TimerLimitService } from 'src/app/shared/services/timer-limit.service';\nimport { RepartidorService } from 'src/app/shared/services/repartidor.service';\nimport { ListenStatusService } from 'src/app/shared/services/listen-status.service';\n\n@Component({\n  selector: 'app-indicaciones-pedido',\n  templateUrl: './indicaciones-pedido.component.html',\n  styleUrls: ['./indicaciones-pedido.component.css']\n})\nexport class IndicacionesPedidoComponent implements OnInit, OnDestroy {\n  coordenadasDestino: any = {};\n  descripcionPago: string;\n  dataPedido: PedidoRepartidorModel;\n  geoPositionActual: GeoPositionModel;\n  importeEfectivoPedido = 0;\n  btnTitlePasos = 'Empezar';\n  btnIsVisible = true;\n  btnTerminarVisible = false; // si el pedido ya fue cerrado pero no llego la notificacion socket\n  _desAccionComprar = 'RECOGER'; // cuando es comercio afiliado. si no dira comprar.\n\n\n  private radioUbicacionActiva = 60; // radio a la redonda // comercio 60 cliente 100\n  private idSedeNotifiPos: number;\n  private idClienteNotifyPos: number;\n\n  private destroy$: Subject<boolean> = new Subject<boolean>();\n\n  constructor(\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private repartidorService: RepartidorService,\n    private geoPositionService: GpsUbicacionRepartidorService,\n    private calcDistanciaService: CalcDistanciaService,\n    private router: Router,\n    private socketService: SocketService,\n    private infoTokenService: InfoTockenService,\n    private dialog: MatDialog,\n    private timerService: TimerLimitService,\n    private listenService: ListenStatusService\n  ) { }\n\n  ngOnInit() {\n\n    // verificar estado del pedido\n    this.dataPedido = this.pedidoRepartidorService.pedidoRepartidor;\n    this.pedidoRepartidorService.verificarEstadoPedido(this.pedidoRepartidorService.pedidoRepartidor.idpedido)\n      .subscribe((res: number) => {\n        this.dataPedido.estado = res;\n        this.pedidoRepartidorService.setLocal();\n        this.loadInit();\n    });\n\n    this.idClienteNotifyPos = this.dataPedido.datosCliente.idcliente;\n    this.idSedeNotifiPos = this.dataPedido.datosComercio.idsede;\n\n    this.dataPedido.datosDelivery.paga_con = this.dataPedido.datosDelivery.paga_con.replace('undefined', '');\n    this._desAccionComprar = this.dataPedido.datosComercio.pwa_delivery_comision_fija_no_afiliado === 0 ? 'RECOGER' : 'COMPRAR';\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next(true);\n    this.destroy$.unsubscribe();\n  }\n\n  private loadInit(): void {\n    this.dataPedido = this.pedidoRepartidorService.pedidoRepartidor;\n\n    if ( this.dataPedido.estado.toString() === '4' ) {\n      this.btnTerminarVisible = true;\n      this.dataPedido.paso_va = 4;\n      this.pedidoRepartidorService.setPasoVa(4);\n    }\n\n    // solo desarrollo\n    // this.dataPedido.paso_va = 2;\n\n    switch (this.dataPedido.datosDelivery.metodoPago.idtipo_pago) {\n      case 1:\n        this.descripcionPago = `Pagar S/. ${ parseFloat(this.dataPedido.importePedido).toFixed(2)}`;\n        this.importeEfectivoPedido = parseFloat(this.dataPedido.importePagaCliente);\n        break;\n      case 2:\n        this.descripcionPago = `El pedido ya esta pagado, solo entregar.`;\n        break;\n      case 3: // yape\n      this.descripcionPago = `Pagar S/. ${ parseFloat(this.dataPedido.importePedido).toFixed(2)}`;\n        this.importeEfectivoPedido = parseFloat(this.dataPedido.importePagaCliente);\n        break;\n    }\n\n    // if ( this.dataPedido.datosDelivery.metodoPago.idtipo_pago === 1 ) {\n    //   this.descripcionPago = `Pagar en efectivo S/. ${ parseFloat(this.dataPedido.importePedido).toFixed(2)}`;\n    //   // this.importeEfectivoPedido = parseFloat(this.dataPedido.importePedido) + parseFloat(this.dataPedido.c_servicio);\n    //   this.importeEfectivoPedido = parseFloat(this.dataPedido.importePagaCliente);\n    // } else {\n    //   this.descripcionPago = `El pedido ya esta pagado, solo recoger.`;\n    // }\n\n    this.showPasos();\n    setTimeout(() => {\n      this.listenGeoPosition();\n    }, 600);\n  }\n\n  private listenGeoPosition(): void {\n    // iniciamos el gps\n    // this.geoPositionService.onGeoWatchPosition();\n\n    this.geoPositionActual = this.geoPositionService.geoPosition;\n    // this.geoPositionService.geoPositionNow$.subscribe((res: GeoPositionModel) => {\n    this.listenService.myPosition$\n    .pipe(takeUntil(this.destroy$))\n    .subscribe((res: GeoPositionModel) => {\n      res = !res?.latitude ? this.geoPositionActual : res;\n      if ( !res.latitude ) { return; }\n      // verificar en que paso esta\n      // si paso 1 verificar si se acerca al coordenadas destino y activar boton accion\n      this.geoPositionActual = res;\n      const isLLego = this.coordenadasDestino.latitude ? this.calcDistanciaService.calcDistancia(this.geoPositionActual, this.coordenadasDestino, this.radioUbicacionActiva) : false;\n      // console.log('distancia listen llego ?', isLLego);\n      // console.log('distancia listen this.radioUbicacionActiva ?', this.radioUbicacionActiva);\n\n      // enviar posicion\n      // const _data = {\n      //   coordenadas : this.geoPositionActual,\n      //   idcliente: this.pedidoRepartidorService.pedidoRepartidor.datosCliente.idcliente\n      // };\n\n      // this.repartidorService.emitPositionNow(this.geoPositionActual, this.dataPedido, this.idSedeNotifiPos);\n\n      // this.socketService.emit('repartidor-notifica-ubicacion', _data);\n\n      if ( isLLego ) {\n        if ( this.dataPedido.paso_va === 1) {\n          this.dataPedido.paso_va = 2;\n          this.pedidoRepartidorService.setPasoVa(2);\n          this.showPasos();\n          // this.btnIsVisible = true;\n          // this.btnTitlePasos = 'Empezar';\n        }\n\n        // si ya llego al lugar de entrega\n        // if ( this.dataPedido.paso_va === 3) {\n        //   this.dataPedido.paso_va = 4;\n        //   this.pedidoRepartidorService.setPasoVa(4);\n        //   this.showPasos();\n        // }\n      }\n\n      if ( this.dataPedido.paso_va === 3) {\n        this.dataPedido.paso_va = 4;\n        this.pedidoRepartidorService.setPasoVa(4);\n        this.showPasos();\n      }\n\n\n    });\n\n    this.socketService.onDeliveryPedidoFin()\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(res => {\n        // lanzar calificacion al cliente\n        // console.log('fin del pedido idrepartidor', res);\n        this.openDialogCalificacion();\n      });\n  }\n\n\n  private openDialogCalificacion() {\n    if ( !this.dataPedido?.idpedido ) {return; } // cuando el cliente termina y ya el pedido ha sido terminiado por el repartidor\n\n    const dataCalificado: DatosCalificadoModel = new DatosCalificadoModel;\n    dataCalificado.idrepartidor = this.infoTokenService.infoUsToken.usuario.idrepartidor;\n    dataCalificado.idcliente = this.dataPedido.datosCliente.idcliente;\n    dataCalificado.idpedido = this.dataPedido.idpedido;\n    dataCalificado.tipo = 2;\n    dataCalificado.showNombre = true;\n    dataCalificado.nombre = this.dataPedido.datosDelivery.nombre;\n    dataCalificado.titulo = 'Como calificas al cliente?';\n    dataCalificado.showTitulo = true;\n    dataCalificado.showMsjTankyou = true;\n\n\n    const _dialogConfig = new MatDialogConfig();\n    _dialogConfig.disableClose = true;\n    _dialogConfig.hasBackdrop = true;\n\n    _dialogConfig.data = {\n      dataCalificado: dataCalificado\n    };\n\n    const dialogRef =  this.dialog.open(DialogCalificacionComponent, _dialogConfig);\n    dialogRef.afterClosed().subscribe(\n      data => {\n        // notificar al repartidor fin del pedido\n        this.timerService.stopCountTimerLimit();\n        this.pedidoRepartidorService.finalizarPedido();\n        // this.router.navigate(['./repartidor/pedidos']);\n      }\n    );\n  }\n\n  private showPasos(): void {\n    this.dataPedido.paso_va = this.dataPedido.paso_va ? this.dataPedido.paso_va : 1;\n\n    // console.log('this.dataPedido.paso_va', this.dataPedido.paso_va);\n\n    // console.log(this.dataPedido);\n    switch (this.dataPedido.paso_va) {\n      case 1 || null:\n        this.coordenadasDestino.latitude = this.dataPedido.datosComercio.latitude;\n        this.coordenadasDestino.longitude = this.dataPedido.datosComercio.longitude;\n        this.btnTitlePasos = 'Empezar';\n        this.radioUbicacionActiva = 350; // radio del cliente\n        break;\n      case 2: // apuntar a la direccion del cliente\n        this.btnIsVisible = true;\n        this.coordenadasDestino.latitude = this.dataPedido.datosCliente.latitude;\n        this.coordenadasDestino.longitude = this.dataPedido.datosCliente.longitude;\n        this.btnTitlePasos = 'Paso 3 Empezar';\n        this.radioUbicacionActiva = 350; // radio del cliente\n        break;\n      case 3: // ir a la direccion // si recarga ya no sale\n        this.btnIsVisible = true;\n        this.coordenadasDestino.latitude = this.dataPedido.datosCliente.latitude;\n        this.coordenadasDestino.longitude = this.dataPedido.datosCliente.longitude;\n        this.btnTitlePasos = 'Paso 3 Empezar';\n        this.radioUbicacionActiva = 350; // radio del cliente\n        break;\n      case 4: //\n        this.btnIsVisible = true;\n        this.coordenadasDestino.latitude = this.dataPedido.datosCliente.latitude;\n        this.coordenadasDestino.longitude = this.dataPedido.datosCliente.longitude;\n        this.radioUbicacionActiva = 350; // radio del cliente\n        this.btnTitlePasos = 'Entregado, terminar.';\n        break;\n      default:\n        this.coordenadasDestino.latitude = this.dataPedido.datosCliente.latitude;\n        this.coordenadasDestino.longitude = this.dataPedido.datosCliente.longitude;\n        break;\n    }\n  }\n\n  btnEjecutar() {\n    let linkGPS = '';\n    switch (this.dataPedido.paso_va) {\n      case 1:\n        linkGPS = `http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.coordenadasDestino.latitude},${this.coordenadasDestino.longitude}`;\n        window.open(linkGPS, '_blank');\n        this.btnIsVisible = false;\n        // this.btnTitlePasos = 'Llegue';\n        // this.pedidoRepartidorService.setPasoVa(2);\n        break;\n      case 2: // apuntar a la direccion del cliente\n        linkGPS = `http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.coordenadasDestino.latitude},${this.coordenadasDestino.longitude}`;\n        window.open(linkGPS, '_blank');\n        this.btnIsVisible = false;\n        // this.btnTitlePasos = 'Llegue';\n        this.dataPedido.paso_va = 3;\n        this.pedidoRepartidorService.setPasoVa(3);\n        break;\n      case 3: // apuntar a la direccion del cliente\n        linkGPS = `http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.coordenadasDestino.latitude},${this.coordenadasDestino.longitude}`;\n        window.open(linkGPS, '_blank');\n        this.btnIsVisible = false;\n        // this.btnTitlePasos = 'Llegue';\n        this.dataPedido.paso_va = 3;\n        this.pedidoRepartidorService.setPasoVa(3);\n        break;\n      case 4: // terminar pedido / solo si la notificacion socket no llego // o si el cliente no termino el pedido\n        this.openDialogCalificacion();\n        break;\n    }\n\n    this.socketEmitEstadoPedido(this.dataPedido.paso_va);\n  }\n\n  showDetallePedido() {\n    if ( this.dataPedido.paso_va >= 2 ) {\n      this.router.navigate(['./main/pedido-detalle']);\n    }\n  }\n\n  redirectWhatsApp() {\n    const _link = `https://api.whatsapp.com/send?phone=51${this.dataPedido.datosDelivery.telefono}`;\n    window.open(_link, '_blank');\n  }\n\n  callPhone() {\n    window.open(`tel:${this.dataPedido.datosDelivery.telefono}`);\n  }\n\n  private socketEmitEstadoPedido(_estado: number): void {\n    const _data = {\n      idcliente: this.dataPedido.datosCliente.idcliente,\n      idpedido: this.dataPedido.idpedido,\n      estado: _estado\n    };\n\n    this.socketService.emit('repartidor-notifica-estado-pedido', _data);\n  }\n\n}\n","<div class=\"animated fadeInDown container-body\">\n\n    <div class=\"p-3 bg-dark text-white fs-13 d-flex justify-content-between\">\n        <div>\n            <span>Pasos para entregar el pedido</span>\n        </div>\n        <div>\n            <span>#{{ dataPedido.idpedido }}</span>\n        </div>\n    </div>\n\n    <!-- mapa -->\n    <div class=\"border\">\n        <app-mapa-solo [coordenadas]=\"coordenadasDestino\"></app-mapa-solo>        \n    </div>    \n    <!-- pasos -->\n    <!-- por default solo 3 pasos -->\n    <div class=\"p-3\">\n        <div class=\"item-paso d-flex active\" [ngClass]=\"{'success': dataPedido.paso_va > 1}\">\n            <div class=\"num\">1</div>\n            <div class=\"instrunccion p-2 fs-13\">\n                <p class=\"text-secondary fw-600 fs-12\">Dirigirse al comercio:</p>\n                <p class=\"fw-100\">{{ dataPedido.datosComercio.nombre }}</p>\n                <p class=\"fw-100\">{{ dataPedido.datosComercio.direccion }}</p>\n            </div>\n        </div>\n\n        <div class=\"item-paso d-flex\" [ngClass]=\"{'active': dataPedido.paso_va === 2, 'success': dataPedido.paso_va > 2}\"\n            matRipple\n            (click)=\"showDetallePedido()\"\n            >\n            <div class=\"num\">2</div>\n            <div class=\"instrunccion p-2 fs-13\">\n                <p class= \"fw-600 fs-12\"><span class=\"fw-600 fs-15 text-dark\">{{ _desAccionComprar }}</span> <span class=\"text-secondary\"> el pedido #{{ dataPedido.idpedido }}: </span></p>                \n                <p class=\"fw-600\">{{ descripcionPago }}</p>\n                <p class=\"fw-100\">Pedir comprobante.</p>\n                <div *ngIf=\"dataPedido.paso_va >= 2\">\n                    <hr>\n                    <p class=\"text-info\">Ver detalle del pedido.</p>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"item-paso d-flex\" [ngClass]=\"{'active': dataPedido.paso_va === 3, 'success': dataPedido.paso_va > 3}\">\n            <div class=\"num\">3</div>\n            <div class=\"instrunccion p-2 fs-13\">\n                <p class=\"text-secondary fw-600 fs-12\">Entregar Pedido:</p>\n                <p class=\"fw-100\"> <span class=\"fw-600\">En: </span> {{ dataPedido.datosDelivery.direccion }}</p>\n                <p class=\"fw-100\" *ngIf=\"dataPedido.datosDelivery.referencia\"> <span class=\"fw-600\">Referencia: </span> {{ dataPedido.datosDelivery.referencia }}</p>\n                <p class=\"fw-100\"> <span class=\"fw-600\">A: </span> {{ dataPedido.datosDelivery.nombre | titlecase }}</p>                \n                <div *ngIf=\"this.dataPedido.datosDelivery.metodoPago.idtipo_pago\" class=\"fw-100\">\n                    <p><span class=\"fw-600\">Importe a cobrar: </span> S/. {{ importeEfectivoPedido | number: '.2' }}</p>\n                    <p><span class=\"fw-600\">Cliente paga con: </span> {{ dataPedido.datosDelivery.paga_con }}</p>\n                </div>\n                <div *ngIf=\"dataPedido.paso_va >= 3\">\n                    <hr>\n                    <div class=\"row text-center\">\n                        <div matRipple class=\"col-6 border-right text-info\" (click)=\"callPhone()\"><i class=\"fa fa-phone\" aria-hidden=\"true\"></i> LLamar</div>\n                        <div matRipple class=\"col-6 text-info\" (click)=\"redirectWhatsApp()\"><i class=\"fa fa-commenting-o\" aria-hidden=\"true\"></i> Enviar Mensaje</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- footer boton -->\n    <div [hidden]=\"!btnIsVisible\" matRipple class=\"xfooter bg-success w-100 fs-20 text-white animated fadeInUp delay-0-5s\" (click)=\"btnEjecutar()\">\n        <span>{{btnTitlePasos}}</span>\n    </div> \n</div>","import { Component, OnInit, OnDestroy, Input } from '@angular/core';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { UtilitariosService } from 'src/app/shared/services/utilitarios.service';\nimport { GeoPositionModel } from 'src/app/modelos/geoposition.model';\nimport { GpsUbicacionRepartidorService } from 'src/app/shared/services/gps-ubicacion-repartidor.service';\nimport { ListenStatusService } from 'src/app/shared/services/listen-status.service';\nimport { takeUntil } from 'rxjs/internal/operators/takeUntil';\nimport { CalcDistanciaService } from 'src/app/shared/services/calc-distancia.service';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { Router } from '@angular/router';\nimport { PedidoRepartidorModel } from 'src/app/modelos/pedido.repartidor.model';\nimport { MatDialogConfig, MatDialog } from '@angular/material/dialog';\nimport { DialogOrdenDetalleComponent } from 'src/app/componentes/dialog-orden-detalle/dialog-orden-detalle.component';\nimport { RepartidorService } from 'src/app/shared/services/repartidor.service';\nimport { SocketService } from 'src/app/shared/services/socket.service';\nimport { DatosCalificadoModel } from 'src/app/modelos/datos.calificado.model';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\nimport { DialogCalificacionComponent } from 'src/app/componentes/dialog-calificacion/dialog-calificacion.component';\nimport { TimeLinePedido } from 'src/app/modelos/time.line.pedido';\nimport { SendMsjService } from 'src/app/shared/services/send-msj.service';\n\n@Component({\n  selector: 'app-list-grupo-pedidos',\n  templateUrl: './list-grupo-pedidos.component.html',\n  styleUrls: ['./list-grupo-pedidos.component.css']\n})\nexport class ListGrupoPedidosComponent implements OnInit, OnDestroy {\n  timerRun: any;\n  listPedidos: any;\n  sumListPedidos = 0;\n  sumGananciaTotal = 0;\n  comercioPedido: any;\n  btnShow = true; // cuando llega al local ya no figura este - ya no envia al mapa mostrando la ruta mas corta\n\n  btnTitlePasos = 'Vamos, vamos!!';\n  dataPedido: PedidoRepartidorModel;\n  displayedColumns: string[] = ['Comercio', 'Cliente', 'Importe'];\n\n\n  geoPositionActual: GeoPositionModel = new GeoPositionModel();\n  geoPositionComercio: GeoPositionModel = new GeoPositionModel();\n  geoPositionComercioCapacitor: any;\n\n  private destroy$: Subject<boolean> = new Subject<boolean>();\n\n  isEntregadoAll = false;\n\n  constructor(\n    private infoTokenService: InfoTockenService,\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private utilService: UtilitariosService,\n    private geoPositionService: GpsUbicacionRepartidorService,\n    private listenService: ListenStatusService,\n    private calcDistanciaService: CalcDistanciaService,\n    private router: Router,\n    private dialog: MatDialog,\n    private repartidorServcice: RepartidorService,\n    private socketService: SocketService,\n    private sendMsjService: SendMsjService,\n  ) { }\n\n  ngOnInit(): void {\n\n    this.iniComponente();\n\n    this.geoPositionService.get();\n    this.geoPositionActual = this.geoPositionService.getGeoPosition();\n\n\n    setTimeout(() => {    \n      this.geoPositionService.onGeoWatchPosition();\n      this.geoPositionService.onGeoWatchPositionCapacitor();\n      this.listenGeoPosition();    \n    }, 1000);\n\n\n    // escuchar pedidos asignados\n    this.socketService.onRepartidorGetPedidoPendienteAceptar()\n    .subscribe((res: any) => {\n      // console.log('escuchar pedidos asignados', res);\n      this.pedidoRepartidorService.setPedidoPorAceptar(res[0].pedido_por_aceptar);\n      this.darFormatoGrupoPedidosRecibidos(res[0].pedido_por_aceptar);\n    });\n\n\n    // si se vuelve a conectar incia el geolocation\n    this.socketService.isSocketOpen$.subscribe(res => {\n      if (res) {\n        this.geoPositionService.onGeoWatchPosition();\n      }\n    })\n\n  }\n\n  private iniComponente() {\n\n    this.pedidoRepartidorService.init();\n    this.dataPedido = this.pedidoRepartidorService.getLocal();\n\n    // load dlista\n    this.listPedidos = this.pedidoRepartidorService.getLocalItems();\n    // console.log('this.listPedidos', this.listPedidos);\n    this.listPedidos = this.listPedidos.map(p => {\n      p.time_line = p.time_line || new TimeLinePedido()\n      return p;\n    })\n\n    // ordenar po distancia\n    this.listPedidos = this.listPedidos\n        .sort(( a, b ) => parseFloat(a.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km) - parseFloat(b.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km));\n\n    //\n\n    // console.log('this.listPedidos', this.listPedidos);\n\n    this.checkIsEntregaALL();\n\n    this.comercioPedido = this.listPedidos[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento;\n    this.dataPedido.idsede  = this.listPedidos[0].idsede; // idsede del grupo de pedidos\n\n    this.pedidoRepartidorService.setLocal();\n\n    // ubicacion comercio\n    this.geoPositionComercio.latitude = typeof this.comercioPedido.latitude === 'string'  ? parseFloat(this.comercioPedido.latitude) : this.comercioPedido.latitude;\n    this.geoPositionComercio.longitude = typeof this.comercioPedido.longitude === 'string'  ? parseFloat(this.comercioPedido.longitude) : this.comercioPedido.longitude;\n\n    // sumar total a pagar\n    this.sumListPedidos = this.listPedidos.map( p => p.importe_pagar_comercio).reduce((a, b) => a + b, 0);\n    this.sumGananciaTotal = this.dataPedido.sumGananciaTotal;\n\n    this.showPasos();\n    this.calcHora();\n  }\n\n  ngOnDestroy(): void {\n    clearInterval(this.timerRun);\n    this.destroy$.next(true);\n    this.destroy$.unsubscribe();\n  }\n\n\n\n  private darFormatoGrupoPedidosRecibidos(pedidos: any) {    \n    if ( !pedidos ) {return; }\n    const sumAcumuladoPagar = pedidos.importe_pagar;\n    this.pedidoRepartidorService.loadPedidosRecibidos(pedidos.pedidos.join(','))\n        .subscribe((response: any) => {\n          // console.log('res', response);\n\n          // formateamos el json_}¿datos\n          const _listAsignar = response.map(p => {\n            p.json_datos_delivery = JSON.parse(p.json_datos_delivery); \n            // console.log('p.json_datos_delivery', p.json_datos_delivery);           \n            p.importe_pagar_comercio =  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.importeTotal) -  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery);\n            p.importe_pagar_comercio = p.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2 ? 0 : p.importe_pagar_comercio;\n            return p;\n          });\n\n\n          const listPedidosGroup = JSON.parse(JSON.stringify(_listAsignar));\n\n          this.pedidoRepartidorService.setLocalIds(pedidos);\n          this.pedidoRepartidorService.setLocalItems( listPedidosGroup );\n\n          // this.pedidoRepartidorService.playAudioNewPedido();\n\n          this.iniComponente();\n\n        });\n  }\n\n  // private darFormatoGrupoPedidosRecibidos(pedidos: any) {\n  //   if ( !pedidos ) {return; }\n  //   this.sumAcumuladoPagar = pedidos.importe_pagar;\n  //   this.pedidoRepartidorService.loadPedidosRecibidos(pedidos.pedidos.join(','))\n  //       .subscribe((response: any) => {\n  //         // console.log('res', response);\n\n  //         // formateamos el json_}¿datos\n  //         const _listAsignar = response.map(p => {\n  //           p.json_datos_delivery = JSON.parse(p.json_datos_delivery);\n  //           p.importe_pagar_comercio =  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.importeTotal) -  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery);\n  //           p.importe_pagar_comercio = p.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2 ? 0 : p.importe_pagar_comercio;\n  //           return p;\n  //         });\n\n\n  //         this.listPedidosGroup = JSON.parse(JSON.stringify(_listAsignar));\n\n  //         this.pedidoRepartidorService.setLocalIds(pedidos);\n  //         this.pedidoRepartidorService.setLocalItems( this.listPedidosGroup );\n\n  //         this.pedidoRepartidorService.playAudioNewPedido();\n\n  //       });\n  // }\n\n  private calcHora() {\n    this.calHoraList();\n    this.timerRun = setInterval(() => {this.calHoraList(); }, 60000);\n  }\n\n  private calHoraList() {\n    this.listPedidos.map(p => {\n      p.hora_show = this.utilService.xTiempoTranscurridos_en_minutos(p.hora);\n    });\n  }\n\n\n  private listenGeoPosition(): void {\n\n    // capacitor\n    // this.geoPositionService.geoPositionCapacitorNow$      \n    // .pipe(takeUntil(this.destroy$))\n    // .subscribe((res: GeoPositionModel) => {\n    //   console.log('geoPositionCapacitorNow', res);\n    //   this.geoPositionComercioCapacitor = res;\n\n    //   res = !res?.latitude ? this.geoPositionActual : res;\n    //   if ( !res.latitude ) { return; }\n    //   this.geoPositionActual = res;\n\n    //   this.pedidoRepartidorService.checkLLegoComercio(this.listPedidos, this.geoPositionActual)\n    // })\n\n\n\n    this.geoPositionActual = this.geoPositionService.geoPosition;\n    this.geoPositionService.geoPositionNow$    \n    .pipe(takeUntil(this.destroy$))\n    .subscribe((res: GeoPositionModel) => {\n      // console.log('geoPositionActual', res);\n      res = !res?.latitude ? this.geoPositionActual : res;\n      if ( !res.latitude ) { return; }\n      // verificar en que paso esta\n      // si paso 1 verificar si se acerca al coordenadas destino y activar boton accion\n      this.geoPositionActual = res;\n      this.pedidoRepartidorService.checkLLegoComercio(this.listPedidos, this.geoPositionActual)\n      \n      // const isLLego = this.geoPositionComercio.latitude ? this.calcDistanciaService.calcDistancia(this.geoPositionActual, this.geoPositionComercio, 120) : false;\n\n      // if ( !isLLego ) {\n      //   if ( this.dataPedido.pedido_paso_va === 1) {\n      //     this.dataPedido.pedido_paso_va = 2; // en el local\n      //     this.pedidoRepartidorService.setPedidoPasoVa(2);\n      //     this.dataPedido.pedido_paso_va = 2;\n\n      //     console.log('guarda paso va 2');\n\n      //     this.repartidorServcice.guardarPasoVa(2);\n      //     // this.pedidoRepartidorService.setPasoVa(2);\n      //     // this.pedidoRepartidorService.setLocal();\n      //     this.showPasos();\n      //     // this.btnIsVisible = true;\n      //     // this.btnTitlePasos = 'Empezar';\n      //   }\n\n      // }\n\n    });\n  }\n\n  private showPasos(): void {\n    // this.dataPedido.paso_va = this.dataPedido.paso_va ? this.dataPedido.paso_va : 1;\n\n    // console.log('this.dataPedido.paso_va', this.dataPedido.paso_va);\n\n    // console.log(this.dataPedido);\n    switch (this.dataPedido.pedido_paso_va) {\n      case 0 || null:\n        this.btnTitlePasos = 'Empezar';\n        break;\n      case 1 || null:\n        this.btnTitlePasos = 'Empezar';\n        break;\n      default: // apuntar a la direccion del cliente\n        this.btnShow = false;\n        this.btnTitlePasos = 'Ir a Entregar';\n        break;\n    }\n  }\n\n  goRuta() {\n    let _addDir = '';\n    this.listPedidos.map(p => {\n      _addDir += `${p.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude},${p.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude}+to:`;\n    });\n\n    _addDir = _addDir.slice(0, -4);\n    // const linkGPS = `http://maps.google.com/maps/dir/?api=1&origin=-6.028458-76.971177&waypoints=${_addDir}`;\n    const linkGPS = `http://maps.google.com/maps?f=d&source=s_d&saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${_addDir}`;\n    window.open(linkGPS, '_blank');\n  }\n\n  entregaTodo() {\n    this.pedidoRepartidorService.listaPedidosEntregados();\n    this.listPedidos = null;\n    this.sumListPedidos = 0;\n    this.sumGananciaTotal = 0;\n    this.router.navigate(['./main/pedidos']);\n  }\n\n  btnEjecutar() {\n      // let linkGPS = '';\n      // this.dataPedido.paso_va = this.dataPedido.paso_va ? this.dataPedido.paso_va : 1;\n      // this.pedidoRepartidorService.setPasoVa(this.dataPedido.paso_va);\n      switch (this.dataPedido.pedido_paso_va) {\n        case 1:\n          let _addDir = '';\n          this.listPedidos.map(p => {\n            _addDir += `${p.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude},${p.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude}+to:`;\n          });\n\n          _addDir = _addDir.slice(0, -4);\n          // const linkGPS = `http://maps.google.com/maps/dir/?api=1&origin=-6.028458-76.971177&waypoints=${_addDir}`;\n          const linkGPS = `http://maps.google.com/maps?f=d&source=s_d&saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${_addDir}`;\n          window.open(linkGPS, '_blank');\n\n          // linkGPS = `http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.geoPositionComercio.latitude},${this.geoPositionComercio.longitude}`;\n          // window.open(linkGPS, '_blank');\n          // this.btnTitlePasos = 'Llegue';\n          // this.pedidoRepartidorService.setPasoVa(2);\n          break;\n        default: // enviamos al mapa trazamos la ruta mas corta\n          this.pedidoRepartidorService.setPedidoPasoVa(3);\n          this.dataPedido.pedido_paso_va = 3;\n          this.repartidorServcice.guardarPasoVa(3);\n          this.router.navigate(['/main/indicaciones-mapa-grupo']);\n          break;\n      }\n  }\n\n  irAlComercio() {\n    const linkGPS = `http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.geoPositionComercio.latitude},${this.geoPositionComercio.longitude}`;\n    window.open(linkGPS, '_blank');\n  }\n\n  // showDetallePedido(row: any) {\n  //   // console.log('show pedido', row);\n  //   this.pedidoRepartidorService.setPedidoSelect(row);\n  //   // if ( this.dataPedido.paso_va >= 2 ) {\n  //     this.router.navigate(['./main/pedido-detalle']);\n  //   // }\n  // }\n\n  showDetallePedido(orden: any): void {\n    const _dialogConfig = new MatDialogConfig();\n\n    // marcador para que no cierrre como repartidor propio en orden detalle.\n    orden.isRepartidorRed = true;\n\n    _dialogConfig.disableClose = true;\n    _dialogConfig.hasBackdrop = true;\n    _dialogConfig.width = '700px';\n    _dialogConfig.panelClass = ['my-dialog-orden-detalle', 'my-dialog-scrool'];\n    _dialogConfig.data = {\n      laOrden: orden\n    };\n\n    // console.log('orden openDialogOrden', orden);\n    this.pedidoRepartidorService.setPedidoSelect(orden);\n    const dialogRef = this.dialog.open(DialogOrdenDetalleComponent, _dialogConfig);\n    dialogRef.afterClosed().subscribe(\n      pedido => {\n        // console.log('el pedido', pedido);\n        this.checkIsEntregaALL();\n\n        // 211222 no califica\n        // if ( pedido.pwa_estado === 'E' ) {\n        //   this.openDialogCalificacion(pedido);\n        // }\n      }\n    );\n  }\n\n  private checkIsEntregaALL() {\n    const _res = this.listPedidos.filter(p => p.pwa_estado !== 'E');\n    this.isEntregadoAll = _res.length === 0;\n  }\n\n  private openDialogCalificacion(_pedido: PedidoRepartidorModel = null) {\n    this.dataPedido = this.pedidoRepartidorService.pedidoRepartidor;\n    const dataCalificado: DatosCalificadoModel = new DatosCalificadoModel;\n    dataCalificado.idrepartidor = this.infoTokenService.infoUsToken.usuario.idrepartidor;\n    dataCalificado.idcliente = this.dataPedido.datosCliente.idcliente;\n    dataCalificado.idpedido = this.dataPedido.idpedido;\n    dataCalificado.tipo = 2;\n    dataCalificado.showNombre = true;\n    dataCalificado.nombre = this.dataPedido.datosDelivery.nombre;\n    dataCalificado.titulo = 'Como calificas al cliente?';\n    dataCalificado.showTitulo = true;\n    dataCalificado.showMsjTankyou = true;\n\n\n    const _dialogConfig = new MatDialogConfig();\n    _dialogConfig.disableClose = true;\n    _dialogConfig.hasBackdrop = true;\n\n    _dialogConfig.data = {\n      dataCalificado: dataCalificado\n    };\n\n    const dialogRef =  this.dialog.open(DialogCalificacionComponent, _dialogConfig);\n    dialogRef.afterClosed().subscribe(\n      data => {\n        // notificar al repartidor fin del pedido\n        // this.timerService.stopCountTimerLimit();\n        this.pedidoRepartidorService.finalizarPedidoPropioRepartidor();\n        // this.router.navigate(['./repartidor/pedidos']);\n      }\n    );\n  }\n\n\n  testLlege(item) {\n    // console.log('item', item);\n    const _newTimeLinePedido = item.time_line\n    _newTimeLinePedido.paso = 1;    \n    _newTimeLinePedido.llego_al_comercio = true;\n    this.sendMsjService.msjClienteTimeLine(item, _newTimeLinePedido);\n  }\n\n  testEnCamino(item) {\n    // console.log('item', item);\n    const _newTimeLinePedido = item.time_line\n    if ( _newTimeLinePedido.paso === 1 ) {\n      _newTimeLinePedido.paso = 2;      \n      _newTimeLinePedido.en_camino_al_cliente = true;\n      this.sendMsjService.msjClienteTimeLine(item, _newTimeLinePedido);\n    }\n  }\n\n  recargarPedido() {\n    location.reload();\n  }\n\n}\n","<div class=\"animated fadeInDown container-body\">\n\n    <div class=\"p-3 bg-dark text-white fs-13 d-flex justify-content-between align-items-center\">\n        <div>\n            <span>Lista de pedidos</span>\n        </div>      \n        <div>\n            <button class=\"btn btn-sm btn-secondary\" (click)=\"recargarPedido()\">Recargar <i class=\"fa fa-refresh ml-1\"></i></button>\n        </div>  \n    </div>\n\n    <!-- lista -->\n    <div>\n        <!-- test -->\n        <!-- <div>\n            position navigator\n            <p>{{geoPositionActual | json}}</p>\n            <br>\n            <hr>\n            position capacitor \n            <p>{{ geoPositionComercioCapacitor | json}}</p>\n            <hr>\n        </div> -->\n\n        <!-- paso uno -->\n        <!-- <div class=\"p-4\">\n            <p class=\"fw-600 text-secondary\">Diríjase hacia el comercio:</p>\n            <div class=\"row\">\n                <div class=\"col-6\">\n                    <p class=\"fw-100 fs-13\">  {{ comercioPedido.nombre }} </p>\n                    <p class=\"fw-100 fs-12 text-secondary\">  {{ comercioPedido.direccion }} </p>\n                    <p class=\"fw-100 fs-13 text-secondary\">  Pedidos Asignados: </p>\n                </div>\n                <div class=\"col-6\">\n                    <div class=\"w-100 d-flex justify-content-end\">\n                        <button class=\"btn btn-sm btn-secondary\" (click)=\"irAlComercio()\">Ir al comercio</button>\n                    </div>\n                </div>                \n            </div>\n        </div> -->\n\n        <!-- <div class=\"p-4\">\n            <p class=\"fw-600 text-secondary\">Lista de pedidos Asignados</p>\n        </div> -->\n\n        <hr class=\"m-0\">\n\n        <table mat-table class=\"w-100\" [dataSource]=\"listPedidos\">\n            <!-- Item Column -->\n            <ng-container matColumnDef=\"Comercio\">\n              <th mat-header-cell *matHeaderCellDef> Comercio </th>\n              <td mat-cell *matCellDef=\"let element\">\n                    <p class=\"fw-600 fs-11\" style=\"max-width: 80px;\">{{ element.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.nombre | titlecase }}</p>\n                    <p class=\"fw-100 fs-10\" style=\"max-width: 80px;\">{{ element.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.direccion | lowercase }}</p>\n                                        \n                    \n                    <ng-container *ngIf=\"element.time_line.llego_al_comercio; else elseTemplateNollega\">\n                        <p class=\"text-success fs-10\"><i class=\"fa fa-check\"></i> Llegaste</p>\n                    </ng-container>\n                    <ng-template #elseTemplateNollega>\n                        <p class=\"text-danger fs-10\"> Aún no llegas</p>\n                    </ng-template>\n                    \n\n                    <!-- test -->\n                    <!-- <button (click)=\"testLlege(element)\">llegue</button> -->\n                    <!-- <p>llego: {{ element.time_line | json }}</p>\n                    <p>msj: {{ element.msj_log }}</p>\n                    <p>d1: {{ element.distanciaMtr }}</p>                                -->\n              </td>              \n            </ng-container>\n          \n            <!-- Cost Column -->\n            <ng-container matColumnDef=\"Cliente\">\n              <th mat-header-cell *matHeaderCellDef class=\"text-left\"> Cliente </th>\n              <td mat-cell *matCellDef=\"let element\" class=\"text-left\"> \n                    <p class=\"fw-600 fs-12\"> {{ element.json_datos_delivery.p_header.arrDatosDelivery.nombre | titlecase }}  </p>\n                    <p class=\"fw-100 fs-12\">\n                        <span class=\"fw-600 badge badge-success mr-1\" *ngIf=\"element.json_datos_delivery.p_header.isCliente === 1\">\n                            APP\n                        </span> \n                        <span class=\"fw-600 badge\" [ngClass]=\"{'badge-primary': element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 3, 'badge-info': element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2, 'badge-secondary': element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 1}\">\n                            {{element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion | titlecase }} \n                        </span>\n                        <span class=\"text-secondary fs-10 ml-1\">\n                            {{ element.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km }} Km\n                        </span>\n                    </p>\n                    <div class=\"d-flex\">                        \n                        <p class=\"fw-600 text-success fs-10\" [ngClass]=\"{'text-danger': element.hora_show > 25}\">\n                            {{ element.hora_show }} min                            \n                        </p>\n                        <p *ngIf=\"element.time_line.en_camino_al_cliente\" class=\"text-success fs-10 ml-2\"><i class=\"fa fa-check\"></i> En Camino</p>\n                    </div>\n\n                    <!-- test -->\n                    <!-- <button (click)=\"testEnCamino(element)\">en camino</button> -->\n              </td>              \n            </ng-container>\n\n            <ng-container matColumnDef=\"Importe\">\n                <th mat-header-cell *matHeaderCellDef class=\"text-right\"> Importe </th>\n                <td mat-cell *matCellDef=\"let element\" class=\"text-right\"> \n                    <p class=\"fw-600 fs-12\"> {{ element.importe_pagar_comercio | number : '.2' }}  </p>\n                    <p *ngIf=\"element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2\" class=\"badge badge-info\">\n                        pagado con tarjeta\n\n                    </p>\n                </td>              \n              </ng-container>\n          \n            <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n            <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\" (click)=\"showDetallePedido(row)\" [ngClass]=\"{'color-checked': row.pwa_estado === 'E'}\"></tr>            \n        </table>\n\n          <div class=\"w-100 pt-3\">\n              <div class=\"text-right pr-4\">\n                  <div>\n                      <span class=\"text-secondary pr-2\">Total a pagar: </span>\n                      <span class=\"fw-600 fs-18\"> {{ sumListPedidos | number : '.2' }} </span>\n                  </div>\n\n                  <div>\n                      <span class=\"text-secondary fs-13 pr-2\">Ganancia: </span>\n                      <span class=\"fw-600 fs-13 badge badge-info\"> {{ sumGananciaTotal | number : '.2' }} </span>\n                  </div>\n                  \n                  <div class=\"p-2\">\n                      <span class=\"fw-100 fs-12 text-info\">Cuando sea posible elige pagar cero contacto: Yape ó Tarjeta</span>\n                  </div>\n              </div>              \n          </div>\n          <br><br>\n    </div>\n\n\n    <!-- footer boton -->\n    <div *ngIf=\"listPedidos\" class=\"xfooterx p-2\">\n        <ng-container *ngIf=\"isEntregadoAll; else elseTemplate\">\n            <div  matRipple class=\"btn btn-secondary w-75 p-2 fs-20 text-white animated fadeInUp delay-0-5s\" (click)=\"entregaTodo()\">\n                <span>Listo, pedidos entregados.</span>                \n            </div> \n        </ng-container>\n        <ng-template #elseTemplate>    \n            <div  matRipple class=\"btn btn-success w-75 p-2 fs-20 text-white animated fadeInUp delay-0-5s\" (click)=\"goRuta()\">\n                <span>Ver Ruta</span>\n                <p class=\"fs-11 fw-100\">Ruta mas corta.</p>\n            </div> \n        </ng-template>     \n        \n    </div>\n    \n    <!-- <div *ngIf=\"btnShow\" matRipple class=\"xfooter bg-success w-100 fs-20 text-white animated fadeInUp delay-0-5s\" (click)=\"btnEjecutar()\">\n        <span>{{btnTitlePasos}}</span>\n        <p class=\"fs-11 fw-100\" *ngIf=\"btnTitlePasos === 'Ir a Entregar'\">Muestrame la ruta mas corta.</p>\n    </div>  -->\n</div>","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { MatDialogConfig, MatDialog } from '@angular/material/dialog';\nimport { DialogEfectivoRepartidorComponent } from 'src/app/componentes/dialog-efectivo-repartidor/dialog-efectivo-repartidor.component';\nimport { SocketService } from 'src/app/shared/services/socket.service';\nimport { RepartidorService } from 'src/app/shared/services/repartidor.service';\nimport { takeUntil } from 'rxjs/internal/operators/takeUntil';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\nimport { Router } from '@angular/router';\nimport { NavigatorLinkService } from 'src/app/shared/services/navigator-link.service';\nimport { DialogChangePassComponent } from 'src/app/componentes/dialog-change-pass/dialog-change-pass.component';\nimport { StorageService } from 'src/app/shared/services/storage.service';\n\n@Component({\n  selector: 'app-main',\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.css']\n})\nexport class MainComponent implements OnInit, OnDestroy {\n  private destroy$: Subject<boolean> = new Subject<boolean>();\n\n\n  isRepartidorPropio = false;\n  showPanelLeft = false;\n\n  constructor(\n    private dialog: MatDialog,\n    public socketService: SocketService,\n    private repartidorService: RepartidorService,\n    private infoTokeService: InfoTockenService,\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private router: Router,\n    private navigatorService: NavigatorLinkService,\n    private storageService: StorageService\n  ) { }\n\n  ngOnInit() {\n    // conecta a notificaciones\n    try {\n      this.pedidoRepartidorService.init();\n      this.socketService.isSocketOpenReconect = false;\n      this.infoTokeService.getInfoUs();\n\n      this.isRepartidorPropio = this.infoTokeService.infoUsToken.usuario.idsede_suscrito;\n      this.infoTokeService.infoUsToken.usuario.isRepartidorPropio = this.isRepartidorPropio;\n      this.infoTokeService.set();\n\n      this.socketService.connect();\n\n      this.navigatorService.disableGoBack();\n    } catch (error) {\n      this.router.navigate(['../']);\n    }\n\n\n\n    if ( this.isRepartidorPropio ) {\n      this.repartidorService.guardarEfectivo(100);\n      this.router.navigate(['/main/mapa-de-pedidos']);\n    } else {\n      this.router.navigate(['/main/pedidos']);\n    }\n  }\n\n\n  ngOnDestroy(): void {\n    this.destroy$.next(true);\n    this.destroy$.unsubscribe();\n  }\n\n\n  repartidorOnLine(value: boolean) {\n    if ( value ) {\n      const _dialogConfig = new MatDialogConfig();\n      _dialogConfig.disableClose = true;\n      _dialogConfig.hasBackdrop = true;\n\n      this.dialog.open(DialogEfectivoRepartidorComponent, _dialogConfig);\n      this.socketService.connect();\n    }\n    // else {\n    //   // this.repartidorService.guardarEfectivo(0, 0);\n    // }\n\n\n  }\n\n\n  cerrarSession() {\n    this.repartidorService.guardarEfectivo(0, 0);\n    this.socketService.closeConnection();\n    this.storageService.clearLoginUser();\n    this.router.navigate(['../']);\n  }\n\n  openPanelLeft(val: any) {\n    this.showPanelLeft = true;\n  }\n\n  openCambiarClave() {\n    const _dialogConfig = new MatDialogConfig();\n      _dialogConfig.disableClose = true;\n      _dialogConfig.hasBackdrop = true;\n\n      this.dialog.open(DialogChangePassComponent, _dialogConfig);\n  }\n\n\n}\n","<!-- loader -->\n<div [ngClass]=\"{'loaded': socketService.isSocketOpen$ | async}\">\n    <div class=\"wrapper\">\n        <div id=\"loader-wrapper\">\n        <div id=\"loader\"></div>                \n        <div class=\"loader-msj\">{{socketService.msjConex$ | async}}</div>\n        <div class=\"loader-section section-left\"></div>\n        <div class=\"loader-section section-right\"></div>\n        </div>\n    </div>\n  </div>     \n<!-- loader -->\n\n<mat-drawer-container class=\"xh-100\">\n    <mat-drawer #drawerIzq class=\"example-sidenav\" mode=\"over\" [opened]=\"showPanelLeft\" (closedStart)=\"showPanelLeft=false\">\n        <div style=\"min-width: 250px;\">\n            <div class=\"p-3 border-bottom\">\n              <div class=\"w-100 text-center\">\n                <img src=\"assets/icons/icon-72x72.png\">\n                <p class=\"pt-1 fw-600 fs-12 text-secondary m-0\">Papaya Repartidor</p>\n                <p class=\"pt-1 fw-100 fs-11 text-secondary m-0\">papaya.com.pe</p>\n              </div>            \n            </div>                \n            <div class=\"p-3 border-bottom w-100\" (click)=\"drawerIzq.toggle()\">\n              <span class=\"fw-600 fs-13\"><i class=\"fa fa-arrow-left pr-2\"></i>Opciones</span>\n            </div>\n            <div class=\"fs-13\">\n                <!-- <div matRipple class=\"border-bottom p-3 xCursor\" [routerLink]=\"['ordenes']\" (click)=\"drawerIzq.toggle();\">\n                    <i class=\"fa fa-book pr-2\"></i>\n                    Resumen del dia\n                </div>\n                <div matRipple class=\"border-bottom p-3 xCursor\" [routerLink]=\"['ordenes', 'maps']\" (click)=\"drawerIzq.toggle();\">\n                    <i class=\"fa fa-map pr-2\"></i>\n                    Pedidos en el mapa\n                </div> -->\n\n                <div matRipple class=\"border-bottom p-3 xCursor\" (click)=\"openCambiarClave(); drawerIzq.toggle();\">\n                    <i class=\"fa fa-key\" aria-hidden=\"true\"></i>\n                    Cambiar clave\n                </div> \n\n                <div matRipple class=\"border-bottom p-3 xCursor\" (click)=\"cerrarSession();\">\n                    <i class=\"fa fa-close pr-2\"></i>\n                    <span> Cerrar Sesion</span><br>\n                    <span class=\"text-info fs-11\">Al cerrar dejara de recibir pedidos.</span> \n                </div>\n            </div>\n        </div>\n\n      \n\n    </mat-drawer>\n\n        <div class=\"animated fadeInDown w-100 top-0\">\n            <app-tool-bar-repartidor (changeTogle)=\"repartidorOnLine($event)\" (openMenuLateral)=\"openPanelLeft($event)\"></app-tool-bar-repartidor>\n            <div class=\"content-body\">\n                <router-outlet></router-outlet>\n            </div>\n        </div>\n\n</mat-drawer-container>","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\nimport { UsuarioTokenModel } from 'src/app/modelos/usuario.token.model';\nimport { SocketService } from 'src/app/shared/services/socket.service';\nimport { RepartidorService } from 'src/app/shared/services/repartidor.service';\nimport { MatDialogConfig, MatDialog } from '@angular/material/dialog';\nimport { DialogOrdenDetalleComponent } from 'src/app/componentes/dialog-orden-detalle/dialog-orden-detalle.component';\nimport { takeUntil } from 'rxjs/internal/operators/takeUntil';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { DatosCalificadoModel } from 'src/app/modelos/datos.calificado.model';\nimport { PedidoRepartidorModel } from 'src/app/modelos/pedido.repartidor.model';\nimport { DialogCalificacionComponent } from 'src/app/componentes/dialog-calificacion/dialog-calificacion.component';\nimport { GpsUbicacionRepartidorService } from 'src/app/shared/services/gps-ubicacion-repartidor.service';\nimport { ListenStatusService } from 'src/app/shared/services/listen-status.service';\nimport { UtilitariosService } from 'src/app/shared/services/utilitarios.service';\nimport { GeoPositionModel } from 'src/app/modelos/geoposition.model';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-mapa-pedidos',\n  templateUrl: './mapa-pedidos.component.html',\n  styleUrls: ['./mapa-pedidos.component.css']\n})\nexport class MapaPedidosComponent implements OnInit, OnDestroy {\n  infoToken: UsuarioTokenModel;\n  nomRepartidor = '';\n  listPedidos: any;\n  dataPedido: PedidoRepartidorModel;\n  sumListPedidos = 0;\n  sumGananciaTotal = 0;\n\n  listRepartidoresInformativo: any = [];\n  isShowResumen = false;\n\n  timerRun: any;\n  scanCode = false;\n  loadingScan = false;\n  isResulScan = false;\n  ordenAsingadaScan: any;\n  isEntregadoAll = false;\n  isRepartidorRed = false;\n\n  establecimientoIni: any;\n\n  private destroy$: Subject<boolean> = new Subject<boolean>();\n\n  geoPositionActual: GeoPositionModel = new GeoPositionModel();\n\n  displayedColumns: string[] = ['Pedido', 'Cliente', 'Importe'];\n\n  constructor(\n    private infoTokenService: InfoTockenService,\n    private utilService: UtilitariosService,\n    private socketService: SocketService,\n    private dialog: MatDialog,\n    private repartidorService: RepartidorService,\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private gpsPositionService: GpsUbicacionRepartidorService,\n    private listeService: ListenStatusService,\n    private geoPositionService: GpsUbicacionRepartidorService,\n    private router: Router\n  ) { }\n\n  ngOnInit(): void {\n    this.infoToken = this.infoTokenService.getInfoUs();\n    console.log('this.infoToken lista pedidos', this.infoToken);\n    this.isRepartidorRed = !this.infoToken.usuario.idsede_suscrito;\n    this.nomRepartidor = this.infoToken.usuario.nombre + ' ' + this.infoToken.usuario.apellido;\n\n    this.loadPedidosPendiente();\n    this.listenNewPedidos();\n\n    // si es repartidor de la red\n    // va de frente a escanear\n    console.log('this.isRepartidorRed', this.isRepartidorRed);\n    this.scanCode = this.isRepartidorRed;\n\n    // console.log('this.infoToken', this.infoToken);\n\n    // activar gps - obtener ubicacion actual y guardar\n    // this.positionInt();\n\n\n    // this.loadPedidosPropios();\n    // this.listenNewPedidos();\n\n    this.geoPositionService.onGeoWatchPosition();\n    this.geoPositionActual = this.geoPositionService.geoPosition;\n    this.geoPositionService.geoPositionNow$\n    .pipe(takeUntil(this.destroy$))\n    .subscribe((res: GeoPositionModel) => {\n      res = !res?.latitude ? this.geoPositionActual : res;\n      if ( !res.latitude ) { return; }\n      // verificar en que paso esta\n      // si paso 1 verificar si se acerca al coordenadas destino y activar boton accion\n      this.geoPositionActual = res;\n    });\n\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next(true);\n    this.destroy$.unsubscribe();\n  }\n\n  loadPedidosPendiente() {\n    // const pendientes = this.pedidoRepartidorService.getPedidoPorAceptar();\n    // this.darFormatoGrupoPedidosRecibidos(pendientes);\n\n    this.socketService.onRepartidorGetPedidoPendienteAceptar()\n    .subscribe((res: any) => {\n      console.log(res);\n      this.pedidoRepartidorService.setPedidoPorAceptar(res[0].pedido_por_aceptar);\n      this.darFormatoGrupoPedidosRecibidos(res[0].pedido_por_aceptar);\n      this.pedidoRepartidorService.setPedidoPorAceptar(res[0].pedido_por_aceptar);\n    });\n  }\n\n  succesScan($event: any) {\n    this.loadingScan = true;\n    this.pedidoRepartidorService.confirmarAsignacionReadBarCode($event)\n    .subscribe((res: any) => {\n      this.loadingScan = false;\n      this.isResulScan = true;\n      this.ordenAsingadaScan = res.elPedido;\n      console.log(res);\n      this.darFormatoGrupoPedidosRecibidos(res.pedidos_repartidor);\n      console.log(res);\n    });\n  }\n\n  private darFormatoGrupoPedidosRecibidos(pedidos: any) {    \n    if ( !pedidos ) {return; }\n    const sumAcumuladoPagar = pedidos.importe_pagar;\n    this.pedidoRepartidorService.loadPedidosRecibidos(pedidos.pedidos.join(','))\n        .subscribe((response: any) => {\n          console.log('res', response);\n\n          // formateamos el json_}¿datos\n          let importeTotalPedido;\n          const _listAsignar = response.map(p => {\n            p.json_datos_delivery = JSON.parse(p.json_datos_delivery);\n            // extraemos el importe total, sino de los subtotales -> venta rapida\n            importeTotalPedido  = parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.importeTotal);\n            importeTotalPedido = importeTotalPedido === 0 ? parseFloat(p.json_datos_delivery.p_subtotales[p.json_datos_delivery.p_subtotales.length - 1 ].importe ) : importeTotalPedido;\n\n            p.importe_pagar_comercio =  parseFloat(importeTotalPedido) -  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery);\n            p.importe_pagar_comercio = p.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2 ? 0 : p.importe_pagar_comercio;\n\n            const propina = p.json_datos_delivery.p_header.arrDatosDelivery.propina.value ? parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.propina.value) : 0;\n            p.comsion_entrea_total = parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery) + propina;\n            return p;\n          });\n\n          this.establecimientoIni = _listAsignar[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento;\n          this.establecimientoIni.longitude = parseFloat(this.establecimientoIni.longitude);\n          this.establecimientoIni.latitude = parseFloat(this.establecimientoIni.latitude);\n\n\n          const listPedidosGroup = JSON.parse(JSON.stringify(_listAsignar));\n\n          this.pedidoRepartidorService.setLocalIds(pedidos);\n          this.pedidoRepartidorService.setLocalItems( listPedidosGroup );\n\n          // this.pedidoRepartidorService.playAudioNewPedido();\n\n          this.iniComponente();\n\n        });\n  }\n\n  private iniComponente() {\n\n    this.pedidoRepartidorService.init();\n    this.dataPedido = this.pedidoRepartidorService.getLocal();\n\n    // load dlista\n    this.listPedidos = this.pedidoRepartidorService.getLocalItems();\n\n    // ordenar po distancia\n    this.listPedidos = this.listPedidos\n        .sort(( a, b ) => parseFloat(a.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km) - parseFloat(b.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km));\n\n    //\n    this.checkIsEntregaALL();\n\n    // this.comercioPedido = this.listPedidos[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento;\n    this.dataPedido.idsede  = this.listPedidos[0].idsede; // idsede del grupo de pedidos\n\n    this.pedidoRepartidorService.setLocal();\n\n    // ubicacion comercio\n    // this.geoPositionComercio.latitude = typeof this.comercioPedido.latitude === 'string'  ? parseFloat(this.comercioPedido.latitude) : this.comercioPedido.latitude;\n    // this.geoPositionComercio.longitude = typeof this.comercioPedido.longitude === 'string'  ? parseFloat(this.comercioPedido.longitude) : this.comercioPedido.longitude;\n\n    // sumar total a pagar\n    this.sumListPedidos = this.listPedidos.map( p => p.importe_pagar_comercio).reduce((a, b) => a + b, 0);\n    this.sumGananciaTotal = this.listPedidos.map( p => p.comsion_entrea_total).reduce((a, b) => a + b, 0);\n    // this.sumGananciaTotal = this.dataPedido.sumGananciaTotal;\n\n    // this.showPasos();\n    this.calcHora();\n  }\n\n  private calcHora() {\n    this.calHoraList();\n    this.timerRun = setInterval(() => {this.calHoraList(); }, 60000);\n  }\n\n  private calHoraList() {\n    this.listPedidos.map(p => {\n      p.hora_show = this.utilService.xTiempoTranscurridos_en_minutos(p.hora);\n    });\n  }\n\n  showDetallePedido(orden: any): void {\n    const _dialogConfig = new MatDialogConfig();\n\n    // marcador para que no cierrre como repartidor propio en orden detalle.\n    orden.isRepartidorRed = true;\n\n    _dialogConfig.disableClose = true;\n    _dialogConfig.hasBackdrop = true;\n    _dialogConfig.width = '700px';\n    _dialogConfig.panelClass = ['my-dialog-orden-detalle', 'my-dialog-scrool'];\n    _dialogConfig.data = {\n      laOrden: orden\n    };\n\n    // console.log('orden openDialogOrden', orden);\n    this.pedidoRepartidorService.setPedidoSelect(orden);\n    const dialogRef = this.dialog.open(DialogOrdenDetalleComponent, _dialogConfig);\n    dialogRef.afterClosed().subscribe(\n      pedido => {\n        console.log('el pedido', pedido);\n        this.checkIsEntregaALL();\n\n        if ( pedido.pwa_estado === 'E' ) {\n          this.openDialogCalificacion(pedido);\n        }\n      }\n    );\n  }\n\n  private checkIsEntregaALL() {\n    const _res = this.listPedidos.filter(p => p.pwa_estado !== 'E');\n    this.isEntregadoAll = _res.length === 0;\n  }\n\n\n  // private positionInt() {\n  //   this.gpsPositionService.onGeoPosition(true);\n  // }\n\n  private listenNewPedidos(): void {\n    // escuchar pedidos nuevos asignados por el comercio\n    this.socketService.onPedidoAsignadoFromComercio()\n    // .pipe(takeUntil(this.destroy$))\n      .subscribe(pedido => {\n        console.log('nuevo pedido asignado', pedido);\n        // this.loadPedidosPropios();\n        const res = this.pedidoRepartidorService.addPedidoInListPedidosPendientes(pedido);\n        console.log(res);\n        this.darFormatoGrupoPedidosRecibidos(res.pedidos_repartidor);\n        // this.listPedidos.push(pedido);\n        // this.listeService.setNewPedidoRepartoPropio(pedido);\n        // this.pedidoRepartidorService.playAudioNewPedido();\n      });\n\n    this.socketService.onDeliveryPedidoFin()\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((pedidoFin: PedidoRepartidorModel) => {\n        // lanzar calificacion al cliente\n        // console.log('fin del pedido', pedidoFin);\n        this.openDialogCalificacion(pedidoFin);\n      });\n  }\n\n  private loadPedidosPropios(): void {\n    this.repartidorService.getMisPedidosPropiosAsignados()\n      .subscribe((res: any) => {\n        // console.log('propios pedidos', res);\n        res.map(x => {\n          x.json_datos_delivery = JSON.parse(x.json_datos_delivery);\n        });\n\n        this.listPedidos = res;\n      });\n  }\n\n\n  // openDialogOrden(orden: any): void {\n  //   const _dialogConfig = new MatDialogConfig();\n  //   _dialogConfig.disableClose = true;\n  //   _dialogConfig.hasBackdrop = true;\n  //   _dialogConfig.width = '700px';\n  //   _dialogConfig.panelClass = ['my-dialog-orden-detalle', 'my-dialog-scrool'];\n  //   _dialogConfig.data = {\n  //     laOrden: orden\n  //   };\n\n  //   const dialogRef = this.dialog.open(DialogOrdenDetalleComponent, _dialogConfig);\n  // }\n\n\n  private openDialogCalificacion(_pedido: PedidoRepartidorModel = null) {\n    this.dataPedido = this.pedidoRepartidorService.pedidoRepartidor;\n    const dataCalificado: DatosCalificadoModel = new DatosCalificadoModel;\n    dataCalificado.idrepartidor = this.infoTokenService.infoUsToken.usuario.idrepartidor;\n    dataCalificado.idcliente = this.dataPedido.datosCliente.idcliente;\n    dataCalificado.idpedido = this.dataPedido.idpedido;\n    dataCalificado.tipo = 2;\n    dataCalificado.showNombre = true;\n    dataCalificado.nombre = this.dataPedido.datosDelivery.nombre;\n    dataCalificado.titulo = 'Como calificas al cliente?';\n    dataCalificado.showTitulo = true;\n    dataCalificado.showMsjTankyou = true;\n\n\n    const _dialogConfig = new MatDialogConfig();\n    _dialogConfig.disableClose = true;\n    _dialogConfig.hasBackdrop = true;\n\n    _dialogConfig.data = {\n      dataCalificado: dataCalificado\n    };\n\n    const dialogRef =  this.dialog.open(DialogCalificacionComponent, _dialogConfig);\n    dialogRef.afterClosed().subscribe(\n      data => {\n        // notificar al repartidor fin del pedido\n        // this.timerService.stopCountTimerLimit();\n        this.pedidoRepartidorService.finalizarPedidoPropioRepartidor();\n        // this.router.navigate(['./repartidor/pedidos']);\n      }\n    );\n  }\n\n  goRuta() {\n    let _addDir = '';\n    this.listPedidos.map(p => {\n      _addDir += `${p.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude},${p.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude}+to:`;\n    });\n\n    _addDir = _addDir.slice(0, -4);\n    // const linkGPS = `http://maps.google.com/maps/dir/?api=1&origin=-6.028458-76.971177&waypoints=${_addDir}`;\n    const linkGPS = `http://maps.google.com/maps?f=d&source=s_d&saddr=${this.establecimientoIni.latitude},${this.establecimientoIni.longitude}&daddr=${_addDir}`;\n    window.open(linkGPS, '_blank');\n  }\n\n  entregaTodo() {\n    this.pedidoRepartidorService.listaPedidosEntregados();\n    this.listPedidos = null;\n    this.sumListPedidos = 0;\n    this.sumGananciaTotal = 0;\n  }\n\n\n  resumenDelDia() {\n    this.isShowResumen = true;\n  }\n\n  goBackRepartidorRed() {\n    this.router.navigate(['./main/pedidos']);\n  }\n\n  // // resumen de los pedidos\n  // resumenInformativo() {\n  //   let rowAddRepartidor: any = {};\n\n  //   this.listRepartidoresInformativo = [];\n  //   this.listPedidos.map((o: any, i: number) => {\n\n\n  //     // if ( this.isComercioPropioRepartidor ) {\n  //     // esta lista se usa tambien para mostrar repartidores y su ubicacion que no son propios\n  //     // se muestra la ubicacion toda vez que el pedido no este cerrado (entregado al cliente)\n  //       rowAddRepartidor = {\n  //         idrepartidor: o.idrepartidor,\n  //         num_pedidos: 1,\n  //         // nom_repartidor: o.nom_repartidor,\n  //         // ap_repartidor: o.ap_repartidor,\n  //         metodoPago: [{\n  //           num_pedidos: 1,\n  //           idtipo_pago: o.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,\n  //           descripcion: o.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion,\n  //           importe: o.total === '0' ? parseFloat(o.total_r) : parseFloat(o.total)\n  //         }],\n  //         importe: o.total === '0' ? parseFloat(o.total_r) : parseFloat(o.total)\n  //       };\n\n  //       this.resumenInformativoRepartidores(rowAddRepartidor);\n\n  //     // }\n  //   });\n\n  //   this.listRepartidoresInformativo = this.listRepartidoresInformativo.length > 0 ? this.listRepartidoresInformativo[0] : this.listRepartidoresInformativo;\n  //   console.log('this.listResumenInformativo', this.listRepartidoresInformativo);\n  //   this.isShowResumen = true;\n  // }\n\n\n  // // // si y solo si el comercio tiene repartidores propios\n  // private resumenInformativoRepartidores(row: any) {\n  //   // buscamos repartidor en lista\n  //   const _elRepartidor = this.listRepartidoresInformativo.filter(r => r.idrepartidor === row.idrepartidor)[0];\n  //   if ( _elRepartidor ) {\n\n  //     _elRepartidor.num_pedidos += 1;\n  //     _elRepartidor.importe += row.importe;\n\n  //     // metodo de pago\n  //     const _metodo = _elRepartidor.metodoPago.filter(m => m.idtipo_pago === row.metodoPago[0].idtipo_pago)[0];\n  //     if ( _metodo ) {\n  //       _metodo.num_pedidos += 1;\n  //       _metodo.importe +=  row.metodoPago[0].importe;\n  //     } else {\n  //       _elRepartidor.metodoPago.push(row.metodoPago[0]);\n  //     }\n\n  //   } else {\n  //     this.listRepartidoresInformativo.push(row);\n  //   }\n\n  //   // console.log('this.listRepartidoresInformativo', this.listRepartidoresInformativo);\n  // }\n\n}\n","<div class=\"container-body animated fadeInDown\">\n    <div class=\"bg-dark text-white fs-13 d-flex justify-content-between align-items-center p-2\">\n        <div matRipple class=\"pl-2 btn-link-2 xCursor\" (click)=\"scanCode = true\">\n            <div class=\"d-flex align-items-center\">\n                <i class=\"fa fa-qrcode fa-2x\"></i>\n                <span class=\"fs-11 pl-2\">Escanear Codigo</span>\n            </div>\n        </div>\n        <div matRipple class=\"pr-2\" (click)=\"resumenDelDia()\">\n            <span class=\"btn-link-2 xCursor\">Resumen</span>\n        </div>\n    </div>\n\n    <div *ngIf=\"!isShowResumen\" >\n\n        <!-- ahora con lista 280720 -->\n        <div *ngIf=\"scanCode\" class=\"w-100 center-div-screen\">\n                \n            <div *ngIf=\"!isResulScan\" class=\"animated fadeIn text-center\">\n                <app-scan-code-pedido (codeScanSucces)=\"succesScan($event)\"></app-scan-code-pedido>\n                <button class=\"btn btn-sm btn-secondary\" (click)=\"scanCode=false\"><span class=\"fs-12\"> Cancelar</span></button>\n            </div>\n\n            <div *ngIf=\"isResulScan\" class=\"animated fadeIn\">\n                <ng-container *ngIf=\"loadingScan; else elseTemplate\">\n                    <div class=\"w-100 text-center\">\n                        <i class=\"fa fa-spinner fa-spin fa-2x fa-fw\"></i>\n                        <p>Obteniendo Datos ...</p>\n                    </div>\n                </ng-container>\n                <ng-template #elseTemplate>\n                    \n                    <div class=\"w-100 text-center\">\n                        <p>Pedido Asinado: {{ ordenAsingadaScan.idpedido }}</p>\n                        <p>{{ ordenAsingadaScan.json_datos_delivery.p_header.arrDatosDelivery.nombre }}</p>\n                        <hr>\n                        <div class=\"d-flex justify-content-center\">\n                            <button class=\"btn btn-sm btn-success mr-1\" (click)=\"isResulScan = false\"><span class=\"fs-12\">Escanear Otro</span></button>\n                            <button class=\"btn btn-sm btn-secondary\" (click)=\"scanCode=false; isResulScan = false\"><span class=\"fs-12\">Finalizar Escaneo</span></button>\n                        </div>\n                    </div>\n\n                </ng-template>\n                \n            </div>\n\n        </div>\n\n        <div *ngIf=\"!scanCode\">\n            <p class=\"p-3\">Lista de pedidos asignados:</p>\n\n            <!-- icon waiting -->\n            <div *ngIf=\"!scanCode && !listPedidos\" class=\"p-5 w-100 text-center\">\n                <img src=\"./assets/images/waiting.JPG\" width=\"250px\" alt=\"waiting\">\n                <br><br>\n                <div *ngIf=\"isRepartidorRed\">\n                    <button mat-stroked-button (click)=\"goBackRepartidorRed()\"><i class=\"fa fa-arrow-left pr-2\"></i>  Atas</button>\n                </div>\n            </div>\n\n            <table mat-table class=\"w-100\" *ngIf=\"listPedidos\" [dataSource]=\"listPedidos\">\n                <ng-container matColumnDef=\"Pedido\">\n                <th mat-header-cell *matHeaderCellDef> Pedido </th>\n                <td mat-cell *matCellDef=\"let element\">\n                    <p class=\"fw-600 fs-12\">{{ element.idpedido }}</p>\n                    <p class=\"fw-100 text-secondary fs-12\">\n                        <span class=\"text-success fs-10\" [ngClass]=\"{'text-danger': element.hora_show > 30}\">\n                            {{ element.hora_show }} min\n                        </span>\n                        </p>\n                </td>              \n                </ng-container>\n            \n                <ng-container matColumnDef=\"Cliente\">\n                <th mat-header-cell *matHeaderCellDef class=\"text-left\"> Cliente </th>\n                <td mat-cell *matCellDef=\"let element\" class=\"text-left\"> \n                    <p class=\"fw-600 fs-12\"> {{ element.json_datos_delivery.p_header.arrDatosDelivery.nombre | titlecase }}  </p>\n                    <p class=\"fw-100 fs-12\">\n                        <span class=\"fw-600 badge\" [ngClass]=\"{'badge-primary': element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 3, 'badge-info': element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2, 'badge-secondary': element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 1}\">\n                            {{element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion | titlecase }} \n                        </span> \n                        <span class=\"text-secondary fs-10 ml-1\">\n                            {{ element.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km }} Km\n                        </span>\n                        </p>\n                </td>              \n                </ng-container>\n\n                <ng-container matColumnDef=\"Importe\">\n                    <th mat-header-cell *matHeaderCellDef class=\"text-right\"> Importe </th>\n                    <td mat-cell *matCellDef=\"let element\" class=\"text-right\"> \n                        <p class=\"fw-600 fs-12\"> {{ element.importe_pagar_comercio | number : '.2' }}  </p>\n                        <p *ngIf=\"element.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2\" class=\"badge badge-info\">\n                            pagado con tarjeta\n                        </p>\n                    </td>              \n                </ng-container>\n            \n                <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n                <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\" (click)=\"showDetallePedido(row)\" [ngClass]=\"{'color-checked': row.pwa_estado === 'E'}\"></tr>            \n            </table>\n\n            <div class=\"w-100 pt-3\" *ngIf=\"listPedidos\">\n                <div class=\"text-right pr-4\">\n                    <div>\n                        <span class=\"text-secondary pr-2\">Total a pagar: </span>\n                        <span class=\"fw-600 fs-18\"> {{ sumListPedidos | number : '.2' }} </span>\n                    </div>\n\n                    <div>\n                        <span class=\"text-secondary fs-13 pr-2\">Comision Entrega: </span>\n                        <span class=\"fw-600 fs-13 badge badge-info\"> {{ sumGananciaTotal | number : '.2' }} </span>\n                    </div>\n                                    \n                </div>              \n            </div>\n            <br><br>\n\n            \n        </div>\n    </div>\n\n    <div *ngIf=\"isShowResumen\" class=\"animated fadeIn\">\n        <app-pedidos-atendidos></app-pedidos-atendidos>\n        <div class=\"text-center w-100\">                        \n            <button class=\"btn btn-sm btn-success\" (click)=\"isShowResumen = false\"><i class=\"fa fa-arrow-left\"></i> Atras </button>\n        </div>\n    </div>\n\n    <!-- antes con mapa -->\n    <!-- <div class=\"content-body-mapa\">\n        <ng-container *ngIf=\"isShowResumen; else elseTemplate\">            \n            <div class=\"p-3 animated fadeInRight\">\n                <p class=\"fw-600 fs-18\"><i class=\"fa fa-arrow-left pr-2 xCursor\" (click)=\"isShowResumen = !isShowResumen\"></i> Resumen del dia</p>\n                <table class=\"table w-100\">\n                    <thead>\n                        <th>Metodo</th>\n                        <th>Importe</th>\n                    </thead>\n                    <tbody>\n                        <tr *ngFor=\"let metodo of listRepartidoresInformativo.metodoPago\">\n                            <td>                            \n                                <span class=\"fw-600 badge\" style=\"font-size: 13px;\" [ngClass]=\"{'badge-primary': metodo.idtipo_pago === 3, 'badge-info': metodo.idtipo_pago === 2, 'badge-secondary': metodo.idtipo_pago === 1}\">\n                                    {{metodo.descripcion | titlecase }} : \n                                </span> \n                                <span class=\"text-secondary pl-1\">{{metodo.num_pedidos | number: '2.' }} </span>\n                            </td>\n                            <td>\n                                <span class=\"text-secondary\">{{metodo.importe | number: '.2' }}</span>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <span>Pedidos {{ listRepartidoresInformativo.num_pedidos | number: '2.' }}</span>\n                            </td>\n                            <td>\n                                <span class=\"fw-600 fs-14\">{{ listRepartidoresInformativo.importe | number: '.2' }}</span>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n\n        </ng-container>\n        <ng-template #elseTemplate> \n            <app-mapa-ordenes [listaPedidos]=\"listPedidos\" (pedidoOpen)=\"openDialogOrden($event)\"></app-mapa-ordenes>                    \n        </ng-template>\n        \n    </div> -->\n\n    <!-- <button (click)=\"goRuta()\">ir</button> -->\n\n    <div *ngIf=\"listPedidos\" class=\"xfooter p-2\">\n        <ng-container *ngIf=\"isEntregadoAll; else elseTemplate\">\n            <div  matRipple class=\"btn btn-secondary w-75 p-2 fs-20 text-white animated fadeInUp delay-0-5s\" (click)=\"entregaTodo()\">\n                <span>Listo, pedidos entregados.</span>                \n            </div> \n        </ng-container>\n        <ng-template #elseTemplate>    \n            <div  matRipple class=\"btn btn-success w-75 p-2 fs-20 text-white animated fadeInUp delay-0-5s\" (click)=\"goRuta()\">\n                <span>Ver Ruta</span>\n                <p class=\"fs-11 fw-100\">Ruta mas corta.</p>\n            </div> \n        </ng-template>        \n    </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { Router } from '@angular/router';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\n\n@Component({\n  selector: 'app-pedido-detalle',\n  templateUrl: './pedido-detalle.component.html',\n  styleUrls: ['./pedido-detalle.component.css']\n})\nexport class PedidoDetalleComponent implements OnInit {\n  infoPedido: any = {};\n  indicacionesComprobante = '';\n  comprobanteSolicitar = '';\n\n  constructor(\n    private repartidorPedidoService: PedidoRepartidorService,\n    private infoTokenService: InfoTockenService,\n    private router: Router\n  ) { }\n\n  ngOnInit() {\n\n    let _dniRuc = '';\n    let _otro = '';\n\n\n    const _getPedidoSelectGroup = this.repartidorPedidoService.getPedidoSelect();\n    if ( _getPedidoSelectGroup ) {\n    this.infoPedido = _getPedidoSelectGroup; // this.infoTokenService.infoUsToken.usuario.idrepartidor;\n    // this.infoPedido.idpedido = _getPedidoSelectGroup.idpedido;\n    // this.infoPedido.idsede = _getPedidoSelectGroup.idsede;\n    // this.infoPedido.idorg =  _getPedidoSelectGroup.idorg;\n    const _dni = _getPedidoSelectGroup.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni ? _getPedidoSelectGroup.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni : '';\n    _dniRuc = _dni === '' ? '' : _dni.length > 8 ? 'RUC ' : 'DNI ';\n    _otro = _getPedidoSelectGroup.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro ? _getPedidoSelectGroup.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro : '';\n    this.indicacionesComprobante = _dni === '' ? 'Publico en general.' :\n                                    _dniRuc + ' ' + _dni + ' - ' + _otro;\n\n\n    this.comprobanteSolicitar = _getPedidoSelectGroup.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.descripcion;\n    return;\n    }\n\n    this.infoPedido = this.repartidorPedidoService.pedidoRepartidor;\n    this.infoPedido.idpedido = this.repartidorPedidoService.pedidoRepartidor.idpedido;\n    this.infoPedido.idsede = this.repartidorPedidoService.pedidoRepartidor.datosComercio.idsede;\n    this.infoPedido.idorg = this.repartidorPedidoService.pedidoRepartidor.datosComercio.idorg;\n    this.infoPedido.datosDelivery.tipoComprobante.dni = this.infoPedido.datosDelivery.tipoComprobante.dni ? this.infoPedido.datosDelivery.tipoComprobante.dni : '';\n    _dniRuc = this.infoPedido.datosDelivery.tipoComprobante.dni === '' ? '' : this.infoPedido.datosDelivery.tipoComprobante.dni.length > 8 ? 'RUC ' : 'DNI ';\n    _otro = this.infoPedido.datosDelivery.tipoComprobante.otro ? this.infoPedido.datosDelivery.tipoComprobante.otro : '';\n    this.indicacionesComprobante = this.infoPedido.datosDelivery.tipoComprobante.dni === '' ? 'Publico en general.' :\n                                    _dniRuc + ' ' + this.infoPedido.datosDelivery.tipoComprobante.dni + ' - ' + _otro;\n\n  }\n\n  goBack() {\n    // window.history.back();\n    this.router.navigate(['/main/list-grupo-pedidos']);\n  }\n\n}\n","<div class=\"animated fadeInRight\">\n    <app-comp-pedido-detalle [infoPedido]=\"infoPedido\" [showAllSubtotal]=\"false\"></app-comp-pedido-detalle>\n    <hr>    \n    \n    <br><br><br><br>\n\n    <div class=\"xfooter animated fadeInUp delay-0-5s\">\n        <!-- datos de facturacion -->\n        <div class=\"p-2 div-comprobante\">\n            <p><span class=\"fw-600\">Solicitar {{comprobanteSolicitar}}: </span> <span class=\"fw-100\">{{ indicacionesComprobante }}</span></p>    \n        </div>\n        <div matRipple class=\"bg-success w-100 fs-20 text-white p-3\" (click)=\"goBack()\">\n            <span><i class=\"fa fa-arrow-left\"></i> Listo, regresar</span>\n        </div>\n    </div> \n</div>\n\n","import { Component, OnInit, Input } from '@angular/core';\nimport { CrudHttpService } from 'src/app/shared/services/crud-http.service';\n\n@Component({\n  selector: 'app-pedidos-atendidos',\n  templateUrl: './pedidos-atendidos.component.html',\n  styleUrls: ['./pedidos-atendidos.component.css']\n})\nexport class PedidosAtendidosComponent implements OnInit {\n  _tabIndex;\n\n  @Input()\n  public set tabIndex(val: number) {\n    if ( val === 1) { // tab activo para este componente\n      this.xLoadResumenPedidos();\n    }\n  }\n\n  listResumen: any;\n  listPedidosEntregados: any;\n\n  importeNetoDebitar = 0;\n  importeNetoDepositar = 0;\n\n\n  constructor(\n    private crudService: CrudHttpService\n  ) { }\n\n  ngOnInit() {\n    this.xLoadResumenPedidos();\n  }\n\n  private xLoadPedidosAtendidos() {\n    this.crudService.getAll('repartidor', 'get-pedidos-entregados-dia', false, false, true)\n      .subscribe((res: any) => {\n        this.listPedidosEntregados = res.data[0];\n        // console.log(res);\n      });\n  }\n\n  private xLoadResumenPedidos() {\n    this.crudService.getAll('repartidor', 'get-pedidos-resumen-entregados-dia', false, false, true)\n    .subscribe((res: any) => {\n      this.listResumen = res.data[0][0];\n      if ( !this.listResumen ) { return; }\n      this.importeNetoDebitar = parseFloat(this.listResumen.importeDepositar) - parseFloat(this.listResumen.importeDebitar);\n        this.importeNetoDepositar = this.importeNetoDebitar < 1 ? 0 : this.importeNetoDebitar;\n        this.importeNetoDebitar = this.importeNetoDebitar < 1 ? this.importeNetoDebitar * -1 : 0;\n      this.xLoadPedidosAtendidos();\n      // console.log(res);\n    });\n  }\n\n}\n","<div class=\"animated fadeInRight p-3\">\n    <div *ngIf=\"listResumen\" class=\"card-pedido fs-13\">\n        <div class=\"card-pedido-head mb-2 border-bottom d-flex justify-content-between\">\n            <span class=\"fw-600\">Resumen del dia</span>\n            <span>{{listResumen.fecha}}</span>\n        </div>\n        <div class=\"\">\n            <div class=\"border-bottom mb-2 d-flex justify-content-between\">\n                <span>N° Pedidos entregados</span>\n                <span>{{listResumen.num_pedidos}}</span>\n            </div>\n            <!-- <div class=\"border-bottom mb-2 d-flex justify-content-between\">\n                <span>Importe Pagado</span>\n                <span>{{listResumen.importePagado}}</span>\n            </div> -->\n            <div class=\"border-bottom mb-2 d-flex justify-content-between\">\n                <span>Comision</span>\n                <span>{{listResumen.comisionRepartidor}}</span>\n            </div>\n            <div class=\"border-bottom mb-2 d-flex justify-content-between\">\n                <span>Propina</span>\n                <span>{{listResumen.propinaRepartidor}}</span>\n            </div>\n            <div class=\"border-bottom fw-600 mb-2 d-flex justify-content-between\">\n                <span>Ganancia Total</span>\n                <span>{{listResumen.costoTotalServicio}}</span>\n            </div>\n\n            <div class=\"border-bottom mb-2 d-flex justify-content-between\">\n                <span>Importe a depositar</span>\n                <span>{{listResumen.importeDepositar}}</span>\n            </div>\n            <div class=\"d-flex justify-content-between\">\n                <span>Importe a debitar</span>\n                <span>{{listResumen.importeDebitar}}</span>\n            </div>\n            <hr>\n\n            <div class=\"border-bottom fw-600 mb-2 d-flex justify-content-between\">\n                <span>Neto a depositar</span>\n                <span>{{importeNetoDepositar | number: '.2'}}</span>\n            </div>\n            <div class=\"border-bottom fw-600 mb-2 d-flex justify-content-between\">\n                <span>Neto a debitar</span>\n                <span>{{importeNetoDebitar | number: '.2'}}</span>\n            </div>\n        </div>\n    </div>\n</div>","import { Component, OnInit, OnDestroy, AfterViewInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\n// import { TimerLimitService } from 'src/app/shared/services/timer-limit.service';\nimport { SocketService } from 'src/app/shared/services/socket.service';\nimport { takeUntil } from 'rxjs/internal/operators/takeUntil';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\nimport { PedidoRepartidorModel } from 'src/app/modelos/pedido.repartidor.model';\nimport { ListenStatusService } from 'src/app/shared/services/listen-status.service';\nimport { TimerLimitService } from 'src/app/shared/services/timer-limit.service';\nimport { GeoPositionModel } from 'src/app/modelos/geoposition.model';\nimport { GpsUbicacionRepartidorService } from 'src/app/shared/services/gps-ubicacion-repartidor.service';\nimport { CrudHttpService } from 'src/app/shared/services/crud-http.service';\nimport { Subscription } from 'rxjs/internal/Subscription';\nimport { RepartidorService } from 'src/app/shared/services/repartidor.service';\n\n\n\n\n@Component({\n  selector: 'app-pedidos',\n  templateUrl: './pedidos.component.html',\n  styleUrls: ['./pedidos.component.css']\n})\nexport class PedidosComponent implements OnInit, OnDestroy, AfterViewInit {\n  efectivoMano = 0;\n  pedidoRepartidor: PedidoRepartidorModel;\n  listPedidos = [];\n  listPedidosGroup = [];\n  _tabIndex = 0;\n  sumAcumuladoPagar = 0;\n  isExpress = false; // si es pedido express mandado o comercio afiliado\n\n  yaQuitoPedido = 0;\n\n  dataPedidos: any;\n  pedido_express: any;\n\n  private positionNow: GeoPositionModel;\n\n  private destroy$: Subject<boolean> = new Subject<boolean>();\n  private unsubscribeSocket = new Subscription();\n  private unsubscribeSocketClearPedido = new Subscription();\n\n  constructor(\n    private infoTokenService: InfoTockenService,\n    // public timerLimitService: TimerLimitService,\n    private socketService: SocketService,\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private router: Router,\n    private listenService: ListenStatusService,\n    public timerLimitService: TimerLimitService,\n    private geoPositionService: GpsUbicacionRepartidorService,\n    // private crudService: CrudHttpService,\n    private repartidorServcice: RepartidorService\n  ) { }\n\n  ngOnInit() {\n    this.efectivoMano = this.infoTokenService.infoUsToken.efectivoMano;\n    this.listenService.setEfectivoMano(this.efectivoMano);\n\n\n    // this.repartidorServcice.listenPedidosNuevos();\n    // console.log('this.infoTokenService.infoUsToken', this.infoTokenService.infoUsToken);\n\n    // this.listPedidos = new PedidoRepartidorModel[0];\n  }\n\n  ngAfterViewInit(): void {\n    // this.geoPositionService.onGeoPosition();\n\n    // iniciar transmitir position\n    // this.geoPositionService.onGeoWatchPosition();\n\n\n    this.listenPedidos();\n  }\n\n  ngOnDestroy(): void {\n    this.unsubscribeSocket.unsubscribe();\n    this.unsubscribeSocketClearPedido.unsubscribe();\n    this.destroy$.next(true);\n    this.destroy$.unsubscribe();\n  }\n\n\n\n  listenPedidos() {\n\n    // escuchar cambios en efectivo mano\n    this.listenService.efectivoManoMano$.subscribe(res => {\n        this.efectivoMano = res === 0 ? this.infoTokenService.infoUsToken.efectivoMano : res;\n    });\n\n    // si recarga la pagina chequea si existe pedido pendiente\n    this.pedidoRepartidor = this.pedidoRepartidorService.pedidoRepartidor;\n\n    // // if ( this.pedidoRepartidor.estado === 0 ) {\n    //   this.addPedidoToList(this.pedidoRepartidor);\n    // }\n\n    // verificar si tenemos pedidos pendientes por aceptar\n    this.unsubscribeSocket = this.socketService.onRepartidorGetPedidoPendienteAceptar()\n    .subscribe((res: any) => {\n\n      // console.log('repartidor-get-pedido-pendiente-aceptar', res);\n      this.dataPedidos = res[0].pedido_por_aceptar;\n\n      this.isExpress = this.dataPedidos ? this.dataPedidos.isexpress || this.dataPedidos.isretiroatm ? this.dataPedidos.isexpress === 1 || this.dataPedidos.isretiroatm === 1 : false : false;\n\n      this.pedidoRepartidorService.setPedidoPorAceptar(this.dataPedidos);\n\n      if ( this.isExpress ) {\n        this.showPedidoExpress();\n        return;\n      }\n\n      // this.pedidoRepartidorService.setPedidoPasoVa(res[0].pedido_paso_va);\n\n      if ( this.dataPedidos === null || res[0].solicita_liberar_pedido === 1) {\n        // console.log('clear pedidos');\n        this.listPedidosGroup = [];\n        this.pedidoRepartidorService.cleanLocal();\n        this.timerLimitService.stopCountTimerLimit();\n        return;\n      }\n\n\n      if ( this.dataPedidos ) {\n        // console.log('repartidor-get-pedido-pendiente-aceptar dataPedidos', this.dataPedidos);\n        this.dataPedidos.pedido_paso_va = res[0].pedido_paso_va;\n        // this.yaQuitoPedido = 2;\n        this.yaQuitoPedido = 0;\n        this.pedidoRepartidorService.setPedidoPasoVa(this.dataPedidos.pedido_paso_va);\n        this.darFormatoGrupoPedidosRecibidos(this.dataPedidos);\n      }\n\n    });\n\n\n    // opcion 2 // grupo de pedidos\n    this.unsubscribeSocket = this.socketService.onRepartidorNuevoPedido()\n    .subscribe((res: any) => {\n\n      // console.log('repartidor-nuevo-pedido', res);\n      const pedidos = res[1];\n\n\n      this.yaQuitoPedido = 1;\n      this.pedidoRepartidorService.setPedidoPasoVa(0);\n      this.pedidoRepartidorService.setPedidoPorAceptar(pedidos);\n      // this.pedidoRepartidorService.setPedidoPasoVa(this.dataPedidos.pedido_paso_va);\n      this.darFormatoGrupoPedidosRecibidos(pedidos);\n    });\n\n\n    this.unsubscribeSocketClearPedido = this.socketService.onRepartidorServerQuitaPedido()\n    .subscribe((idpedido_res: any) => {\n      // console.log('repartidor-notifica-server-quita-pedido');\n      // console.log('idpedido_res', idpedido_res);\n        if ( this.yaQuitoPedido === 1 ) {\n          this.pedidoRepartidorService.setPedidoPasoVa(0);\n          this.pedidoRepartidorService.setPasoVa(0);\n          this.pedidoRepartidorService.setPedidoPorAceptar(null);\n          this.listPedidosGroup = [];\n          this.pedidoRepartidorService.cleanLocal();\n          this.timerLimitService.stopCountTimerLimit();\n          this.yaQuitoPedido = 0;\n        }\n      // }\n    });\n  }\n\n  private darFormatoGrupoPedidosRecibidos(pedidos: any) {    \n    if ( !pedidos ) {return; }\n    // console.log('darFormatoGrupoPedidosRecibidos', new Date().toLocaleDateString());\n    // console.log('pedidos.pedidos.join(', ')', pedidos.pedidos.join(','));\n    const _idSend = Array.from(new Set(pedidos.pedidos)).join(',')\n    // console.log('_idSend', _idSend);\n    this.sumAcumuladoPagar = pedidos.importe_pagar;\n    this.pedidoRepartidorService.loadPedidosRecibidos(_idSend)\n        .subscribe((response: any) => {\n          // console.log('res', response);\n\n          // formateamos el json_}¿datos\n          let importeTotalPedido;\n          const _listAsignar = response.map(p => {\n            p.json_datos_delivery = JSON.parse(p.json_datos_delivery);\n\n            importeTotalPedido  = parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.importeTotal);\n            importeTotalPedido = importeTotalPedido === 0 ? parseFloat(p.json_datos_delivery.p_subtotales[p.json_datos_delivery.p_subtotales.length - 1 ].importe ) : importeTotalPedido;\n\n            p.importe_pagar_comercio =  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.importeTotal) -  parseFloat(p.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery);\n            p.importe_pagar_comercio = p.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago === 2 ? 0 : p.importe_pagar_comercio;\n            return p;\n          });\n\n\n          this.listPedidosGroup = JSON.parse(JSON.stringify(_listAsignar));\n\n          this.pedidoRepartidorService.setLocalIds(pedidos);\n          this.pedidoRepartidorService.setLocalItems( this.listPedidosGroup );\n\n          // this.pedidoRepartidorService.playAudioNewPedido();\n\n        });\n  }\n\n\n  private showPedidoExpress() {\n    this.pedido_express = this.dataPedidos.pedidos;\n  }\n\n  // private addPedidoToList(pedido: PedidoRepartidorModel): void {\n  //   if ( !pedido.datosDelivery ) { return; }\n  //   // console.log('pedido', pedido);\n  //   if ( !pedido.conFormato ) {\n  //     this.pedidoRepartidorService.darFormatoPedidoLocal(pedido.datosItems);\n\n  //     const _arrTotal = this.pedidoRepartidorService.darFormatoSubTotales();\n  //     pedido = this.pedidoRepartidorService.pedidoRepartidor;\n  //     pedido.datosSubtotalesShow = _arrTotal;\n  //     pedido.conFormato  = true; // indica que ya tiene formato\n  //   }\n\n  //   // this.pedidoRepartidorService.setLocal(pedido);\n  //   this.listPedidos.push(pedido);\n\n  //   // console.log(pedido);\n\n  //   this.pedidoRepartidorService.playAudioNewPedido();\n  // }\n\n  aceptaPedido(_establecimiento: any) {\n\n    // console.log('this.dataPedidos', _establecimiento);\n    // notificamos al comercio que estos pedidos ya tienen repartidor\n    this.socketService.emit('repartidor-acepta-pedido', _establecimiento);\n\n    // pedido ya fue aceptado\n    if (this.pedidoRepartidorService.pedidoRepartidor.aceptado ) {\n      this.router.navigate(['./main/list-grupo-pedidos']);\n      return;\n    }\n\n    this.positionNow = this.geoPositionService.get();\n    // console.log('pedido acetpado');\n    // this.router.navigate(['/', 'indicaciones']);\n    // emitir pedido aceptado para comercio\n    // const _dataPedido = {\n      // idsede: this.pedidoRepartidorService.pedidoRepartidor.datosComercio.idsede,\n      // idpedido: this.pedidoRepartidorService.pedidoRepartidor.idpedido,\n      this.dataPedidos.idrepartidor = this.infoTokenService.infoUsToken.usuario.idrepartidor,\n      this.dataPedidos.nombre = this.infoTokenService.infoUsToken.usuario.nombre,\n      this.dataPedidos.apellido = this.infoTokenService.infoUsToken.usuario.apellido,\n      this.dataPedidos.telefono = this.infoTokenService.infoUsToken.usuario.telefono,\n      this.dataPedidos.position_now = this.positionNow;\n    // };\n\n    // console.log('repartidor-acepta-pedido', this.dataPedidos);\n\n    this.pedidoRepartidorService.pedidoRepartidor.aceptado = true;\n    this.pedidoRepartidorService.setLocal();\n\n    this.router.navigate(['./main/list-grupo-pedidos']);\n\n  }\n\n  clickTab($event: any) {\n    // console.log('$event.index', $event.index);\n    this._tabIndex = $event.index;\n  }\n\n  recargarPedido() {\n    location.reload();\n  }\n\n  goScanCodeBar() {\n    this.router.navigate(['./main/mapa-de-pedidos']);\n  }\n\n  pedidoExpressEntregado(pedidoFinalizado: any) {\n    // console.log('finaliza el pedido');\n    pedidoFinalizado.quitar = true;\n    this.quitarPedidoExpress(pedidoFinalizado.idpedido_mandado);\n\n    this.pedidoRepartidorService.finalizarPedidoExpress(pedidoFinalizado, this.dataPedidos);\n  }\n\n  quitarPedidoExpress(_idpedido_mandado: number) {\n    this.pedido_express = this.pedido_express.filter(x => x.idpedido_mandado !== _idpedido_mandado);\n    this.dataPedidos.pedidos = this.pedido_express;\n\n    // finaliza todo\n    if ( this.pedido_express.length === 0 ) {\n      this.isExpress = false;\n      this.pedido_express = null;\n      this.pedidoRepartidorService.cleanLocal();\n    }\n  }\n\n  // // hora_acepta_pedido\n  // // hora_entrega_pedido\n  // updateTimeLinePedido(pedido: any) {\n\n  // }\n\n  // showPedido() {\n  //   this.timerLimitService.playCountTimerLimit();\n  // }\n\n\n  // peticion(op: number) {\n  //   this.efectivoMano += 1;\n  //   const putSend = {\n  //     online: 1,\n  //     efectivo: 100,\n  //     estado: 1\n  //   };\n  //   switch (op) {\n  //     case 1: // peticion get sin token\n  //       this.crudService.getFree('https://app.restobar.papaya.com.pe/api.pwa/v3/comercio/get-sin-token').subscribe(res => console.log(res));\n  //       break;\n  //     case 2: // peticion get con token\n  //       this.crudService.getAll('repartidor', 'get-sin-token', false, false, true).subscribe(res => console.log(res));\n  //       break;\n  //     case 3: // peticion put sin token\n  //       // this.crudService.postFree(putSend, 'repartidor', 'set-sin-token', false).subscribe(res => console.log(res));\n  //       this.crudService.getAll('pruebas', 'get-con-select-sin-token', false, false, true).subscribe(res => console.log(res));\n  //       break;\n  //     case 4: // peticion put con token\n  //     this.crudService.postFree(putSend, 'pruebas', 'put-con-token', true).subscribe(res => console.log(res));\n  //       break;\n  //     default:\n  //       break;\n  //   }\n  // }\n\n}\n","<div class=\"animated fadeInDown\">\n    <div class=\"p-3 bg-dark text-white fs-13 d-flex justify-content-between\">\n        <div>\n            <span>Efectivo en mano</span>\n        </div>\n        <div>\n            <span>S/. {{efectivoMano | number: '.2'}}</span>\n        </div>\n    </div>\n</div>\n\n<!-- lista pedidos -->\n<div class=\"w-100\">    \n    <mat-tab-group mat-stretch-tabs (selectedTabChange)=\"clickTab($event)\">\n        <mat-tab label=\"Pendientes\"> \n\n            <div class=\"p-3 x-h-size\">\n                <ng-container *ngIf=\"listPedidosGroup.length === 0; else elseTemplate\">\n                    <div class=\"text-center\" *ngIf=\"!isExpress\">\n                        <button mat-stroked-button (click)=\"recargarPedido()\">Recargar ...</button>\n\n                        <br><br>\n                        <button class=\"btn btn-secondary\" (click)=\"goScanCodeBar()\">\n                            <i class=\"fa fa-barcode pr-\"></i>\n                            Escanear codigo barras</button>\n                    </div>\n                </ng-container>\n                <ng-template #elseTemplate>                                \n                        <!-- <div *ngFor=\"let item of listPedidos\">\n                            <app-item-pedido [infoPedido] = \"item\" (aceptaPedido)=\"aceptaPedido($event)\"></app-item-pedido>\n                        </div> -->\n\n                        <div>\n                            <app-item-pedido [listPedidos] = \"listPedidosGroup\" [importeAcumuladoPagar]=\"sumAcumuladoPagar\" (aceptaPedido)=\"aceptaPedido($event)\"></app-item-pedido>\n                        </div>                        \n                </ng-template>\n\n                <!-- si es pedido express -->\n                <div *ngIf=\"isExpress\">\n                    <div *ngFor=\"let item of pedido_express\" class=\"mb-3 animated fadeInDown\">\n                        <app-item-pedido-express [elpedido]=\"item\" (pedidoEntregado)=\"pedidoExpressEntregado($event)\"></app-item-pedido-express>\n                    </div>\n                </div>\n                        \n            </div>\n\n        </mat-tab>\n        <mat-tab label=\"Entregados\"> \n            <div class=\"x-h-size\">\n\n                <app-pedidos-atendidos [tabIndex]=\"_tabIndex\"></app-pedidos-atendidos>\n            </div>\n        </mat-tab>        \n    </mat-tab-group>\n</div>\n\n<!-- <div class=\"xfooter\" matRipple>\n    <div class=\"btn-footer\">\n        <i class=\"fa fa-qrcode fa-2x pr-2\" aria-hidden=\"true\"></i>\n        <span>Scanear Qr pedido</span>\n    </div>\n</div> -->","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RepartidorRoutingModule } from './repartidor.rounting';\n\nimport { MainComponent } from './main/main.component';\nimport { PedidosComponent } from './pedidos/pedidos.component';\nimport { IndicacionesPedidoComponent } from './indicaciones-pedido/indicaciones-pedido.component';\nimport { MaterialModule } from 'src/app/core/material/material.module';\nimport { CoreModule } from 'src/app/core/core.module';\nimport { ComponentesModule } from 'src/app/componentes/componentes.module';\n// import { DialogEfectivoRepartidorComponent } from 'src/app/componentes/dialog-efectivo-repartidor/dialog-efectivo-repartidor.component';\nimport { PedidoDetalleComponent } from './pedido-detalle/pedido-detalle.component';\nimport { PedidosAtendidosComponent } from './pedidos-atendidos/pedidos-atendidos.component';\nimport { MapaPedidosComponent } from './mapa-pedidos/mapa-pedidos.component';\nimport { IndicacionesGrupoMapaComponent } from './indicaciones-grupo-mapa/indicaciones-grupo-mapa.component';\nimport { ListGrupoPedidosComponent } from './list-grupo-pedidos/list-grupo-pedidos.component';\n\n\n\n@NgModule({\n  declarations: [\n    MainComponent,\n    PedidosComponent,\n    IndicacionesPedidoComponent,\n    PedidoDetalleComponent,\n    PedidosAtendidosComponent,\n    MapaPedidosComponent,\n    IndicacionesGrupoMapaComponent,\n    ListGrupoPedidosComponent],\n  imports: [\n    CommonModule,\n    RepartidorRoutingModule,\n    CoreModule,\n    ComponentesModule,\n    MaterialModule,\n  ],\n  // entryComponents: [\n  //   DialogEfectivoRepartidorComponent\n  // ]\n})\nexport class RepartidorModule { }\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { MainComponent } from './main/main.component';\r\nimport { PedidosComponent } from './pedidos/pedidos.component';\r\nimport { IndicacionesPedidoComponent } from './indicaciones-pedido/indicaciones-pedido.component';\r\nimport { PedidoDetalleComponent } from './pedido-detalle/pedido-detalle.component';\r\nimport { PedidosAtendidosComponent } from './pedidos-atendidos/pedidos-atendidos.component';\r\nimport { MapaPedidosComponent } from './mapa-pedidos/mapa-pedidos.component';\r\nimport { ListGrupoPedidosComponent } from './list-grupo-pedidos/list-grupo-pedidos.component';\r\nimport { IndicacionesGrupoMapaComponent } from './indicaciones-grupo-mapa/indicaciones-grupo-mapa.component';\r\n\r\nconst routes: Routes = [{\r\n    path: '', component: MainComponent,\r\n    data: { titulo: 'Inicio' },\r\n    children: [\r\n        // {\r\n        //     path: '', redirectTo: 'pedidos'\r\n        // },\r\n        {\r\n            path: 'pedidos',\r\n            component: PedidosComponent,\r\n            data: { titulo: 'Pedido' }\r\n        },\r\n        {\r\n            path: 'indicaciones',\r\n            component: IndicacionesPedidoComponent,\r\n            data: { titulo: 'Indicaciones Pedido' }\r\n        },\r\n        {\r\n            path: 'pedido-detalle',\r\n            component: PedidoDetalleComponent,\r\n            data: { titulo: 'Indicaciones Pedido' }\r\n        },\r\n        {\r\n            path: 'pedidos-atendidos',\r\n            component: PedidosAtendidosComponent,\r\n            data: { titulo: 'Pedidos Atendidos' }\r\n        },\r\n        {\r\n            path: 'mapa-de-pedidos',\r\n            component: MapaPedidosComponent,\r\n            data: { titulo: 'Mapa de pedidos' }\r\n        },\r\n        {\r\n            path: 'list-grupo-pedidos',\r\n            component: ListGrupoPedidosComponent,\r\n            data: { titulo: 'Grupo de pedidos' }\r\n        },\r\n        {\r\n            path: 'indicaciones-mapa-grupo',\r\n            component: IndicacionesGrupoMapaComponent,\r\n            data: { titulo: 'Indicaciones en el mapa' }\r\n        }\r\n\r\n    ]\r\n}];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class RepartidorRoutingModule { }\r\n","// servicio adminsitra el navigator link -- carta y resumen\nimport { Injectable } from '@angular/core';\nimport { Event as NavigationEvent, Router, NavigationStart } from '@angular/router';\nimport { filter, bufferCount } from 'rxjs/operators';\nimport { BehaviorSubject } from 'rxjs/internal/BehaviorSubject';\nimport { InfoTockenService } from './info-token.service';\nimport { EstadoPedidoClienteService } from './estado-pedido-cliente.service';\nimport { ListenStatusService } from './listen-status.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NavigatorLinkService {\n\n  public disabledBack = false;\n  private resNavigatorSource = new BehaviorSubject<any[]>([]);\n  public resNavigatorSourceObserve$ = this.resNavigatorSource.asObservable();\n\n  private pageActive = 'carta';\n\n  private resNavigator: any = [];\n  private historyNavigator: any[] = [];\n  private lastUrlHistory = '';\n\n\n  constructor(\n    private router: Router,\n    private infoTokenService: InfoTockenService,\n    private listenService: ListenStatusService,\n    // private estadoPedidoClienteService: EstadoPedidoClienteService,\n    // private dialog: MatDialog,\n    // private miPedidoService: MipedidoService,\n  ) {\n    // router.events.pipe(\n    //   filter((event: NavigationEvent) => {\n    //     return (event instanceof NavigationStart);\n    //   })\n    // ).subscribe(\n    //   (event: NavigationStart) => {\n    //     console.log('navigation', event);\n    //     if (event.navigationTrigger !== 'popstate') {\n    //       let _urlParams: any;\n    //       try {\n    //         _urlParams = event.url.split(';')[1].split('=')[1];\n    //       } catch (error) {\n    //         // this.managerGoBack();\n    //         _urlParams = [];\n    //         return;\n    //       }\n\n    //       if (_urlParams.length > 0) {\n    //         this.resNavigator.pageActive = this.pageActive;\n    //         this.resNavigator.url = _urlParams;\n\n    //         // this.saveHistoryPageActive(this.pageActive, _urlParams);\n    //         this.resNavigatorSource.next(this.resNavigator);\n    //       }\n    //     }\n    //   });\n\n    this.listenEventNavigator();\n  }\n\n  private listenEventNavigator() {\n    this.router.events.pipe(\n      filter(e => e instanceof NavigationStart)\n      , bufferCount(2, 1)).subscribe((e: any) => {\n        if (e !== null && e !== undefined) {\n          if (e[1].navigationTrigger === 'popstate') {\n            // desahabilitar boton back\n            if ( this.disabledBack ) {return false; }\n\n            const elUrl = e[0]['url'];\n            const _url = elUrl.indexOf(';') ? e[0]['url'].substr(1).split(';')[1].split('=')[1] : e[0]['url'];\n            // const _nextUrl = e[1]['url'].substr(1).split(';')[1].split('=')[1];\n            if ( _url.length > 0) {\n              this.lastUrlHistory = _url; // last url -- de donde viene\n              // this.managerGoBack(_url, '');\n            }\n          }\n          // console.log(e[0]);\n        }\n      });\n  }\n\n\n  setPageActive(_pageActive): void {\n    this.pageActive = _pageActive;\n    this.lastUrlHistory = _pageActive !== 'carta' ? _pageActive : this.lastUrlHistory;\n\n    const itemHistory = this.findPageActiveInHistory(_pageActive);\n\n    if ( itemHistory ) { // si existe\n      this.addLink(itemHistory.url);\n    } else {\n      // this.saveHistoryPageActive(_pageActive, _pageActive);\n      this.addLink(_pageActive);\n    }\n    this.resNavigator.pageActive = _pageActive;\n    this.resNavigator.url = itemHistory ? itemHistory.url : _pageActive;\n    this.resNavigatorSource.next(this.resNavigator);\n  }\n\n  private saveHistoryPageActive(key: string, url: string): void {\n    this.historyNavigator[key] = [];\n    this.historyNavigator[key].key = key;\n    this.historyNavigator[key].url = url;\n  }\n\n  private findPageActiveInHistory(_key: string): any {\n    return Object.values(this.historyNavigator).filter(x => x.key === _key)[0];\n  }\n\n  addLink(params: string): void {\n    this.router.navigate(['.', { state: params }]);\n\n    this.saveHistoryPageActive(this.pageActive, params);\n  }\n\n  cerrarSession(reload: boolean = false) {\n    if ( this.infoTokenService.isDelivery() ) {\n      this.router.navigate(['../zona-delivery']);\n    } else {\n      this.router.navigate(['../'])\n      .then(() => {\n        if ( reload ) {\n          window.location.reload();\n        }\n      });\n    }\n  }\n\n  // maneja los back\n  // si es [mipedido-confirma] -> ['mipedido']\n  // si es [mipedido, estado] -> 'carta' - > historial\n  // si es [carta-i-secciones-items] -> [carta-i-secciones]\n  // si es [carta-i-secciones] -> [carta-i-]\n  // si es [carta-i-] -> 'carta'\n  // si es [carta] -> inicio\n  managerGoBack(previusUrl: string, nexturl: string) {\n    // const _url = this.lastUrlHistory;\n    let _pageActive = '';\n    console.log('managerGoBack', previusUrl);\n    switch (previusUrl) {\n      case 'carta-i-secciones-items':\n        _pageActive = 'carta';\n        this.addLink('carta-i-secciones');\n        break;\n      case 'carta-i-secciones':\n        _pageActive = 'carta';\n        this.addLink('carta-i-');\n        break;\n      case 'carta-i-':\n        _pageActive = 'carta-o-';\n        this.addLink('carta-o-');\n        console.log('=========================== listo para salir');\n        this.listoParaSalir();\n        break;\n      // case 'carta-o':\n      //   _pageActive = 'carta';\n      //   this.addLink('carta');\n      //   console.log('listo para salir');\n      //   break;\n      case 'mipedido-confirma':\n        _pageActive = 'mipedido';\n        this.addLink('mipedido');\n        break;\n      case 'mipedido':\n        _pageActive = 'carta';\n        this.addLink('carta');\n\n        this.listoParaSalir();\n        // console.log('=========================== listo para salir');\n        break;\n      case 'estado':\n        _pageActive = 'carta';\n        // this.findAndApplyHistory(_pageActive);\n        break;\n      case 'carta':\n        // _pageActive = '';\n        // this.router.navigate(['../']);\n        _pageActive = 'carta';\n        break;\n      case 'lanzar-encuesta':\n        _pageActive = 'lanzar-encuesta';\n        break;\n    }\n\n    if (_pageActive !== '' ) {\n      this.pageActive = _pageActive;\n      this.setPageActive(_pageActive);\n    }\n  }\n\n  // usar router de servicio\n  _router(link: string) {\n    this.router.navigate([link]);\n  }\n\n  disableGoBack(): void {\n    this.disabledBack = true;\n    history.pushState(null, null, location.href);\n    window.onpopstate = function () {\n        history.go(1);\n    };\n  }\n\n  private listoParaSalir(): void {\n    if ( this.infoTokenService.isDelivery() ) {\n      // abrir cerrarr\n      // if ( this.estadoPedidoClienteService.estadoPedido.hayPedidoCliente ) {\n\n        this.listenService.setIsOutEstablecimientoDelivery(true);\n\n      // }\n    }\n  }\n\n  // private findAndApplyHistory(_pageActive): void {\n  //   const itemHistory = this.findPageActiveInHistory(_pageActive);\n  //   if (itemHistory) { // si existe\n  //     this.addLink(itemHistory.url);\n  //   }\n  // }\n\n  // goBack(): void {\n  //   window.history.back();\n  // }\n\n\n}\n"]}