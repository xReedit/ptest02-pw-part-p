{"version":3,"sources":["./node_modules/@capacitor/push-notifications/dist/esm/definitions.js","./node_modules/@capacitor/push-notifications/dist/esm/index.js","./src/app/pages/inicio-repartidor/inicio-repartidor.module.ts","./src/app/pages/inicio-repartidor/inicio-repartidor.routing.ts","./src/app/pages/inicio-repartidor/main/main.component.ts","./src/app/pages/inicio-repartidor/main/main.component.html"],"names":[],"mappings":"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","file":"pages-inicio-repartidor-inicio-repartidor-module-es2015.js","sourcesContent":["/// <reference types=\"@capacitor/cli\" />\nexport {};\n//# sourceMappingURL=definitions.js.map","import { registerPlugin } from '@capacitor/core';\nconst PushNotifications = registerPlugin('PushNotifications', {});\nexport * from './definitions';\nexport { PushNotifications };\n//# sourceMappingURL=index.js.map","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MainComponent } from './main/main.component';\nimport { InicioRepartidorRoutingModule } from './inicio-repartidor.routing';\nimport { CoreModule } from 'src/app/core/core.module';\n\n\n\n@NgModule({\n  declarations: [MainComponent],\n  imports: [\n    CommonModule,\n    InicioRepartidorRoutingModule,\n    CoreModule\n  ]\n})\nexport class InicioRepartidorModule { }\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { MainComponent } from './main/main.component';\r\n\r\nconst routes: Routes = [{\r\n    path: '', component: MainComponent,\r\n    data: { titulo: 'Inicio' }\r\n}];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class InicioRepartidorRoutingModule { }\r\n","import { Component, OnInit, AfterViewInit } from '@angular/core';\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\nimport { NotificacionPushService } from 'src/app/shared/services/notificacion-push.service';\nimport { GpsUbicacionRepartidorService } from 'src/app/shared/services/gps-ubicacion-repartidor.service';\n\nimport { Router } from '@angular/router';\nimport { PedidoRepartidorService } from 'src/app/shared/services/pedido-repartidor.service';\n\nimport {\n  ActionPerformed,\n  PushNotificationSchema,\n  PushNotifications,    \n  Token,\n} from '@capacitor/push-notifications';\n\nimport { Plugins } from '@capacitor/core';\nimport { UtilitariosService } from 'src/app/shared/services/utilitarios.service';\nimport { IS_NATIVE } from 'src/app/shared/config/config.const';\n\nconst { Geolocation } = Plugins;\n\n@Component({\n  selector: 'app-main',\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.css']\n})\nexport class MainComponent implements OnInit {\n  nomRepartidor: '';\n  isOnNotificactionPush = false;\n  isOnGeoPosition = false;\n  isValid = false;\n  is\n\n  constructor(\n    private infoTokenService: InfoTockenService,\n    private pushNotificationService: NotificacionPushService,\n    private geoPositionService: GpsUbicacionRepartidorService,\n    private router: Router,\n    private pedidoRepartidorService: PedidoRepartidorService,\n    private utilitarioService: UtilitariosService\n  ) { }\n\n  ngOnInit(): void {\n\n    this.infoTokenService.getInfoUs();\n    // console.log(this.infoTokenService.getInfoUs());\n    this.nomRepartidor = this.infoTokenService.infoUsToken.usuario.nombre;\n\n    this.pedidoRepartidorService.cleanLocal();\n\n    console.log('aaa');\n\n    if (!IS_NATIVE) { return; }\n    PushNotifications.requestPermissions().then(result => {\n      console.log('result.receive', result.receive);\n      if (result.receive === 'granted') {\n        // Register with Apple / Google to receive push via APNS/FCM\n        PushNotifications.register()        \n      } else {\n        // Show some error\n        console.log('error al registrar');\n      }\n    });    \n     \n    // On success, we should be able to receive notifications\n    PushNotifications.addListener('registration',\n      (token: Token) => {        \n        console.log('addListener token.value ', token.value);\n        this.pushNotificationService.saveSuscripcion(token.value);\n      }\n    );    \n\n    // Some issue with our setup and push will not work\n    PushNotifications.addListener('registrationError',\n      (error: any) => {\n        alert('Error en registrar: ' + JSON.stringify(error));\n      }\n    );\n\n    // Show us the notification payload if the app is open on our device\n    // PushNotifications.addListener('pushNotificationReceived',\n    //   (notification: PushNotificationSchema) => {\n    //     alert('Push received: ' + JSON.stringify(notification));\n    //   }\n    // );\n\n    // Method called when tapping on a notification\n    // PushNotifications.addListener('pushNotificationActionPerformed',\n    //   (notification: ActionPerformed) => {\n    //     alert('Push action performed: ' + JSON.stringify(notification));\n    //   }\n    // );\n\n  }\n\n  async aceptarNotificacion() {\n    if (!IS_NATIVE) {\n      try {\n        if ( await this.pushNotificationService.getIsTienePermiso()) {\n          this.pushNotificationService.suscribirse();\n        }\n\n      } \n      catch (error) {\n      }\n    }\n\n    this.isOnNotificactionPush = true;\n    this.validConf();\n  }\n\n  // aceptarPosition() {\n  //   this.geoPositionService.onGeoPosition();\n\n  //   // setTimeout(() => {\n  //   //   this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n  //   //   this.pushNotificationService.suscribirse();\n  //   //   this.isOnGeoPosition = true;\n  //   //   this.validConf();\n  //   // }, 1500);\n  // }\n\n  aceptarPosition() {\n    try {\n      \n      Geolocation.requestPermissions().then(() => {\n        // Permisos de geolocalización aceptados\n        // GPS activado\n        this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n        // this.pushNotificationService.suscribirse();\n        this.isOnGeoPosition = true;\n        this.validConf();      \n      }, (err) => {\n        // Permisos de geolocalización rechazados\n        // GPS no activado\n        alert('Es necesario que active su ubicación (GPS)')\n\n        this.geoPositionService.onGeoPosition();\n  \n        setTimeout(() => {\n          this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n          this.pushNotificationService.suscribirse();\n          this.isOnGeoPosition = true;\n          this.validConf();\n        }, 1500);\n      });\n\n    } catch (error) {\n      // navegador\n      this.geoPositionService.onGeoPosition();\n  \n      setTimeout(() => {\n        this.isOnGeoPosition = this.geoPositionService.getGeoPosition().hasPermition;\n        this.pushNotificationService.suscribirse();\n        this.isOnGeoPosition = true;\n        this.validConf();\n      }, 1500);\n    }\n\n  }\n\n  // aceptarPosition2() {\n  //   Geolocation.getCurrentPosition().then(position => {\n  //     alert(position);\n  //   });\n  // }\n\n  private validConf() {\n    this.isValid = this.isOnNotificactionPush && this.isOnGeoPosition;\n\n    if ( this.isValid ) {\n\n      setTimeout(() => {\n        this.router.navigate(['./main']);\n      }, 1400);\n\n    }\n  }\n\n}\n","<div class=\"animated fadeIn\">\n    <div class=\"p-3 text-center w-100\">\n        <span>Hola</span>\n        <h5>{{ nomRepartidor }}</h5>\n        <hr>\n\n        <div>\n            <img src=\"assets/images/img-ini.png\" alt=\"img-ini\" style=\"max-width: 150px;\">\n        </div>\n        <br>\n\n\n        <p class=\"fs-17\" *ngIf=\"!isValid\">Para recibir pedidos es necesario que:</p>      \n        <br>\n        <ng-container *ngIf=\"!isOnGeoPosition\">\n            <div>\n                <div class=\"fw-100\">\n                    Active su ubicación (GPS).\n                </div>\n                <div>\n                    <button mat-flat-button color=\"primary\" (click)=\"aceptarPosition()\">Activar</button>\n                    <!-- <button mat-flat-button color=\"primary\" (click)=\"aceptarPosition1()\">Activar 1 </button> -->\n                    <!-- <button mat-flat-button color=\"primary\" (click)=\"aceptarPosition2()\">Activar 2</button> -->\n                </div>\n            </div>            \n            <hr>\n        </ng-container>\n\n      \n        <ng-container *ngIf=\"!isOnNotificactionPush\">\n            <div>\n                <div>\n                    <div class=\"fw-100\">\n                        Active las notificaciones.\n                    </div>\n                    <div>\n                        <button mat-flat-button color=\"primary\" (click)=\"aceptarNotificacion()\">Activar</button>\n                    </div>\n                </div>            \n            </div>\n            <hr>\n        </ng-container>\n\n        <div *ngIf=\"isValid\">\n            <h6>Validando Permisos.</h6>\n        </div>\n\n       \n    </div>\n</div>"],"sourceRoot":"webpack:///"}