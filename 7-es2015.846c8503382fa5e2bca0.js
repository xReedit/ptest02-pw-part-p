(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"6qA3":function(e,i,t){"use strict";var o=t("OAkW"),s=t("Z5tI"),a=t("poJ0"),n=t("ozli"),r=t("yRPT"),d=t("90cg"),c=t("GMZp"),l=t("VKeD"),p=t("zfKp");i.subscribeTo=function(e){if(e&&"function"==typeof e[p.observable])return n.subscribeToObservable(e);if(r.isArrayLike(e))return o.subscribeToArray(e);if(d.isPromise(e))return s.subscribeToPromise(e);if(e&&"function"==typeof e[l.iterator])return a.subscribeToIterable(e);var i=c.isObject(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},"8Xr9":function(e,i,t){"use strict";t.r(i),t.d(i,"RepartidorModule",(function(){return at}));var o=t("ofXK"),s=t("tyNb"),a=t("0IaG"),n=t("dDDv"),r=t("w/My"),d=t("zOUh"),c=t("jzV0"),l=t("eI2u"),p=t("fXoL"),b=t("kmnG"),h=t("qFsG"),u=t("bTqV");let m=(()=>{class e{constructor(e,i,t,o,s){this.pushNotificationService=e,this.geoPositionService=i,this.infoTokenService=t,this.repartidorService=o,this.listenService=s,this.isOnNotificactionPush=!1,this.isOnGeoPosition=!1,this.importeIndicado=0,this.importe=""}ngOnInit(){}ngAfterViewInit(){this.isOnNotificactionPush=this.pushNotificationService.getIsTienePermiso()}guardarEfectivoMano(){this.repartidorService.guardarEfectivo(this.importeIndicado,1),this.infoTokenService.setEfectivoMano(this.importeIndicado),this.listenService.setEfectivoMano(this.importeIndicado)}validImporte(e){this.importeIndicado=isNaN(parseInt(e,0))?0:parseInt(e,0)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(n.a),p.Ob(r.a),p.Ob(d.a),p.Ob(c.a),p.Ob(l.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-dialog-efectivo-repartidor"]],decls:14,vars:1,consts:[[1,"w-100"],["type","number","matInput","","placeholder","Efectivo en mano","required","",3,"keyup"],["importe",""],[1,"fs-12","text-secondary","fw-100"],[1,"text-center"],["mat-flat-button","","color","primary","mat-dialog-close","",3,"disabled","click"]],template:function(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div"),p.Ub(1,"p"),p.Ec(2,"Parametros Iniciales: "),p.Tb(),p.Pb(3,"hr"),p.Ub(4,"div"),p.Ub(5,"mat-form-field",0),p.Ub(6,"input",1,2),p.cc("keyup",(function(){p.wc(e);const t=p.vc(7);return i.validImporte(t.value)})),p.Tb(),p.Tb(),p.Ub(8,"span",3),p.Ec(9,"Seg\xfan este importe se le asignaran pedidos que debe pagar en efectivo"),p.Tb(),p.Tb(),p.Pb(10,"hr"),p.Ub(11,"div",4),p.Ub(12,"button",5),p.cc("click",(function(){return i.guardarEfectivoMano()})),p.Ec(13,"Listo"),p.Tb(),p.Tb(),p.Tb()}2&e&&(p.Cb(12),p.mc("disabled",0===i.importeIndicado))},directives:[b.a,h.a,u.a,a.d],styles:[""]}),e})();var g=t("yFR0"),f=t("QB/n"),v=t("ds6q"),P=t("pLZG"),C=t("7o/Q");class T{constructor(e,i){this.bufferSize=e,this.startBufferEvery=i,this.subscriberClass=i&&e!==i?y:_}call(e,i){return i.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))}}class _ extends C.a{constructor(e,i){super(e),this.bufferSize=i,this.buffer=[]}_next(e){const i=this.buffer;i.push(e),i.length==this.bufferSize&&(this.destination.next(i),this.buffer=[])}_complete(){const e=this.buffer;e.length>0&&this.destination.next(e),super._complete()}}class y extends C.a{constructor(e,i,t){super(e),this.bufferSize=i,this.startBufferEvery=t,this.buffers=[],this.count=0}_next(e){const{bufferSize:i,startBufferEvery:t,buffers:o,count:s}=this;this.count++,s%t==0&&o.push([]);for(let a=o.length;a--;){const t=o[a];t.push(e),t.length===i&&(o.splice(a,1),this.destination.next(t))}}_complete(){const{buffers:e,destination:i}=this;for(;e.length>0;){let t=e.shift();t.length>0&&i.next(t)}super._complete()}}var S=t("7RJT");let U=(()=>{class e{constructor(e,i,t){this.router=e,this.infoTokenService=i,this.listenService=t,this.disabledBack=!1,this.resNavigatorSource=new S.BehaviorSubject([]),this.resNavigatorSourceObserve$=this.resNavigatorSource.asObservable(),this.pageActive="carta",this.resNavigator=[],this.historyNavigator=[],this.lastUrlHistory="",this.listenEventNavigator()}listenEventNavigator(){this.router.events.pipe(Object(P.a)(e=>e instanceof s.a),function(e,i=null){return function(t){return t.lift(new T(e,i))}}(2,1)).subscribe(e=>{if(null!=e&&"popstate"===e[1].navigationTrigger){if(this.disabledBack)return!1;const i=e[0].url.indexOf(";")?e[0].url.substr(1).split(";")[1].split("=")[1]:e[0].url;i.length>0&&(this.lastUrlHistory=i)}})}setPageActive(e){this.pageActive=e,this.lastUrlHistory="carta"!==e?e:this.lastUrlHistory;const i=this.findPageActiveInHistory(e);this.addLink(i?i.url:e),this.resNavigator.pageActive=e,this.resNavigator.url=i?i.url:e,this.resNavigatorSource.next(this.resNavigator)}saveHistoryPageActive(e,i){this.historyNavigator[e]=[],this.historyNavigator[e].key=e,this.historyNavigator[e].url=i}findPageActiveInHistory(e){return Object.values(this.historyNavigator).filter(i=>i.key===e)[0]}addLink(e){this.router.navigate([".",{state:e}]),this.saveHistoryPageActive(this.pageActive,e)}cerrarSession(e=!1){this.infoTokenService.isDelivery()?this.router.navigate(["../zona-delivery"]):this.router.navigate(["../"]).then(()=>{e&&window.location.reload()})}managerGoBack(e,i){let t="";switch(console.log("managerGoBack",e),e){case"carta-i-secciones-items":t="carta",this.addLink("carta-i-secciones");break;case"carta-i-secciones":t="carta",this.addLink("carta-i-");break;case"carta-i-":t="carta-o-",this.addLink("carta-o-"),console.log("=========================== listo para salir"),this.listoParaSalir();break;case"mipedido-confirma":t="mipedido",this.addLink("mipedido");break;case"mipedido":t="carta",this.addLink("carta"),this.listoParaSalir();break;case"estado":case"carta":t="carta";break;case"lanzar-encuesta":t="lanzar-encuesta"}""!==t&&(this.pageActive=t,this.setPageActive(t))}_router(e){this.router.navigate([e])}disableGoBack(){this.disabledBack=!0,history.pushState(null,null,location.href),window.onpopstate=function(){history.go(1)}}listoParaSalir(){this.infoTokenService.isDelivery()&&this.listenService.setIsOutEstablecimientoDelivery(!0)}}return e.\u0275fac=function(i){return new(i||e)(p.Yb(s.b),p.Yb(d.a),p.Yb(l.a))},e.\u0275prov=p.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=t("3Pt+");function R(e,i){if(1&e&&(p.Ub(0,"p",8),p.Ec(1),p.Tb()),2&e){const e=p.gc();p.Cb(1),p.Fc(e.msj)}}function k(e,i){1&e&&(p.Sb(0),p.Pb(1,"i",9),p.Rb())}function D(e,i){1&e&&p.Ec(0," Guardar ")}let E=(()=>{class e{constructor(e,i,t,o){this.dialogRef=e,this.repartidroService=t,this.infoToken=o,this.dataCliente={},this.msj="",this.loading=!1}ngOnInit(){}guardarClave(){this.msj="",this.loading=!0,this.dataCliente.p1===this.infoToken.getInfoUs().usuario.pass?(this.repartidroService.guardarCamnioClave(this.dataCliente),setTimeout(()=>{this.infoToken.getInfoUs().usuario.pass=this.dataCliente.p2,this.infoToken.set(),this.loading=!1,this.dialogRef.close()},1500)):(this.msj="Contrase\xf1a actual no coicide",this.loading=!1)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.g),p.Ob(a.a),p.Ob(c.a),p.Ob(d.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-dialog-change-pass"]],decls:15,vars:6,consts:[[1,"w-100"],["type","password","matInput","","placeholder","Clave actual","required","",3,"ngModel","ngModelChange"],["type","password","matInput","","placeholder","Clave nueva","required","",3,"ngModel","ngModelChange"],["class","text-danger",4,"ngIf"],["mat-flat-button","","color","primary",1,"mr-1","mb-1",3,"disabled","click"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["mat-stroked-button","","mat-dialog-close",""],[1,"text-danger"],[1,"fa","fa-spinner","fa-spin"]],template:function(e,i){if(1&e&&(p.Ub(0,"p"),p.Ec(1,"Cmabiar Clave"),p.Tb(),p.Pb(2,"hr"),p.Ub(3,"mat-form-field",0),p.Ub(4,"input",1),p.cc("ngModelChange",(function(e){return i.dataCliente.p1=e})),p.Tb(),p.Tb(),p.Ub(5,"mat-form-field",0),p.Ub(6,"input",2),p.cc("ngModelChange",(function(e){return i.dataCliente.p2=e})),p.Tb(),p.Tb(),p.Cc(7,R,2,1,"p",3),p.Pb(8,"hr"),p.Ub(9,"button",4),p.cc("click",(function(){return i.guardarClave()})),p.Cc(10,k,2,0,"ng-container",5),p.Cc(11,D,1,0,"ng-template",null,6,p.Dc),p.Tb(),p.Ub(13,"button",7),p.Ec(14,"Cancelar"),p.Tb()),2&e){const e=p.vc(12);p.Cb(4),p.mc("ngModel",i.dataCliente.p1),p.Cb(2),p.mc("ngModel",i.dataCliente.p2),p.Cb(1),p.mc("ngIf",i.msj.length>0),p.Cb(2),p.mc("disabled",i.loading),p.Cb(1),p.mc("ngIf",i.loading)("ngIfElse",e)}},directives:[b.a,h.a,w.b,w.o,w.j,w.m,o.m,u.a,a.d],styles:[""]}),e})();var x=t("XhcP"),I=t("FKr1"),O=t("1jcm");function j(e,i){if(1&e){const e=p.Vb();p.Ub(0,"mat-slide-toggle",6),p.cc("change",(function(i){return p.wc(e),p.gc().repartidorOnLine(i)})),p.Tb()}if(2&e){const e=p.gc();p.mc("checked",e.isTogleActive)}}let A=(()=>{class e{constructor(e,i,t){this.infoTokenService=e,this.repartidorService=i,this.socketService=t,this.changeTogle=new p.o(!1),this.openMenuLateral=new p.o(!1),this.isTogleActive=!1,this.isRepartidorPropio=!1,this.estadoOnline="En linea",this.nomRepatidor=""}ngOnInit(){this.isTogleActive=this.infoTokenService.infoUsToken.isOnline,this.isRepartidorPropio=this.infoTokenService.infoUsToken.usuario.idsede_suscrito,this.estadoOnline=this.isRepartidorPropio||this.isTogleActive?"En linea":"Fuera de linea",this.nomRepatidor=this.infoTokenService.infoUsToken.usuario.nombre+" "+this.infoTokenService.infoUsToken.usuario.apellido,this.socketService.connect(),this.isRepartidorPropio&&this.infoTokenService.setisOnline(this.isTogleActive)}repartidorOnLine(e){this.isTogleActive=e.checked,this.infoTokenService.setisOnline(this.isTogleActive),this.changeTogle.emit(this.isTogleActive),this.estadoOnline="En linea",this.isTogleActive?this.socketService.emit("notifica-repartidor-online",""):(this.estadoOnline="Fuera de linea",this.repartidorService.guardarEfectivo(0,0),this.socketService.emit("notifica-repartidor-ofline",""))}abrirMenuLateral(){this.openMenuLateral.emit(!0)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(d.a),p.Ob(c.a),p.Ob(g.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-tool-bar-repartidor"]],outputs:{changeTogle:"changeTogle",openMenuLateral:"openMenuLateral"},decls:10,vars:5,consts:[[1,"header-app","p-3","d-flex","justify-content-between"],[1,"fa","fa-bars","pr-2",3,"click"],[1,"fs-14"],[1,"d-flex","align-items-center"],[1,"fs-12","pr-2"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div"),p.Ub(2,"i",1),p.cc("click",(function(){return i.abrirMenuLateral()})),p.Tb(),p.Ub(3,"span",2),p.Ec(4),p.hc(5,"titlecase"),p.Tb(),p.Tb(),p.Ub(6,"div",3),p.Ub(7,"span",4),p.Ec(8),p.Tb(),p.Cc(9,j,1,1,"mat-slide-toggle",5),p.Tb(),p.Tb()),2&e&&(p.Cb(4),p.Fc(p.ic(5,3,i.nomRepatidor)),p.Cb(4),p.Fc(i.estadoOnline),p.Cb(1),p.mc("ngIf",!i.isRepartidorPropio))},directives:[o.m,O.a],pipes:[o.u],styles:[""]}),e})();const L=function(e){return{loaded:e}};let M=(()=>{class e{constructor(e,i,t,o,s,a,n){this.dialog=e,this.socketService=i,this.repartidorService=t,this.infoTokeService=o,this.pedidoRepartidorService=s,this.router=a,this.navigatorService=n,this.destroy$=new v.Subject,this.isRepartidorPropio=!1,this.showPanelLeft=!1}ngOnInit(){try{this.pedidoRepartidorService.init(),this.socketService.isSocketOpenReconect=!1,this.infoTokeService.getInfoUs(),this.isRepartidorPropio=this.infoTokeService.infoUsToken.usuario.idsede_suscrito,this.infoTokeService.infoUsToken.usuario.isRepartidorPropio=this.isRepartidorPropio,this.infoTokeService.set(),this.socketService.connect(),this.navigatorService.disableGoBack()}catch(e){this.router.navigate(["../"])}this.isRepartidorPropio?(this.repartidorService.guardarEfectivo(100),this.router.navigate(["/main/mapa-de-pedidos"])):this.router.navigate(["/main/pedidos"])}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}repartidorOnLine(e){if(e){const e=new a.e;e.disableClose=!0,e.hasBackdrop=!0,this.dialog.open(m,e),this.socketService.connect()}}cerrarSession(){this.repartidorService.guardarEfectivo(0,0),this.socketService.closeConnection(),this.router.navigate(["../"])}openPanelLeft(e){this.showPanelLeft=!0}openCambiarClave(){const e=new a.e;e.disableClose=!0,e.hasBackdrop=!0,this.dialog.open(E,e)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.b),p.Ob(g.a),p.Ob(c.a),p.Ob(d.a),p.Ob(f.a),p.Ob(s.b),p.Ob(U))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-main"]],decls:40,vars:9,consts:[[3,"ngClass"],[1,"wrapper"],["id","loader-wrapper"],["id","loader"],[1,"loader-msj"],[1,"loader-section","section-left"],[1,"loader-section","section-right"],[1,"xh-100"],["mode","over",1,"example-sidenav",3,"opened","closedStart"],["drawerIzq",""],[2,"min-width","250px"],[1,"p-3","border-bottom"],[1,"w-100","text-center"],["src","assets/icons/icon-72x72.png"],[1,"pt-1","fw-600","fs-12","text-secondary","m-0"],[1,"pt-1","fw-100","fs-11","text-secondary","m-0"],[1,"p-3","border-bottom","w-100",3,"click"],[1,"fw-600","fs-13"],[1,"fa","fa-arrow-left","pr-2"],[1,"fs-13"],["matRipple","",1,"border-bottom","p-3","xCursor",3,"click"],["aria-hidden","true",1,"fa","fa-key"],[1,"fa","fa-close","pr-2"],[1,"text-info","fs-11"],[1,"animated","fadeInDown","w-100","top-0"],[3,"changeTogle","openMenuLateral"],[1,"content-body"]],template:function(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",0),p.hc(1,"async"),p.Ub(2,"div",1),p.Ub(3,"div",2),p.Pb(4,"div",3),p.Ub(5,"div",4),p.Ec(6),p.hc(7,"async"),p.Tb(),p.Pb(8,"div",5),p.Pb(9,"div",6),p.Tb(),p.Tb(),p.Tb(),p.Ub(10,"mat-drawer-container",7),p.Ub(11,"mat-drawer",8,9),p.cc("closedStart",(function(){return i.showPanelLeft=!1})),p.Ub(13,"div",10),p.Ub(14,"div",11),p.Ub(15,"div",12),p.Pb(16,"img",13),p.Ub(17,"p",14),p.Ec(18,"Papaya Repartidor"),p.Tb(),p.Ub(19,"p",15),p.Ec(20,"papaya.com.pe"),p.Tb(),p.Tb(),p.Tb(),p.Ub(21,"div",16),p.cc("click",(function(){return p.wc(e),p.vc(12).toggle()})),p.Ub(22,"span",17),p.Pb(23,"i",18),p.Ec(24,"Opciones"),p.Tb(),p.Tb(),p.Ub(25,"div",19),p.Ub(26,"div",20),p.cc("click",(function(){p.wc(e);const t=p.vc(12);return i.openCambiarClave(),t.toggle()})),p.Pb(27,"i",21),p.Ec(28," Cambiar clave "),p.Tb(),p.Ub(29,"div",20),p.cc("click",(function(){return i.cerrarSession()})),p.Pb(30,"i",22),p.Ub(31,"span"),p.Ec(32," Cerrar Sesion"),p.Tb(),p.Pb(33,"br"),p.Ub(34,"span",23),p.Ec(35,"Al cerrar dejara de recibir pedidos."),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Ub(36,"div",24),p.Ub(37,"app-tool-bar-repartidor",25),p.cc("changeTogle",(function(e){return i.repartidorOnLine(e)}))("openMenuLateral",(function(e){return i.openPanelLeft(e)})),p.Tb(),p.Ub(38,"div",26),p.Pb(39,"router-outlet"),p.Tb(),p.Tb(),p.Tb()}2&e&&(p.mc("ngClass",p.rc(7,L,p.ic(1,3,i.socketService.isSocketOpen$))),p.Cb(6),p.Fc(p.ic(7,5,i.socketService.msjConex$)),p.Cb(5),p.mc("opened",i.showPanelLeft))},directives:[o.k,x.b,x.a,I.e,A,s.e],pipes:[o.b],styles:[".content-body[_ngcontent-%COMP%]{padding-top:55px;overflow:auto;overscroll-behavior-y:auto}"]}),e})(),F=(()=>{class e{constructor(){this.countdownTimerRef=null,this.init=0,this.maxTime=60,this.valPorcentaje=0,this.isPlayTimer=!1,this.countTimer=0,this.countdownSource=new S.BehaviorSubject(0),this.countdown$=this.countdownSource.asObservable(),this.countTimeSource=new S.BehaviorSubject(0),this.countTime$=this.countTimeSource.asObservable(),this.isTimeLimitSource=new S.BehaviorSubject(!1),this.isTimeLimitComplet$=this.isTimeLimitSource.asObservable(),this.isPorgressVisibleSource=new S.BehaviorSubject(!1),this.isPorgressVisible$=this.isPorgressVisibleSource.asObservable()}destroy(){this.clearTimeout()}playCountTimerLimit(){this.isPlayTimer||(this.isPlayTimer=!0,this.initCount())}resetCountTimerLimit(){localStorage.getItem("sys::tcount")?(this.isPlayTimer=!0,this.initCount()):this.stopCountTimerLimit()}initCount(){this.valPorcentaje=0,this.init=localStorage.getItem("sys::tcount")?parseInt(localStorage.getItem("sys::tcount"),0):0,this.isTimeLimitSource.next(!1),this.isPorgressVisibleSource.next(!0),this.countTimer=this.maxTime-this.setTimeDate(),this.progressCount()}progressCount(){let e=0;this.isPlayTimer&&(this.countdownTimerRef=setTimeout(()=>{this.init=this.setTimeDate(),this.countTimer--,this.valPorcentaje=Math.round(this.init/this.maxTime*100),localStorage.setItem("sys::tcount",this.init.toString()),this.init>this.maxTime?(this.init=this.maxTime,this.valPorcentaje=100,this.countdownSource.next(this.valPorcentaje),this.isTimeLimitSource.next(!0),this.stopCountTimerLimit()):(e!==this.valPorcentaje&&this.countdownSource.next(this.valPorcentaje),this.progressCount()),this.countTimeSource.next(this.countTimer),e=this.valPorcentaje},1e3))}setTimeDate(){const e=(new Date).getTime(),i=localStorage.getItem("sys::tnum")?parseInt(localStorage.getItem("sys::tnum"),0):e,t=Math.floor((e-i)/1e3);return localStorage.setItem("sys::tnum",i.toString()),t}stopCountTimerLimit(){this.isPlayTimer=!1,this.init=0,this.valPorcentaje=0,this.countTimer=0,localStorage.removeItem("sys::tcount"),localStorage.removeItem("sys::tnum"),this.clearTimeout(),this.isPorgressVisibleSource.next(!1),this.isTimeLimitSource.next(!1)}clearTimeout(){this.countdownTimerRef&&(clearTimeout(this.countdownTimerRef),this.countdownTimerRef=null)}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=p.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var G=t("zB/H"),$=t("wZkO"),N=t("+lji");function V(e,i){if(1&e&&(p.Ub(0,"div",2),p.Ub(1,"div",3),p.Ub(2,"span",4),p.Ec(3,"Resumen del dia"),p.Tb(),p.Ub(4,"span"),p.Ec(5),p.Tb(),p.Tb(),p.Ub(6,"div",5),p.Ub(7,"div",6),p.Ub(8,"span"),p.Ec(9,"N\xb0 Pedidos entregados"),p.Tb(),p.Ub(10,"span"),p.Ec(11),p.Tb(),p.Tb(),p.Ub(12,"div",6),p.Ub(13,"span"),p.Ec(14,"Comision"),p.Tb(),p.Ub(15,"span"),p.Ec(16),p.Tb(),p.Tb(),p.Ub(17,"div",6),p.Ub(18,"span"),p.Ec(19,"Propina"),p.Tb(),p.Ub(20,"span"),p.Ec(21),p.Tb(),p.Tb(),p.Ub(22,"div",7),p.Ub(23,"span"),p.Ec(24,"Ganancia Total"),p.Tb(),p.Ub(25,"span"),p.Ec(26),p.Tb(),p.Tb(),p.Ub(27,"div",6),p.Ub(28,"span"),p.Ec(29,"Importe a depositar"),p.Tb(),p.Ub(30,"span"),p.Ec(31),p.Tb(),p.Tb(),p.Ub(32,"div",8),p.Ub(33,"span"),p.Ec(34,"Importe a debitar"),p.Tb(),p.Ub(35,"span"),p.Ec(36),p.Tb(),p.Tb(),p.Pb(37,"hr"),p.Ub(38,"div",7),p.Ub(39,"span"),p.Ec(40,"Neto a depositar"),p.Tb(),p.Ub(41,"span"),p.Ec(42),p.hc(43,"number"),p.Tb(),p.Tb(),p.Ub(44,"div",7),p.Ub(45,"span"),p.Ec(46,"Neto a debitar"),p.Tb(),p.Ub(47,"span"),p.Ec(48),p.hc(49,"number"),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e){const e=p.gc();p.Cb(5),p.Fc(e.listResumen.fecha),p.Cb(6),p.Fc(e.listResumen.num_pedidos),p.Cb(5),p.Fc(e.listResumen.comisionRepartidor),p.Cb(5),p.Fc(e.listResumen.propinaRepartidor),p.Cb(5),p.Fc(e.listResumen.costoTotalServicio),p.Cb(5),p.Fc(e.listResumen.importeDepositar),p.Cb(5),p.Fc(e.listResumen.importeDebitar),p.Cb(6),p.Fc(p.jc(43,9,e.importeNetoDepositar,".2")),p.Cb(6),p.Fc(p.jc(49,12,e.importeNetoDebitar,".2"))}}let z=(()=>{class e{constructor(e){this.crudService=e,this.importeNetoDebitar=0,this.importeNetoDepositar=0}set tabIndex(e){1===e&&this.xLoadResumenPedidos()}ngOnInit(){this.xLoadResumenPedidos()}xLoadPedidosAtendidos(){this.crudService.getAll("repartidor","get-pedidos-entregados-dia",!1,!1,!0).subscribe(e=>{this.listPedidosEntregados=e.data[0]})}xLoadResumenPedidos(){this.crudService.getAll("repartidor","get-pedidos-resumen-entregados-dia",!1,!1,!0).subscribe(e=>{this.listResumen=e.data[0][0],this.listResumen&&(this.importeNetoDebitar=parseFloat(this.listResumen.importeDepositar)-parseFloat(this.listResumen.importeDebitar),this.importeNetoDepositar=this.importeNetoDebitar<1?0:this.importeNetoDebitar,this.importeNetoDebitar=this.importeNetoDebitar<1?-1*this.importeNetoDebitar:0,this.xLoadPedidosAtendidos())})}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(N.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-pedidos-atendidos"]],inputs:{tabIndex:"tabIndex"},decls:2,vars:1,consts:[[1,"animated","fadeInRight","p-3"],["class","card-pedido fs-13",4,"ngIf"],[1,"card-pedido","fs-13"],[1,"card-pedido-head","mb-2","border-bottom","d-flex","justify-content-between"],[1,"fw-600"],[1,""],[1,"border-bottom","mb-2","d-flex","justify-content-between"],[1,"border-bottom","fw-600","mb-2","d-flex","justify-content-between"],[1,"d-flex","justify-content-between"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Cc(1,V,50,15,"div",1),p.Tb()),2&e&&(p.Cb(1),p.mc("ngIf",i.listResumen))},directives:[o.m],pipes:[o.e],styles:[".card-pedido[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;padding:15px;background-color:#eee}.card-pedido-head[_ngcontent-%COMP%]{align-items:center;margin-bottom:3px}.card-pedido-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}"]}),e})();var H=t("bv9b");function B(e,i){if(1&e&&(p.Sb(0),p.Pb(1,"mat-progress-bar",1),p.hc(2,"async"),p.Rb()),2&e){const e=p.gc();p.Cb(1),p.mc("value",p.ic(2,1,e.timerLimitService.countdown$))}}let W=(()=>{class e{constructor(e){this.timerLimitService=e}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(F))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-progress-time-limit"]],decls:2,vars:3,consts:[[4,"ngIf"],["mode","determinate","color","accent",1,"animated","fadeInDown",3,"value"]],template:function(e,i){1&e&&(p.Cc(0,B,3,3,"ng-container",0),p.hc(1,"async")),2&e&&p.mc("ngIf",p.ic(1,1,i.timerLimitService.isPorgressVisible$))},directives:[o.m,H.a],pipes:[o.b],styles:[""]}),e})();function q(e,i){1&e&&p.Pb(0,"img",13)}let K=(()=>{class e{constructor(e,i){this.timerLimitService=e,this.pedidoRepartidorService=i,this.aceptaPedido=new p.o(!1),this.estadoPedido=0,this.countPedidos=0,this.sumGananciaTotal=0,this.sumKmRecorrer=0,this.isHayPropina=!1}ngOnChanges(){console.log(this.listPedidos)}ngOnInit(){this.leerInfoGroup()}leerInfoGroup(){this.pedidoRepartidorService.init(),this.estadoPedido=this.pedidoRepartidorService.pedidoRepartidor.estado?this.pedidoRepartidorService.pedidoRepartidor.estado:this.listPedidos[0].estado,this.countPedidos=this.listPedidos.length,this.establecimientoOrden=this.listPedidos[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento,this.listPedidos.map(e=>{const i=e.json_datos_delivery.p_header.arrDatosDelivery.propina.value?parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.propina.value):0;this.sumGananciaTotal+=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery)+i,this.sumKmRecorrer+=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.c_km),this.isHayPropina||(this.isHayPropina=e.json_datos_delivery.p_header.arrDatosDelivery.propina.value>0)}),this.pedidoRepartidorService.pedidoRepartidor.sumGananciaTotal=this.sumGananciaTotal,this.pedidoRepartidorService.setLocal(),this.showPedido()}showPedido(){0===this.pedidoRepartidorService.pedidoRepartidor.pedido_paso_va&&(this.timerLimitService.isPlayTimer=!1,this.timerLimitService.playCountTimerLimit(),this.timerLimitService.isTimeLimitComplet$.subscribe(e=>{e&&0===this.estadoPedido&&this.timerLimitService.stopCountTimerLimit()}))}aceptarPedido(){0===this.pedidoRepartidorService.pedidoRepartidor.pedido_paso_va&&(this.estadoPedido=1,this.pedidoRepartidorService.pedidoRepartidor.pedido_paso_va=1,this.pedidoRepartidorService.setPedidoPasoVa(1)),this.pedidoRepartidorService.asignarPedido(),this.pedidoRepartidorService.pedidoRepartidor.aceptado=!0,this.aceptaPedido.emit(!0)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(F),p.Ob(f.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-item-pedido"]],inputs:{listPedidos:"listPedidos",importeAcumuladoPagar:"importeAcumuladoPagar"},outputs:{aceptaPedido:"aceptaPedido"},features:[p.Ab],decls:46,vars:19,consts:[[1,"animated","fadeInUp","card-pedido"],[1,"card-pedido-head","border-bottom","pb-2","d-flex","justify-content-between"],[1,"fw-600","text-secondary","fs-13","pr-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-arrow-right","pl-2"],[1,"card-pedido-timer"],[1,"card-pedido-body"],[1,"pt-3","fs-13"],[1,"fw-100"],[1,"fs-14"],[1,"d-flex","justify-content-between","fs-13","text-center"],[1,"fs-15","fw-600"],["class","img-propina","src","assets/images/r-propina-coin.png","alt","img-propina",4,"ngIf"],["src","assets/images/r-propina-coin.png","alt","img-propina",1,"img-propina"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div"),p.Ub(3,"span"),p.Ec(4),p.hc(5,"number"),p.Tb(),p.Tb(),p.Ub(6,"div"),p.Ub(7,"span",2),p.Ec(8),p.hc(9,"async"),p.Tb(),p.Ub(10,"button",3),p.cc("click",(function(){return i.aceptarPedido()})),p.Ub(11,"div"),p.Ec(12," Listo vamos "),p.Pb(13,"i",4),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Ub(14,"div",5),p.Pb(15,"app-progress-time-limit"),p.Tb(),p.Ub(16,"div",6),p.Ub(17,"div",7),p.Ub(18,"p",8),p.Ec(19,"Comercio : "),p.Ub(20,"span",9),p.Ec(21),p.Tb(),p.Tb(),p.Ub(22,"p",8),p.Ec(23,"Direccion : "),p.Ub(24,"span",9),p.Ec(25),p.Tb(),p.Tb(),p.Tb(),p.Pb(26,"hr"),p.Ub(27,"div",10),p.Ub(28,"div"),p.Ub(29,"p",8),p.Ec(30,"Distancia"),p.Tb(),p.Ub(31,"span",11),p.Ec(32),p.Tb(),p.Tb(),p.Ub(33,"div"),p.Ub(34,"p",8),p.Ec(35,"Importe Pagar"),p.Tb(),p.Ub(36,"span",11),p.Ec(37),p.hc(38,"number"),p.Tb(),p.Tb(),p.Ub(39,"div"),p.Ub(40,"p",8),p.Ec(41,"Ganancia"),p.Tb(),p.Cc(42,q,1,0,"img",12),p.Ub(43,"span",11),p.Ec(44),p.hc(45,"number"),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e&&(p.Cb(4),p.Gc("Pedidos (",p.jc(5,8,i.countPedidos,"2."),")"),p.Cb(4),p.Gc(" ",p.ic(9,11,i.timerLimitService.countTime$),"''"),p.Cb(13),p.Fc(i.establecimientoOrden.nombre),p.Cb(4),p.Fc(i.establecimientoOrden.direccion),p.Cb(7),p.Gc("",i.sumKmRecorrer," Km"),p.Cb(5),p.Gc("S/. ",p.jc(38,13,i.importeAcumuladoPagar,".2"),""),p.Cb(5),p.mc("ngIf",i.isHayPropina),p.Cb(2),p.Gc("S/. ",p.jc(45,16,i.sumGananciaTotal,"0.2"),""))},directives:[W,o.m],pipes:[o.e,o.b],styles:[".card-pedido[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;padding:15px;background-color:#eee}.card-pedido-head[_ngcontent-%COMP%]{align-items:center;margin-bottom:3px}.card-pedido-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.img-propina[_ngcontent-%COMP%]{width:20px;padding-right:5px}"]}),e})(),J=(()=>{class e{constructor(e){switch(this.msj="",this.titleBtnCancel="No",this.titleBtnSuccess="Si, por favor",e?e.idMjs:0){case 0:this.msj="Desea que se le notifique cuando su pedido este listo?";break;case 1:this.msj="Desea saber cuando tenga descuentos y/o ofertas?";break;case 2:this.msj="Seguro de finalizar el pedido?"}}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-dialog-desicion"]],decls:10,vars:4,consts:[[1,"p-3"],[1,"fw-100","fs-15"],["mat-flat-button","","color","primary",3,"mat-dialog-close"],["mat-stroked-button","","mat-dialog-close","",1,"ml-1"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"span",1),p.Ec(2),p.Tb(),p.Pb(3,"hr"),p.Ub(4,"mat-dialog-actions"),p.Ub(5,"button",2),p.Ec(6),p.Tb(),p.Ub(7,"button",3),p.Ec(8),p.Tb(),p.Tb(),p.Pb(9,"br"),p.Tb()),2&e&&(p.Cb(2),p.Fc(i.msj),p.Cb(3),p.mc("mat-dialog-close",!0),p.Cb(1),p.Fc(i.titleBtnSuccess),p.Cb(2),p.Fc(i.titleBtnCancel))},directives:[a.c,u.a,a.d],styles:[""]}),e})();function Y(e,i){1&e&&(p.Ub(0,"span",23),p.Pb(1,"i",24),p.Tb())}function Q(e,i){if(1&e&&(p.Ub(0,"p",25),p.Ec(1),p.Tb()),2&e){const e=p.gc(2);p.Cb(1),p.Fc(e.desde_referencia)}}function Z(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",22),p.cc("click",(function(){return p.wc(e),p.gc().irRuta(1)})),p.Ub(1,"p",2),p.Ec(2,"De donde: "),p.Cc(3,Y,2,0,"span",15),p.Tb(),p.Ub(4,"p",5),p.Ec(5),p.Tb(),p.Cc(6,Q,2,1,"p",16),p.Ub(7,"button",17),p.cc("click",(function(){return p.wc(e),p.gc().irRuta(1)})),p.Ec(8," Ver ruta "),p.Tb(),p.Tb()}if(2&e){const e=p.gc();p.Cb(3),p.mc("ngIf",e.goRutaDesde),p.Cb(2),p.Fc(e.desde),p.Cb(1),p.mc("ngIf",e.desde_referencia)}}function X(e,i){1&e&&(p.Ub(0,"span",23),p.Pb(1,"i",24),p.Tb())}function ee(e,i){if(1&e&&(p.Ub(0,"p",25),p.Ec(1),p.Tb()),2&e){const e=p.gc();p.Cb(1),p.Fc(e.hasta_referencia)}}let ie=(()=>{class e{constructor(e,i){this.geoPositionService=e,this.dialog=i,this.pedidoEntregado=new p.o,this.metodoPago="",this.desde="",this.hasta="",this.desde_referencia="",this.hasta_referencia="",this.descripcion_pedido="",this.nomCliente="",this.telCliente="",this.isPagoYape=!1,this.isPedidoExpress=!1,this.isRetiroAtm=!1,this.goRutaHasta=!1,this.goRutaDesde=!1,this.sumKmRecorrer="",this.importe=0,this.numPedido=0}ngOnInit(){var e,i,t,o;if(this.isPedidoExpress=1===(null===(e=this.elpedido.pedido_json)||void 0===e?void 0:e.is_express),this.isRetiroAtm=1===(null===(i=this.elpedido)||void 0===i?void 0:i.isretiroatm)||!!(null===(t=this.elpedido)||void 0===t?void 0:t.idatm_retiros),(null===(o=this.elpedido)||void 0===o?void 0:o.isretiroatm)&&(this.elpedido.idpedido_mandado=this.elpedido.idatm_retiros),this.isRetiroAtm)return this.metodoPago="Tarjeta",this.descripcion_pedido="Solicita retiro de dinero en efectivo S/."+parseFloat(this.elpedido.importe_solicita).toFixed(2),this.nomCliente=this.elpedido.json_entrega.cliente.nombres,this.telCliente=this.elpedido.json_entrega.cliente.telefono,this.numPedido=this.elpedido.idatm_retiros,this.desde="",this.dirHasta=this.elpedido.json_entrega.direccion,this.hasta=this.elpedido.json_entrega.direccion.direccion,this.hasta_referencia=this.elpedido.json_entrega.direccion.referencia,this.goRutaHasta=!0,this.importe=this.elpedido.c_entrega,void(this.sumKmRecorrer="");this.isPagoYape=3===this.elpedido.pedido_json.metodoPago.idtipo_pago,this.metodoPago=this.isPagoYape?"Yape":`Efectivo ${this.elpedido.pedido_json.metodoPago.importe}`,this.descripcion_pedido=this.isPedidoExpress?this.elpedido.pedido_json.descripcion_paquete:this.elpedido.pedido_json.que_compramos,this.nomCliente=this.elpedido.nom_cliente,this.telCliente=this.elpedido.telefono,this.numPedido=this.elpedido.idpedido_mandado,this.isPedidoExpress?(this.dirDesde=this.elpedido.pedido_json.direccionA,this.desde=this.dirDesde.direccion,this.desde_referencia=this.dirDesde.referencia,this.dirHasta=this.elpedido.pedido_json.direccionB,this.hasta=this.dirHasta.direccion,this.hasta_referencia=this.dirHasta.referencia,this.goRutaDesde=!0,this.goRutaHasta=!0):(this.desde=this.elpedido.pedido_json.donde_compramos,this.desde_referencia=null,this.dirHasta=this.elpedido.pedido_json.direccionCliente,this.hasta=this.dirHasta.direccion,this.hasta_referencia=this.dirHasta.referencia,this.goRutaDesde=!1,this.goRutaHasta=!0),this.sumKmRecorrer=this.elpedido.pedido_json.distancia_km,this.importe=this.elpedido.pedido_json.importe_pagar}irRuta(e){this.geoPositionService.get(),this.geoPositionActual=this.geoPositionService.getGeoPosition(),1===e?window.open(`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.dirHasta.latitude},${this.dirHasta.longitude}`,"_blank"):this.goRutaDesde&&window.open(`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.dirDesde.latitude},${this.dirDesde.longitude}`,"_blank")}finalizarPedidoExpress(){const e=new a.e;e.disableClose=!0,e.hasBackdrop=!0,e.data={idMjs:2},console.log("show dialog DialogDesicionComponent"),this.dialog.open(J,e).afterClosed().subscribe(e=>{e&&(console.log("aaaaaaaaaaaaaaaaaaaaaaaaa"),this.isRetiroAtm&&(this.elpedido.idpedido_mandado=this.elpedido.idatm_retiros),this.pedidoEntregado.emit(this.elpedido))})}redirectWhatsApp(){window.open(`https://api.whatsapp.com/send?phone=51${this.elpedido.telefono}`,"_blank")}callPhone(){window.open(`tel:${this.elpedido.telefono}`)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(r.a),p.Ob(a.b))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-item-pedido-express"]],inputs:{elpedido:"elpedido"},outputs:{pedidoEntregado:"pedidoEntregado"},decls:58,vars:14,consts:[[1,"animated","fadeInUp","card-pedido"],[1,"card-pedido-head","border-bottom","pb-2","d-flex","justify-content-between","align-items-center"],[1,"fs-11","fw-600","text-secondary"],[1,"card-pedido-body"],[1,"pt-3","fs-13"],[1,"fw-100"],[1,"fw-600"],[1,"d-flex","justify-content-between","mt-2"],["matRipple","",1,"col-6","border-right","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-phone"],["matRipple","",1,"col-6","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-commenting-o"],[1,"fw-100","fw-600","fs-15"],["matRipple","",3,"click",4,"ngIf"],["matRipple","",1,"d-flex","justify-content-between",3,"click"],["class","pl-2",4,"ngIf"],["class","fw-100 text-secondary",4,"ngIf"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"d-flex","justify-content-between","fs-13","text-center"],[1,"fs-15","fw-600"],[1,"w-100","text-center"],[1,"btn","btn-success",3,"click"],["matRipple","",3,"click"],[1,"pl-2"],[1,"fa","fa-arrow-right","text-success"],[1,"fw-100","text-secondary"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"span"),p.Ec(3),p.Tb(),p.Ub(4,"span",2),p.Ec(5),p.Tb(),p.Tb(),p.Ub(6,"div",3),p.Ub(7,"div",4),p.Ub(8,"p",2),p.Ec(9,"Cliente: "),p.Tb(),p.Ub(10,"p",5),p.Ec(11),p.Tb(),p.Ub(12,"p"),p.Ec(13,"Telefono: "),p.Ub(14,"span",6),p.Ec(15),p.Tb(),p.Tb(),p.Ub(16,"div",7),p.Ub(17,"div",8),p.cc("click",(function(){return i.callPhone()})),p.Pb(18,"i",9),p.Ec(19," LLamar"),p.Tb(),p.Ub(20,"div",10),p.cc("click",(function(){return i.redirectWhatsApp()})),p.Pb(21,"i",11),p.Ec(22," Enviar Mensaje"),p.Tb(),p.Tb(),p.Pb(23,"hr"),p.Ub(24,"p",2),p.Ec(25,"Pedido: "),p.Tb(),p.Ub(26,"p",12),p.Ec(27),p.Tb(),p.Pb(28,"hr"),p.Cc(29,Z,9,3,"div",13),p.Pb(30,"hr"),p.Ub(31,"div",14),p.cc("click",(function(){return i.irRuta(1)})),p.Ub(32,"div"),p.Ub(33,"p",2),p.Ec(34,"A donde lo llevamos: "),p.Cc(35,X,2,0,"span",15),p.Tb(),p.Ub(36,"p",5),p.Ec(37),p.Tb(),p.Cc(38,ee,2,1,"p",16),p.Tb(),p.Ub(39,"button",17),p.cc("click",(function(){return i.irRuta(1)})),p.Ec(40," Ver ruta "),p.Tb(),p.Tb(),p.Pb(41,"hr"),p.Ub(42,"div",18),p.Ub(43,"div"),p.Ub(44,"p",5),p.Ec(45,"Distancia"),p.Tb(),p.Ub(46,"span",19),p.Ec(47),p.Tb(),p.Tb(),p.Ub(48,"div"),p.Ub(49,"p",5),p.Ec(50,"Costo de entrega"),p.Tb(),p.Ub(51,"span",19),p.Ec(52),p.hc(53,"number"),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Pb(54,"hr"),p.Ub(55,"div",20),p.Ub(56,"button",21),p.cc("click",(function(){return i.finalizarPedidoExpress()})),p.Ec(57," Listo, pedido entregado."),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e&&(p.Cb(3),p.Gc("Pedidos Express #",i.numPedido,""),p.Cb(2),p.Gc("Paga con: ",i.metodoPago,""),p.Cb(6),p.Gc(" ",i.nomCliente," "),p.Cb(4),p.Gc(" ",i.telCliente," "),p.Cb(12),p.Gc(" ",i.descripcion_pedido," "),p.Cb(2),p.mc("ngIf",""!==i.desde),p.Cb(6),p.mc("ngIf",i.goRutaHasta),p.Cb(2),p.Fc(i.hasta),p.Cb(1),p.mc("ngIf",i.hasta_referencia),p.Cb(9),p.Gc("",i.sumKmRecorrer," Km"),p.Cb(5),p.Gc("S/. ",p.jc(53,11,i.importe,".2"),""))},directives:[I.e,o.m],pipes:[o.e],styles:[".card-pedido[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;padding:15px;background-color:#eee}.card-pedido-head[_ngcontent-%COMP%]{margin-bottom:3px}.card-pedido-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.img-propina[_ngcontent-%COMP%]{width:20px;padding-right:5px}"]}),e})();function te(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",13),p.Ub(1,"button",14),p.cc("click",(function(){return p.wc(e),p.gc(2).recargarPedido()})),p.Ec(2,"Recargar ..."),p.Tb(),p.Pb(3,"br"),p.Pb(4,"br"),p.Ub(5,"button",15),p.cc("click",(function(){return p.wc(e),p.gc(2).goScanCodeBar()})),p.Ec(6," Asignarse Pedido "),p.Tb(),p.Tb()}}function oe(e,i){if(1&e&&(p.Sb(0),p.Cc(1,te,7,0,"div",12),p.Rb()),2&e){const e=p.gc();p.Cb(1),p.mc("ngIf",!e.isExpress)}}function se(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div"),p.Ub(1,"app-item-pedido",16),p.cc("aceptaPedido",(function(i){return p.wc(e),p.gc().aceptaPedido(i)})),p.Tb(),p.Tb()}if(2&e){const e=p.gc();p.Cb(1),p.mc("listPedidos",e.listPedidosGroup)("importeAcumuladoPagar",e.sumAcumuladoPagar)}}function ae(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",18),p.Ub(1,"app-item-pedido-express",19),p.cc("pedidoEntregado",(function(i){return p.wc(e),p.gc(2).pedidoExpressEntregado(i)})),p.Tb(),p.Tb()}if(2&e){const e=i.$implicit;p.Cb(1),p.mc("elpedido",e)}}function ne(e,i){if(1&e&&(p.Ub(0,"div"),p.Cc(1,ae,2,1,"div",17),p.Tb()),2&e){const e=p.gc();p.Cb(1),p.mc("ngForOf",e.pedido_express)}}let re=(()=>{class e{constructor(e,i,t,o,s,a,n,r){this.infoTokenService=e,this.socketService=i,this.pedidoRepartidorService=t,this.router=o,this.listenService=s,this.timerLimitService=a,this.geoPositionService=n,this.repartidorServcice=r,this.efectivoMano=0,this.listPedidos=[],this.listPedidosGroup=[],this._tabIndex=0,this.sumAcumuladoPagar=0,this.isExpress=!1,this.yaQuitoPedido=0,this.destroy$=new v.Subject,this.unsubscribeSocket=new G.Subscription,this.unsubscribeSocketClearPedido=new G.Subscription}ngOnInit(){this.efectivoMano=this.infoTokenService.infoUsToken.efectivoMano,this.listenService.setEfectivoMano(this.efectivoMano)}ngAfterViewInit(){this.geoPositionService.onGeoPosition(),this.geoPositionService.onGeoWatchPosition(),this.listenPedidos()}ngOnDestroy(){this.unsubscribeSocket.unsubscribe(),this.unsubscribeSocketClearPedido.unsubscribe(),this.destroy$.next(!0),this.destroy$.unsubscribe()}listenPedidos(){this.listenService.efectivoManoMano$.subscribe(e=>{this.efectivoMano=0===e?this.infoTokenService.infoUsToken.efectivoMano:e}),this.pedidoRepartidor=this.pedidoRepartidorService.pedidoRepartidor,this.unsubscribeSocket=this.socketService.onRepartidorGetPedidoPendienteAceptar().subscribe(e=>{if(console.log("repartidor-get-pedido-pendiente-aceptar",e[0]),this.dataPedidos=e[0].pedido_por_aceptar,this.isExpress=!(!this.dataPedidos||!this.dataPedidos.isexpress&&!this.dataPedidos.isretiroatm||1!==this.dataPedidos.isexpress&&1!==this.dataPedidos.isretiroatm),this.pedidoRepartidorService.setPedidoPorAceptar(this.dataPedidos),!this.isExpress)return null===this.dataPedidos||1===e[0].solicita_liberar_pedido?(this.listPedidosGroup=[],this.pedidoRepartidorService.cleanLocal(),void this.timerLimitService.stopCountTimerLimit()):void(this.dataPedidos&&(this.dataPedidos.pedido_paso_va=e[0].pedido_paso_va,this.yaQuitoPedido=2,this.pedidoRepartidorService.setPedidoPasoVa(this.dataPedidos.pedido_paso_va),this.darFormatoGrupoPedidosRecibidos(this.dataPedidos)));this.showPedidoExpress()}),this.unsubscribeSocket=this.socketService.onRepartidorNuevoPedido().subscribe(e=>{const i=e[1];this.yaQuitoPedido=1,this.pedidoRepartidorService.setPedidoPasoVa(0),this.pedidoRepartidorService.setPedidoPorAceptar(i),this.darFormatoGrupoPedidosRecibidos(i)}),this.unsubscribeSocketClearPedido=this.socketService.onRepartidorServerQuitaPedido().subscribe(e=>{1===this.yaQuitoPedido&&(this.pedidoRepartidorService.setPedidoPasoVa(0),this.pedidoRepartidorService.setPasoVa(0),this.pedidoRepartidorService.setPedidoPorAceptar(null),this.listPedidosGroup=[],this.pedidoRepartidorService.cleanLocal(),this.timerLimitService.stopCountTimerLimit(),this.yaQuitoPedido=0)})}darFormatoGrupoPedidosRecibidos(e){e&&(this.sumAcumuladoPagar=e.importe_pagar,this.pedidoRepartidorService.loadPedidosRecibidos(e.pedidos.join(",")).subscribe(i=>{let t;const o=i.map(e=>(e.json_datos_delivery=JSON.parse(e.json_datos_delivery),t=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal),t=0===t?parseFloat(e.json_datos_delivery.p_subtotales[e.json_datos_delivery.p_subtotales.length-1].importe):t,e.importe_pagar_comercio=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal)-parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery),e.importe_pagar_comercio=2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago?0:e.importe_pagar_comercio,e));this.listPedidosGroup=JSON.parse(JSON.stringify(o)),this.pedidoRepartidorService.setLocalIds(e),this.pedidoRepartidorService.setLocalItems(this.listPedidosGroup),this.pedidoRepartidorService.playAudioNewPedido()}))}showPedidoExpress(){this.pedido_express=this.dataPedidos.pedidos}aceptaPedido(){this.socketService.emit("repartidor-acepta-pedido",this.dataPedidos),this.pedidoRepartidorService.pedidoRepartidor.aceptado||(this.positionNow=this.geoPositionService.get(),this.dataPedidos.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,this.dataPedidos.nombre=this.infoTokenService.infoUsToken.usuario.nombre,this.dataPedidos.apellido=this.infoTokenService.infoUsToken.usuario.apellido,this.dataPedidos.telefono=this.infoTokenService.infoUsToken.usuario.telefono,this.dataPedidos.position_now=this.positionNow,this.pedidoRepartidorService.pedidoRepartidor.aceptado=!0,this.pedidoRepartidorService.setLocal()),this.router.navigate(["./main/list-grupo-pedidos"])}clickTab(e){console.log("$event.index",e.index),this._tabIndex=e.index}recargarPedido(){location.reload()}goScanCodeBar(){localStorage.setItem("sys::count::p","0"),this.router.navigate(["./main/mapa-de-pedidos"])}pedidoExpressEntregado(e){console.log("finaliza el pedido"),e.quitar=!0,this.quitarPedidoExpress(e.idpedido_mandado),this.pedidoRepartidorService.finalizarPedidoExpress(e,this.dataPedidos)}quitarPedidoExpress(e){this.pedido_express=this.pedido_express.filter(i=>i.idpedido_mandado!==e),this.dataPedidos.pedidos=this.pedido_express,0===this.pedido_express.length&&(this.isExpress=!1,this.pedido_express=null,this.pedidoRepartidorService.cleanLocal())}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(d.a),p.Ob(g.a),p.Ob(f.a),p.Ob(s.b),p.Ob(l.a),p.Ob(F),p.Ob(r.a),p.Ob(c.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-pedidos"]],decls:20,vars:8,consts:[[1,"animated","fadeInDown"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"w-100"],["mat-stretch-tabs","",3,"selectedTabChange"],["label","Pendientes"],[1,"p-3","x-h-size"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[4,"ngIf"],["label","Entregados"],[1,"x-h-size"],[3,"tabIndex"],["class","text-center",4,"ngIf"],[1,"text-center"],["mat-stroked-button","",3,"click"],[1,"btn","btn-info",3,"click"],[3,"listPedidos","importeAcumuladoPagar","aceptaPedido"],["class","mb-3 animated fadeInDown",4,"ngFor","ngForOf"],[1,"mb-3","animated","fadeInDown"],[3,"elpedido","pedidoEntregado"]],template:function(e,i){if(1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div"),p.Ub(3,"span"),p.Ec(4,"Efectivo en mano"),p.Tb(),p.Tb(),p.Ub(5,"div"),p.Ub(6,"span"),p.Ec(7),p.hc(8,"number"),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Ub(9,"div",2),p.Ub(10,"mat-tab-group",3),p.cc("selectedTabChange",(function(e){return i.clickTab(e)})),p.Ub(11,"mat-tab",4),p.Ub(12,"div",5),p.Cc(13,oe,2,1,"ng-container",6),p.Cc(14,se,2,2,"ng-template",null,7,p.Dc),p.Cc(16,ne,2,1,"div",8),p.Tb(),p.Tb(),p.Ub(17,"mat-tab",9),p.Ub(18,"div",10),p.Pb(19,"app-pedidos-atendidos",11),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e){const e=p.vc(15);p.Cb(7),p.Gc("S/. ",p.jc(8,5,i.efectivoMano,".2"),""),p.Cb(6),p.mc("ngIf",0===i.listPedidosGroup.length)("ngIfElse",e),p.Cb(3),p.mc("ngIf",i.isExpress),p.Cb(3),p.mc("tabIndex",i._tabIndex)}},directives:[$.b,$.a,o.m,z,u.a,K,o.l,ie],pipes:[o.e],styles:[".x-h-size[_ngcontent-%COMP%]{height:calc(100vh - 155px)}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}.btn-footer[_ngcontent-%COMP%]{padding:15px;display:flex;justify-content:center;align-items:center}"]}),e})();var de=t("VhxH");let ce=(()=>{class e{constructor(){this.directionsService=new google.maps.DirectionsService,this.origin={},this.destination={}}calculateRoute(e,i){let t=i.c_minimo;const o=i.c_km;this.origin={lat:e.latitude,lng:e.longitude},this.destination={lat:i.latitude,lng:i.longitude};const s={origin:this.origin,destination:this.destination,travelMode:google.maps.TravelMode.DRIVING};let a=0;return this.directionsService.route(s,(e,s)=>{"OK"===s&&(a=e.routes[0].legs[0].distance.value,a=parseInt((a/1e3).toFixed(),0),a>1&&(t=(a-1)*o+t,i.c_servicio=t))}),setTimeout(()=>(i.c_servicio=t,t),500),i.c_servicio=t,t}calcDistancia(e,i,t=100){i.latitude="string"==typeof i.latitude?parseFloat(i.latitude):i.latitude,i.longitude="string"==typeof i.longitude?parseFloat(i.longitude):i.longitude;const o={lat:i.latitude,lon:i.longitude};return Object(de.insideCircle)({lat:e.latitude,lon:e.longitude},o,t)}reglaKm(){}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=p.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var le=t("IW2O");class pe{}var be=t("ojS6");function he(e,i){if(1&e&&(p.Ub(0,"div"),p.Ub(1,"span",5),p.Ec(2),p.Tb(),p.Tb()),2&e){const e=p.gc(2);p.Cb(2),p.Gc(" ",e.dataCalificado.titulo," ")}}function ue(e,i){if(1&e&&(p.Ub(0,"div"),p.Ub(1,"span",6),p.Ec(2),p.Tb(),p.Pb(3,"br"),p.Pb(4,"br"),p.Tb()),2&e){const e=p.gc(2);p.Cb(2),p.Fc(e.dataCalificado.nombre)}}function me(e,i){if(1&e){const e=p.Vb();p.Sb(0),p.Ub(1,"div",2),p.Cc(2,he,3,1,"div",3),p.Cc(3,ue,5,1,"div",3),p.Tb(),p.Ub(4,"star-rating",4),p.cc("ratingChange",(function(i){return p.wc(e),p.gc().onRatingChange(i)})),p.Tb(),p.Rb()}if(2&e){const e=p.gc();p.Cb(2),p.mc("ngIf",e.dataCalificado.showTitulo),p.Cb(1),p.mc("ngIf",e.dataCalificado.showNombre),p.Cb(1),p.mc("starType","svg")}}function ge(e,i){1&e&&(p.Ub(0,"div",7),p.Ub(1,"span"),p.Ec(2," Muchas gracias, su calificaci\xf3n se tomara en cuenta."),p.Tb(),p.Pb(3,"hr"),p.Ub(4,"button",8),p.Ec(5,"Ok"),p.Tb(),p.Tb())}let fe=(()=>{class e{constructor(e){this.crudService=e,this.countFin=2,this.intervalConteo=null}ngOnInit(){}onRatingChange(e){console.log("calificacion",e),this.dataCalificado.calificacion=e.rating,this.dataCalificado.showMsjTankyou&&(this.countFin=2,this.cuentaRegresivaCalificacion())}cuentaRegresivaCalificacion(){this.countFin<=0?(this.intervalConteo=null,this.guardarCalificacion()):this.conteoFinEncuesta()}conteoFinEncuesta(){this.intervalConteo=setTimeout(()=>{this.countFin--,this.cuentaRegresivaCalificacion()},1e3)}guardarCalificacion(){this.crudService.postFree({dataCalificacion:this.dataCalificado},"delivery","calificar-servicio",!1).subscribe(e=>console.log(e))}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(N.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-comp-calificacion"]],inputs:{dataCalificado:"dataCalificado"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["msjAgradece",""],[1,"text-center"],[4,"ngIf"],["size","large","speed","slow",3,"starType","ratingChange"],[1,"fw-600","fs-13","text-secondary"],[1,"fs-15"],[1,"text-center","fs-18","fw-100"],["mat-flat-button","","color","primary","mat-dialog-close",""]],template:function(e,i){if(1&e&&(p.Cc(0,me,5,3,"ng-container",0),p.Cc(1,ge,6,0,"ng-template",null,1,p.Dc)),2&e){const e=p.vc(2);p.mc("ngIf",i.countFin>0)("ngIfElse",e)}},directives:[o.m,be.a,u.a,a.d],styles:[""]}),e})(),ve=(()=>{class e{constructor(e){this._dataCalificado=e.dataCalificado}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-dialog-calificacion"]],decls:2,vars:1,consts:[[1,"p-2"],[3,"dataCalificado"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Pb(1,"app-comp-calificacion",1),p.Tb()),2&e&&(p.Cb(1),p.mc("dataCalificado",i._dataCalificado))},directives:[fe],styles:[""]}),e})();var Pe=t("+XMS"),Ce=t("pxUr");const Te=function(){return{height:25,width:25}},_e=function(e){return{url:"./assets/images/delivery-man.png",scaledSize:e}};function ye(e,i){if(1&e&&p.Pb(0,"agm-marker",4),2&e){const e=p.gc(2);p.mc("latitude",e.miPosition.lat)("longitude",e.miPosition.lng)("label",e.Repartidor)("iconUrl",p.rc(5,_e,p.qc(4,Te)))}}function Se(e,i){if(1&e&&(p.Ub(0,"agm-map",1),p.Pb(1,"agm-marker",2),p.Cc(2,ye,1,7,"agm-marker",3),p.Tb()),2&e){const e=p.gc();p.mc("latitude",e.coordenadas.latitude)("longitude",e.coordenadas.longitude)("zoom",e.coordenadas.zoom),p.Cb(1),p.mc("latitude",e.coordenadas.latitude)("longitude",e.coordenadas.longitude)("markerDraggable",!1),p.Cb(1),p.mc("ngIf",e.miPosition)}}let Ue=(()=>{class e{constructor(e,i,t,o,s){this.mapsAPILoader=e,this.socketService=i,this.pedidoRepartidorService=t,this.repartidorService=o,this.geoUbicationService=s,this.bounds=null}ngOnInit(){this.coordenadas.zoom=15,console.log("mapa solo",this.coordenadas),this.idSedeDesarrollo=this.pedidoRepartidorService.pedidoRepartidor.datosComercio.idsede,this.geoUbicationService.onGeoPosition(),this.miPosition=this.geoUbicationService.geoPosition,this.miPosition={lat:this.miPosition.latitude,lng:this.miPosition.longitude},this.listenUbicaion()}markerDragEnd(e){const i={latitude:e.coords.lat,longitude:e.coords.lng};this.geoUbicationService.geoPosition=i,this.repartidorService.emitPositionNow(i,this.pedidoRepartidorService.pedidoRepartidor,this.idSedeDesarrollo)}listenUbicaion(){this.geoUbicationService.onGeoWatchPosition(),this.geoUbicationService.geoPositionNow$.subscribe(e=>{this.miPosition={lat:e.latitude,lng:e.longitude};const i=new Pe.a;i.latitude=this.miPosition.lat,i.longitude=this.miPosition.lng,this.geoUbicationService.geoPosition=i,this.geoUbicationService.set(),this.repartidorService.emitPositionNow(this.miPosition,this.pedidoRepartidorService.pedidoRepartidor,this.idSedeDesarrollo)})}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(Ce.d),p.Ob(g.a),p.Ob(f.a),p.Ob(c.a),p.Ob(r.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-mapa-solo"]],inputs:{coordenadas:"coordenadas"},decls:1,vars:1,consts:[[3,"latitude","longitude","zoom",4,"ngIf"],[3,"latitude","longitude","zoom"],[3,"latitude","longitude","markerDraggable"],[3,"latitude","longitude","label","iconUrl",4,"ngIf"],[3,"latitude","longitude","label","iconUrl"]],template:function(e,i){1&e&&p.Cc(0,Se,3,7,"agm-map",0),2&e&&p.mc("ngIf",i.coordenadas)},directives:[o.m,Ce.b,Ce.c],styles:["agm-map[_ngcontent-%COMP%]{height:200px}"]}),e})();function we(e,i){1&e&&(p.Ub(0,"div"),p.Pb(1,"hr"),p.Ub(2,"p",19),p.Ec(3,"Ver detalle del pedido."),p.Tb(),p.Tb())}function Re(e,i){if(1&e&&(p.Ub(0,"p",9),p.Ub(1,"span",14),p.Ec(2,"Referencia: "),p.Tb(),p.Ec(3),p.Tb()),2&e){const e=p.gc();p.Cb(3),p.Gc(" ",e.dataPedido.datosDelivery.referencia,"")}}function ke(e,i){if(1&e&&(p.Ub(0,"div",9),p.Ub(1,"p"),p.Ub(2,"span",14),p.Ec(3,"Importe a cobrar: "),p.Tb(),p.Ec(4),p.hc(5,"number"),p.Tb(),p.Ub(6,"p"),p.Ub(7,"span",14),p.Ec(8,"Cliente paga con: "),p.Tb(),p.Ec(9),p.Tb(),p.Tb()),2&e){const e=p.gc();p.Cb(4),p.Gc(" S/. ",p.jc(5,2,e.importeEfectivoPedido,".2"),""),p.Cb(5),p.Gc(" ",e.dataPedido.datosDelivery.paga_con,"")}}function De(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div"),p.Pb(1,"hr"),p.Ub(2,"div",20),p.Ub(3,"div",21),p.cc("click",(function(){return p.wc(e),p.gc().callPhone()})),p.Pb(4,"i",22),p.Ec(5," LLamar"),p.Tb(),p.Ub(6,"div",23),p.cc("click",(function(){return p.wc(e),p.gc().redirectWhatsApp()})),p.Pb(7,"i",24),p.Ec(8," Enviar Mensaje"),p.Tb(),p.Tb(),p.Tb()}}const Ee=function(e){return{success:e}},xe=function(e,i){return{active:e,success:i}};let Ie=(()=>{class e{constructor(e,i,t,o,s,a,n,r,d,c){this.pedidoRepartidorService=e,this.repartidorService=i,this.geoPositionService=t,this.calcDistanciaService=o,this.router=s,this.socketService=a,this.infoTokenService=n,this.dialog=r,this.timerService=d,this.listenService=c,this.coordenadasDestino={},this.importeEfectivoPedido=0,this.btnTitlePasos="Empezar",this.btnIsVisible=!0,this.btnTerminarVisible=!1,this._desAccionComprar="RECOGER",this.radioUbicacionActiva=60,this.destroy$=new v.Subject}ngOnInit(){this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor,this.pedidoRepartidorService.verificarEstadoPedido(this.pedidoRepartidorService.pedidoRepartidor.idpedido).subscribe(e=>{this.dataPedido.estado=e,this.pedidoRepartidorService.setLocal(),this.loadInit()}),this.idClienteNotifyPos=this.dataPedido.datosCliente.idcliente,this.idSedeNotifiPos=this.dataPedido.datosComercio.idsede,this.dataPedido.datosDelivery.paga_con=this.dataPedido.datosDelivery.paga_con.replace("undefined",""),this._desAccionComprar=0===this.dataPedido.datosComercio.pwa_delivery_comision_fija_no_afiliado?"RECOGER":"COMPRAR"}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}loadInit(){switch(this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor,"4"===this.dataPedido.estado.toString()&&(this.btnTerminarVisible=!0,this.dataPedido.paso_va=4,this.pedidoRepartidorService.setPasoVa(4)),this.dataPedido.datosDelivery.metodoPago.idtipo_pago){case 1:this.descripcionPago=`Pagar S/. ${parseFloat(this.dataPedido.importePedido).toFixed(2)}`,this.importeEfectivoPedido=parseFloat(this.dataPedido.importePagaCliente);break;case 2:this.descripcionPago="El pedido ya esta pagado, solo entregar.";break;case 3:this.descripcionPago=`Pagar S/. ${parseFloat(this.dataPedido.importePedido).toFixed(2)}`,this.importeEfectivoPedido=parseFloat(this.dataPedido.importePagaCliente)}this.showPasos(),setTimeout(()=>{this.listenGeoPosition()},600)}listenGeoPosition(){this.geoPositionActual=this.geoPositionService.geoPosition,this.listenService.myPosition$.pipe(Object(le.takeUntil)(this.destroy$)).subscribe(e=>{(e=(null==e?void 0:e.latitude)?e:this.geoPositionActual).latitude&&(this.geoPositionActual=e,!!this.coordenadasDestino.latitude&&this.calcDistanciaService.calcDistancia(this.geoPositionActual,this.coordenadasDestino,this.radioUbicacionActiva)&&1===this.dataPedido.paso_va&&(this.dataPedido.paso_va=2,this.pedidoRepartidorService.setPasoVa(2),this.showPasos()),3===this.dataPedido.paso_va&&(this.dataPedido.paso_va=4,this.pedidoRepartidorService.setPasoVa(4),this.showPasos()))}),this.socketService.onDeliveryPedidoFin().pipe(Object(le.takeUntil)(this.destroy$)).subscribe(e=>{this.openDialogCalificacion()})}openDialogCalificacion(){var e;if(!(null===(e=this.dataPedido)||void 0===e?void 0:e.idpedido))return;const i=new pe;i.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,i.idcliente=this.dataPedido.datosCliente.idcliente,i.idpedido=this.dataPedido.idpedido,i.tipo=2,i.showNombre=!0,i.nombre=this.dataPedido.datosDelivery.nombre,i.titulo="Como calificas al cliente?",i.showTitulo=!0,i.showMsjTankyou=!0;const t=new a.e;t.disableClose=!0,t.hasBackdrop=!0,t.data={dataCalificado:i},this.dialog.open(ve,t).afterClosed().subscribe(e=>{this.timerService.stopCountTimerLimit(),this.pedidoRepartidorService.finalizarPedido()})}showPasos(){switch(this.dataPedido.paso_va=this.dataPedido.paso_va?this.dataPedido.paso_va:1,this.dataPedido.paso_va){case 1:this.coordenadasDestino.latitude=this.dataPedido.datosComercio.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosComercio.longitude,this.btnTitlePasos="Empezar",this.radioUbicacionActiva=350;break;case 2:case 3:this.btnIsVisible=!0,this.coordenadasDestino.latitude=this.dataPedido.datosCliente.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosCliente.longitude,this.btnTitlePasos="Paso 3 Empezar",this.radioUbicacionActiva=350;break;case 4:this.btnIsVisible=!0,this.coordenadasDestino.latitude=this.dataPedido.datosCliente.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosCliente.longitude,this.radioUbicacionActiva=350,this.btnTitlePasos="Entregado, terminar.";break;default:this.coordenadasDestino.latitude=this.dataPedido.datosCliente.latitude,this.coordenadasDestino.longitude=this.dataPedido.datosCliente.longitude}}btnEjecutar(){let e="";switch(this.dataPedido.paso_va){case 1:e=`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.coordenadasDestino.latitude},${this.coordenadasDestino.longitude}`,window.open(e,"_blank"),this.btnIsVisible=!1;break;case 2:case 3:e=`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.coordenadasDestino.latitude},${this.coordenadasDestino.longitude}`,window.open(e,"_blank"),this.btnIsVisible=!1,this.dataPedido.paso_va=3,this.pedidoRepartidorService.setPasoVa(3);break;case 4:this.openDialogCalificacion()}this.socketEmitEstadoPedido(this.dataPedido.paso_va)}showDetallePedido(){this.dataPedido.paso_va>=2&&this.router.navigate(["./main/pedido-detalle"])}redirectWhatsApp(){window.open(`https://api.whatsapp.com/send?phone=51${this.dataPedido.datosDelivery.telefono}`,"_blank")}callPhone(){window.open(`tel:${this.dataPedido.datosDelivery.telefono}`)}socketEmitEstadoPedido(e){this.socketService.emit("repartidor-notifica-estado-pedido",{idcliente:this.dataPedido.datosCliente.idcliente,idpedido:this.dataPedido.idpedido,estado:e})}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(f.a),p.Ob(c.a),p.Ob(r.a),p.Ob(ce),p.Ob(s.b),p.Ob(g.a),p.Ob(d.a),p.Ob(a.b),p.Ob(F),p.Ob(l.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-indicaciones-pedido"]],decls:56,vars:28,consts:[[1,"animated","fadeInDown","container-body"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"border"],[3,"coordenadas"],[1,"p-3"],[1,"item-paso","d-flex","active",3,"ngClass"],[1,"num"],[1,"instrunccion","p-2","fs-13"],[1,"text-secondary","fw-600","fs-12"],[1,"fw-100"],["matRipple","",1,"item-paso","d-flex",3,"ngClass","click"],[1,"fw-600","fs-12"],[1,"fw-600","fs-15","text-dark"],[1,"text-secondary"],[1,"fw-600"],[4,"ngIf"],[1,"item-paso","d-flex",3,"ngClass"],["class","fw-100",4,"ngIf"],["matRipple","",1,"xfooter","bg-success","w-100","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"hidden","click"],[1,"text-info"],[1,"row","text-center"],["matRipple","",1,"col-6","border-right","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-phone"],["matRipple","",1,"col-6","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-commenting-o"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div"),p.Ub(3,"span"),p.Ec(4,"Pasos para entregar el pedido"),p.Tb(),p.Tb(),p.Ub(5,"div"),p.Ub(6,"span"),p.Ec(7),p.Tb(),p.Tb(),p.Tb(),p.Ub(8,"div",2),p.Pb(9,"app-mapa-solo",3),p.Tb(),p.Ub(10,"div",4),p.Ub(11,"div",5),p.Ub(12,"div",6),p.Ec(13,"1"),p.Tb(),p.Ub(14,"div",7),p.Ub(15,"p",8),p.Ec(16,"Dirigirse al comercio:"),p.Tb(),p.Ub(17,"p",9),p.Ec(18),p.Tb(),p.Ub(19,"p",9),p.Ec(20),p.Tb(),p.Tb(),p.Tb(),p.Ub(21,"div",10),p.cc("click",(function(){return i.showDetallePedido()})),p.Ub(22,"div",6),p.Ec(23,"2"),p.Tb(),p.Ub(24,"div",7),p.Ub(25,"p",11),p.Ub(26,"span",12),p.Ec(27),p.Tb(),p.Ub(28,"span",13),p.Ec(29),p.Tb(),p.Tb(),p.Ub(30,"p",14),p.Ec(31),p.Tb(),p.Ub(32,"p",9),p.Ec(33,"Pedir comprobante."),p.Tb(),p.Cc(34,we,4,0,"div",15),p.Tb(),p.Tb(),p.Ub(35,"div",16),p.Ub(36,"div",6),p.Ec(37,"3"),p.Tb(),p.Ub(38,"div",7),p.Ub(39,"p",8),p.Ec(40,"Entregar Pedido:"),p.Tb(),p.Ub(41,"p",9),p.Ub(42,"span",14),p.Ec(43,"En: "),p.Tb(),p.Ec(44),p.Tb(),p.Cc(45,Re,4,1,"p",17),p.Ub(46,"p",9),p.Ub(47,"span",14),p.Ec(48,"A: "),p.Tb(),p.Ec(49),p.hc(50,"titlecase"),p.Tb(),p.Cc(51,ke,10,5,"div",17),p.Cc(52,De,9,0,"div",15),p.Tb(),p.Tb(),p.Tb(),p.Ub(53,"div",18),p.cc("click",(function(){return i.btnEjecutar()})),p.Ub(54,"span"),p.Ec(55),p.Tb(),p.Tb(),p.Tb()),2&e&&(p.Cb(7),p.Gc("#",i.dataPedido.idpedido,""),p.Cb(2),p.mc("coordenadas",i.coordenadasDestino),p.Cb(2),p.mc("ngClass",p.rc(20,Ee,i.dataPedido.paso_va>1)),p.Cb(7),p.Fc(i.dataPedido.datosComercio.nombre),p.Cb(2),p.Fc(i.dataPedido.datosComercio.direccion),p.Cb(1),p.mc("ngClass",p.sc(22,xe,2===i.dataPedido.paso_va,i.dataPedido.paso_va>2)),p.Cb(6),p.Fc(i._desAccionComprar),p.Cb(2),p.Gc(" el pedido #",i.dataPedido.idpedido,": "),p.Cb(2),p.Fc(i.descripcionPago),p.Cb(3),p.mc("ngIf",i.dataPedido.paso_va>=2),p.Cb(1),p.mc("ngClass",p.sc(25,xe,3===i.dataPedido.paso_va,i.dataPedido.paso_va>3)),p.Cb(9),p.Gc(" ",i.dataPedido.datosDelivery.direccion,""),p.Cb(1),p.mc("ngIf",i.dataPedido.datosDelivery.referencia),p.Cb(4),p.Gc(" ",p.ic(50,18,i.dataPedido.datosDelivery.nombre),""),p.Cb(2),p.mc("ngIf",i.dataPedido.datosDelivery.metodoPago.idtipo_pago),p.Cb(1),p.mc("ngIf",i.dataPedido.paso_va>=3),p.Cb(1),p.mc("hidden",!i.btnIsVisible),p.Cb(2),p.Fc(i.btnTitlePasos))},directives:[Ue,o.k,I.e,o.m],pipes:[o.u,o.e],styles:[".container-body[_ngcontent-%COMP%]{padding-bottom:3.5rem}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%;padding:14px}.item-paso[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:5px;margin-bottom:5px;background-color:#eee;opacity:.6}.item-paso[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.item-paso[_ngcontent-%COMP%]   .num[_ngcontent-%COMP%]{padding:10px;font-size:23px;font-weight:600;line-height:2em;background:#e0e0e0;border-right:1px solid #d3d3d3;border-radius:4px 0 0 4px}.item-paso[_ngcontent-%COMP%]   .instrunccion[_ngcontent-%COMP%]{width:100%;padding:10px}.item-paso.success[_ngcontent-%COMP%]{border-color:#bdbdbd!important;opacity:1}.item-paso.success[_ngcontent-%COMP%]   .num[_ngcontent-%COMP%]{background:#00b14f}.item-paso.success[_ngcontent-%COMP%]   .instrunccion[_ngcontent-%COMP%]{background:#e0e0e0}.item-paso.active[_ngcontent-%COMP%]{opacity:1;border-color:#f9a825}"]}),e})();var Oe=t("NEqF");let je=(()=>{class e{constructor(e){this.url_img=Oe.d,this.itemProducto=e.item}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-dialog-img-item"]],decls:11,vars:5,consts:[[1,"w-100"],[1,"img-thumbnail","w-100",3,"src","alt"],[1,"text-center","fs-13","pt-2"],[1,"text-center"],["mat-flat-button","","color","primary","mat-dialog-close",""]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Pb(1,"img",1),p.Tb(),p.Ub(2,"div",2),p.Ub(3,"p"),p.Ec(4),p.Tb(),p.Ub(5,"p"),p.Ec(6),p.Tb(),p.Tb(),p.Pb(7,"hr"),p.Ub(8,"div",3),p.Ub(9,"button",4),p.Ec(10,"Cerrar"),p.Tb(),p.Tb()),2&e&&(p.Cb(1),p.pc("src","",i.url_img,"",i.itemProducto.img,"",p.xc),p.nc("alt",i.itemProducto.img),p.Cb(3),p.Fc(i.itemProducto.des),p.Cb(2),p.Gc("Cantidad: ",i.itemProducto.cantidad_seleccionada,""))},directives:[u.a,a.d],styles:["p[_ngcontent-%COMP%]{margin:0}"]}),e})();function Ae(e,i){if(1&e&&(p.Ub(0,"li",20),p.Ub(1,"div",21),p.Ec(2),p.hc(3,"number"),p.Tb(),p.Ub(4,"div",22),p.Ec(5),p.hc(6,"number"),p.Tb(),p.Tb()),2&e){const e=i.$implicit,t=p.gc(9);p.mc("matRippleColor",t.rippleColorSubItem),p.Cb(2),p.Hc(" ",p.jc(3,5,e.cantidad_seleccionada,"2.")," ",e.des," "),p.Cb(2),p.mc("hidden",0===e.precio),p.Cb(1),p.Gc(" + ",p.jc(6,8,e.precio,"0.2")," ")}}function Le(e,i){if(1&e&&(p.Sb(0),p.Ub(1,"div"),p.Ub(2,"ul",13),p.Cc(3,Ae,7,11,"li",19),p.Tb(),p.Tb(),p.Rb()),2&e){const e=p.gc(2).$implicit;p.Cb(3),p.mc("ngForOf",e.subitems_view)}}function Me(e,i){if(1&e){const e=p.Vb();p.Sb(0),p.Ub(1,"li",14),p.cc("click",(function(){p.wc(e);const i=p.gc().$implicit;return p.gc(6).showImg(i)})),p.Ub(2,"div",15),p.Ec(3),p.hc(4,"number"),p.Tb(),p.Ub(5,"div",16),p.Ec(6),p.hc(7,"lowercase"),p.Ub(8,"span",17),p.Ec(9),p.Tb(),p.Tb(),p.Ub(10,"div",18),p.Ec(11),p.hc(12,"number"),p.Tb(),p.Tb(),p.Cc(13,Le,4,1,"ng-container",7),p.Rb()}if(2&e){const e=p.gc().$implicit,i=p.gc(6);p.Cb(1),p.mc("matRippleColor",i.rippleColor),p.Cb(2),p.Fc(p.jc(4,7,e.cantidad_seleccionada,"2.")),p.Cb(3),p.Gc("",p.ic(7,10,e.des)," "),p.Cb(2),p.mc("hidden",!e.indicaciones),p.Cb(1),p.Gc("( ",e.indicaciones," )"),p.Cb(2),p.Fc(p.jc(12,12,e.precio_print,"0.2")),p.Cb(2),p.mc("ngIf",e.subitems_view)}}function Fe(e,i){if(1&e&&(p.Ub(0,"div"),p.Cc(1,Me,14,15,"ng-container",7),p.Tb()),2&e){const e=i.$implicit;p.Cb(1),p.mc("ngIf",e.cantidad_seleccionada>0)}}function Ge(e,i){if(1&e&&(p.Sb(0),p.Ub(1,"div",11),p.Ub(2,"span"),p.Ec(3),p.hc(4,"titlecase"),p.Tb(),p.Ub(5,"div",12),p.Ec(6),p.Tb(),p.Tb(),p.Ub(7,"ul",13),p.Cc(8,Fe,2,1,"div",10),p.Tb(),p.Rb()),2&e){const e=p.gc().$implicit;p.Cb(3),p.Fc(p.ic(4,3,e.des)),p.Cb(3),p.Fc(e.count_items),p.Cb(2),p.mc("ngForOf",e.items)}}function $e(e,i){if(1&e&&(p.Ub(0,"div"),p.Cc(1,Ge,9,5,"ng-container",7),p.Tb()),2&e){const e=i.$implicit;p.Cb(1),p.mc("ngIf",e.count_items>0)}}function Ne(e,i){if(1&e&&(p.Sb(0),p.Ub(1,"div",8),p.Ub(2,"span"),p.Ec(3,"Detalle del pedido"),p.Tb(),p.Ub(4,"div",9),p.Ec(5),p.Tb(),p.Tb(),p.Cc(6,$e,2,1,"div",10),p.Rb()),2&e){const e=p.gc().$implicit;p.Cb(5),p.Fc(e.count_items_seccion),p.Cb(1),p.mc("ngForOf",e.secciones)}}function Ve(e,i){if(1&e&&(p.Ub(0,"div",6),p.Cc(1,Ne,7,2,"ng-container",7),p.Tb()),2&e){const e=i.$implicit;p.Cb(1),p.mc("ngIf",e.count_items_seccion>0)}}function ze(e,i){if(1&e&&(p.Ub(0,"li",23),p.Ub(1,"div",13),p.Ec(2),p.hc(3,"titlecase"),p.Tb(),p.Ub(4,"div"),p.Ec(5),p.hc(6,"number"),p.Tb(),p.Tb()),2&e){const e=i.$implicit,t=p.gc(2);p.mc("matRippleColor",t.rippleColor),p.Cb(2),p.Fc(p.ic(3,3,e.descripcion)),p.Cb(3),p.Fc(p.jc(6,5,e.importe,"0.2"))}}function He(e,i){if(1&e&&(p.Ub(0,"div",1),p.Cc(1,Ve,2,1,"div",2),p.Ub(2,"div",3),p.Ub(3,"ul",4),p.Cc(4,ze,7,8,"li",5),p.Tb(),p.Tb(),p.Tb()),2&e){const e=p.gc();p.Cb(1),p.mc("ngForOf",e._miPedido.tipoconsumo),p.Cb(3),p.mc("ngForOf",e._arrSubtotales)}}let Be=(()=>{class e{constructor(e,i,t){this.crudService=e,this.pedidoRepartidorService=i,this.dialog=t,this.showAllSubtotal=!0}ngOnInit(){this.loadPedido()}loadPedido(){console.log("ini service pedido");const e=!!this.pedidoRepartidorService.getPedidoSelect(),i=this.pedidoRepartidorService.getPedidoSelect()||this.pedidoRepartidorService.pedidoRepartidor,t=e?i.json_datos_delivery.p_body:this.pedidoRepartidorService.pedidoRepartidor.datosItems,o=e?this.pedidoRepartidorService.darFormatoSubTotales(i.json_datos_delivery.p_header.arrDatosDelivery.subTotales,e?i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.pwa_delivery_comercio_paga_entrega:null,e?i.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery:null):this.pedidoRepartidorService.pedidoRepartidor.datosSubtotalesShow;this._miPedido=this.pedidoRepartidorService.darFormatoPedidoLocal(t,o),this._arrSubtotales=this.showAllSubtotal?e?i.json_datos_delivery.p_subtotales:this.pedidoRepartidorService.pedidoRepartidor.datosSubtotalesShow:o}showImg(e){if(!e.img||""===e.img)return;const i=new a.e;i.disableClose=!0,i.hasBackdrop=!0,i.data={item:e},this.dialog.open(je,i)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(N.a),p.Ob(f.a),p.Ob(a.b))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-comp-pedido-detalle"]],inputs:{infoPedido:"infoPedido",showAllSubtotal:"showAllSubtotal"},decls:1,vars:1,consts:[["class","w-100 div-resumen-pedido",4,"ngIf"],[1,"w-100","div-resumen-pedido"],["class","xCursor",4,"ngFor","ngForOf"],[1,"div-total"],[1,"w-100","ul-total"],["class","d-flex div-plr li-item","matRipple","",3,"matRippleColor",4,"ngFor","ngForOf"],[1,"xCursor"],[4,"ngIf"],[1,"div-plr","titulo-tpc"],[1,"countItem","countTpc"],[4,"ngFor","ngForOf"],[1,"div-plr","titulo-seccion"],[1,"countItem","countSeccion"],[1,"w-100"],["matRipple","",1,"d-flex","div-plr","li-item",3,"matRippleColor","click"],[1,"pr-2","fw-100"],[1,"w-100","fw-100"],[3,"hidden"],[1,"fw-100"],["class","d-flex div-plr li-item fw-100 fs-12 text-secondary subitem-content-resumen","matRipple","",3,"matRippleColor",4,"ngFor","ngForOf"],["matRipple","",1,"d-flex","div-plr","li-item","fw-100","fs-12","text-secondary","subitem-content-resumen",3,"matRippleColor"],[1,"d-flex","w-100","pl-4"],[1,"fs-11","text-right",2,"width","45px",3,"hidden"],["matRipple","",1,"d-flex","div-plr","li-item",3,"matRippleColor"]],template:function(e,i){1&e&&p.Cc(0,He,5,2,"div",0),2&e&&p.mc("ngIf",i._miPedido)},directives:[o.m,o.l,I.e],pipes:[o.u,o.e,o.j],styles:[".div-plr[_ngcontent-%COMP%]{padding-left:7px;padding-right:7px}.div-content-all[_ngcontent-%COMP%]{top:0;position:-webkit-sticky;position:sticky}.titulo-tpc[_ngcontent-%COMP%]{background:#424242;color:#e0e0e0}.titulo-seccion[_ngcontent-%COMP%], .titulo-tpc[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}.titulo-seccion[_ngcontent-%COMP%]{background:#ffebcd}.li-item[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px;border-top:1px solid #e0e0e0}.div-total[_ngcontent-%COMP%]{border-top:2px dashed #9e9e9e}.ul-total[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{font-size:20px;font-weight:800}.countItem[_ngcontent-%COMP%]{padding:4px 7px;border-radius:90%;line-height:1;font-size:12px;margin-top:2px}.countTpc[_ngcontent-%COMP%]{float:right;background:#212121;color:#bdbdbd}.countSeccion[_ngcontent-%COMP%]{float:right;color:#616161;background:#ffcc80}"]}),e})(),We=(()=>{class e{constructor(e,i,t){this.repartidorPedidoService=e,this.infoTokenService=i,this.router=t,this.infoPedido={},this.indicacionesComprobante="",this.comprobanteSolicitar=""}ngOnInit(){let e="",i="";const t=this.repartidorPedidoService.getPedidoSelect();if(t){this.infoPedido=t;const o=t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni?t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni:"";return e=""===o?"":o.length>8?"RUC ":"DNI ",i=t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro?t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro:"",this.indicacionesComprobante=""===o?"Publico en general.":e+" "+o+" - "+i,void(this.comprobanteSolicitar=t.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.descripcion)}this.infoPedido=this.repartidorPedidoService.pedidoRepartidor,this.infoPedido.idpedido=this.repartidorPedidoService.pedidoRepartidor.idpedido,this.infoPedido.idsede=this.repartidorPedidoService.pedidoRepartidor.datosComercio.idsede,this.infoPedido.idorg=this.repartidorPedidoService.pedidoRepartidor.datosComercio.idorg,this.infoPedido.datosDelivery.tipoComprobante.dni=this.infoPedido.datosDelivery.tipoComprobante.dni?this.infoPedido.datosDelivery.tipoComprobante.dni:"",e=""===this.infoPedido.datosDelivery.tipoComprobante.dni?"":this.infoPedido.datosDelivery.tipoComprobante.dni.length>8?"RUC ":"DNI ",i=this.infoPedido.datosDelivery.tipoComprobante.otro?this.infoPedido.datosDelivery.tipoComprobante.otro:"",this.indicacionesComprobante=""===this.infoPedido.datosDelivery.tipoComprobante.dni?"Publico en general.":e+" "+this.infoPedido.datosDelivery.tipoComprobante.dni+" - "+i}goBack(){this.router.navigate(["/main/list-grupo-pedidos"])}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(f.a),p.Ob(d.a),p.Ob(s.b))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-pedido-detalle"]],decls:18,vars:4,consts:[[1,"animated","fadeInRight"],[3,"infoPedido","showAllSubtotal"],[1,"xfooter","animated","fadeInUp","delay-0-5s"],[1,"p-2","div-comprobante"],[1,"fw-600"],[1,"fw-100"],["matRipple","",1,"bg-success","w-100","fs-20","text-white","p-3",3,"click"],[1,"fa","fa-arrow-left"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Pb(1,"app-comp-pedido-detalle",1),p.Pb(2,"hr"),p.Pb(3,"br"),p.Pb(4,"br"),p.Pb(5,"br"),p.Pb(6,"br"),p.Ub(7,"div",2),p.Ub(8,"div",3),p.Ub(9,"p"),p.Ub(10,"span",4),p.Ec(11),p.Tb(),p.Ub(12,"span",5),p.Ec(13),p.Tb(),p.Tb(),p.Tb(),p.Ub(14,"div",6),p.cc("click",(function(){return i.goBack()})),p.Ub(15,"span"),p.Pb(16,"i",7),p.Ec(17," Listo, regresar"),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e&&(p.Cb(1),p.mc("infoPedido",i.infoPedido)("showAllSubtotal",!1),p.Cb(10),p.Gc("Solicitar ",i.comprobanteSolicitar,": "),p.Cb(2),p.Fc(i.indicacionesComprobante))},directives:[Be,I.e],styles:[".div-comprobante[_ngcontent-%COMP%]{background:#d3d3d3}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}"]}),e})();function qe(e,i){1&e&&(p.Sb(0),p.Ub(1,"span",23),p.Ec(2,"Entregado"),p.Tb(),p.Rb())}function Ke(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",24),p.Pb(1,"hr"),p.Ub(2,"div",25),p.cc("click",(function(){return p.wc(e),p.gc().callPhone()})),p.Pb(3,"i",26),p.Ec(4," LLamar"),p.Tb(),p.Ub(5,"div",27),p.cc("click",(function(){return p.wc(e),p.gc().redirectWhatsApp()})),p.Pb(6,"i",28),p.Ec(7," Enviar Mensaje"),p.Tb(),p.Tb()}}function Je(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div"),p.Ub(1,"button",29),p.cc("click",(function(){return p.wc(e),p.gc().goDireccion()})),p.Ub(2,"span",21),p.Pb(3,"i",10),p.Ec(4," Ir a la direccion"),p.Tb(),p.Tb(),p.Pb(5,"hr"),p.Tb()}}let Ye=(()=>{class e{constructor(e,i,t,o){this.pedidoRepartidorService=e,this.geoPositionService=i,this.calcDistanciaService=t,this.socketService=o,this.closeWindow=new p.o(!1),this.coordenadasDestino={},this.geoPositionComercio=new Pe.a,this.isLlegoDestino=!1,this.importeEfectivo="",this.indicacionesComprobante="",this.comprobanteSolicitar=""}ngOnInit(){var e;console.log("la orden",this.orden),this.pedidoRepartidorService.darFormatoLocalPedidoRepartidorModel(this.orden),this.pedidoRepartidorService.setLocal(),this.geoPositionService.get(),this.geoPositionActual=this.geoPositionService.getGeoPosition(),this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor,this.importeEfectivo=(null===(e=this.dataPedido.datosDelivery.metodoPago)||void 0===e?void 0:e.importe)||"",this.coordenadasDestino={latitude:this.dataPedido.datosCliente.latitude,longitude:this.dataPedido.datosCliente.longitude};const i=this.orden.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.dni||"";this.indicacionesComprobante=""===i?"Publico en general.":(""===i?"":i.length>8?"RUC ":"DNI ")+" "+i+" - "+(this.orden.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.otro||""),this.comprobanteSolicitar=this.orden.json_datos_delivery.p_header.arrDatosDelivery.tipoComprobante.descripcion,this.isLlegoDestino=this.calcDistanciaService.calcDistancia(this.geoPositionActual,this.coordenadasDestino,120)}cerrarDetalles(e){e&&this.closeWindow.emit(e)}goDireccion(){window.open(`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.coordenadasDestino.latitude},${this.coordenadasDestino.longitude}`,"_blank"),setTimeout(()=>{this.cerrarDetalles(!0)},500)}redirectWhatsApp(){window.open(`https://api.whatsapp.com/send?phone=51${this.dataPedido.datosDelivery.telefono}`,"_blank")}irAlComercio(){this.geoPositionComercio.latitude="string"==typeof this.dataPedido.datosDelivery.establecimiento.latitude?parseFloat(this.dataPedido.datosDelivery.establecimiento.latitude):this.dataPedido.datosDelivery.establecimiento.latitude,this.geoPositionComercio.longitude="string"==typeof this.dataPedido.datosDelivery.establecimiento.longitude?parseFloat(this.dataPedido.datosDelivery.establecimiento.longitude):this.dataPedido.datosDelivery.establecimiento.longitude,window.open(`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.geoPositionComercio.latitude},${this.geoPositionComercio.longitude}`,"_blank")}callPhone(){window.open(`tel:${this.dataPedido.datosDelivery.telefono}`)}PedidoEntregado(){this.orden.pwa_estado="E",this.orden.estado=2,this.orden.isRepartidorRed?this.pedidoRepartidorService.finalizarPedido(!0):this.pedidoRepartidorService.finalizarPedidoPropioRepartidor(),setTimeout(()=>{this.cerrarDetalles(this.orden)},500)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(f.a),p.Ob(r.a),p.Ob(ce),p.Ob(g.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-comp-orden-detalle"]],inputs:{orden:"orden"},outputs:{closeWindow:"closeWindow"},decls:70,vars:14,consts:[[1,"animated","fadeIn"],[1,"d-flex","justify-content-between"],[1,"fw-600"],[4,"ngIf"],["type","button","mat-dialog-close","",1,"btn","btn-secondary"],[1,"fa","fa-close"],[1,"fs-13","fw-600","text-secondary"],[1,"row"],[1,"fs-13","col-6"],[1,"fa","fa-user"],[1,"fa","fa-map-marker"],[1,"col-6","w-100"],[1,"d-flex","justify-content-end"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fs-13"],[1,"fa","fa-phone"],[1,"pl-2"],[1,"fw-100"],["class","row text-center",4,"ngIf"],[1,"text-center"],[1,"btn","btn-success",2,"width","85%",3,"click"],[1,"fs-18"],[1,"fa","fa-thumbs-up"],[1,"fw-600","fs-15","text-success"],[1,"row","text-center"],["matRipple","",1,"col-6","border-right","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-phone"],["matRipple","",1,"col-6","text-info",3,"click"],["aria-hidden","true",1,"fa","fa-commenting-o"],[1,"btn","btn-info",2,"width","85%",3,"click"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div"),p.Ub(3,"p",2),p.Ec(4),p.Tb(),p.Cc(5,qe,3,0,"ng-container",3),p.Tb(),p.Ub(6,"div"),p.Ub(7,"button",4),p.Pb(8,"i",5),p.Tb(),p.Tb(),p.Tb(),p.Pb(9,"hr"),p.Ub(10,"div"),p.Ub(11,"span",6),p.Ec(12,"Comercio: "),p.Tb(),p.Ub(13,"div",7),p.Ub(14,"div",8),p.Ub(15,"p"),p.Pb(16,"i",9),p.Ec(17),p.Tb(),p.Ub(18,"p"),p.Pb(19,"i",10),p.Ec(20),p.Tb(),p.Tb(),p.Ub(21,"div",11),p.Ub(22,"div",12),p.Ub(23,"button",13),p.cc("click",(function(){return i.irAlComercio()})),p.Ec(24,"Ir al comercio"),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Pb(25,"hr"),p.Ub(26,"div"),p.Ub(27,"div",14),p.Ub(28,"span",6),p.Ec(29,"Cliente: "),p.Tb(),p.Ub(30,"p"),p.Pb(31,"i",9),p.Ec(32),p.Tb(),p.Ub(33,"p"),p.Pb(34,"i",10),p.Ec(35),p.Tb(),p.Ub(36,"p"),p.Pb(37,"i",10),p.Ec(38),p.Tb(),p.Ub(39,"p"),p.Pb(40,"i",15),p.Ec(41),p.Tb(),p.Pb(42,"hr"),p.Ub(43,"div"),p.Ub(44,"span",6),p.Ec(45,"Cliente paga con: "),p.Tb(),p.Ub(46,"p"),p.Ec(47),p.Ub(48,"span",16),p.Ec(49),p.Tb(),p.Tb(),p.Tb(),p.Pb(50,"hr"),p.Ub(51,"div"),p.Ub(52,"span",6),p.Ec(53,"Solicitar: "),p.Tb(),p.Ub(54,"p"),p.Ub(55,"span",2),p.Ec(56),p.Tb(),p.Ub(57,"span",17),p.Ec(58),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Pb(59,"hr"),p.Cc(60,Ke,8,0,"div",18),p.Tb(),p.Pb(61,"hr"),p.Pb(62,"app-comp-pedido-detalle"),p.Pb(63,"hr"),p.Ub(64,"div",19),p.Cc(65,Je,6,0,"div",3),p.Ub(66,"button",20),p.cc("click",(function(){return i.PedidoEntregado()})),p.Ub(67,"span",21),p.Pb(68,"i",22),p.Ec(69," Listo, Pedido Entregado"),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e&&(p.Cb(4),p.Gc("Pedido #",i.orden.idpedido,""),p.Cb(1),p.mc("ngIf","4"===i.orden.pwa_delivery_status),p.Cb(12),p.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.nombre,""),p.Cb(3),p.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.direccion,""),p.Cb(12),p.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.nombre,""),p.Cb(3),p.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.direccion,""),p.Cb(3),p.Gc(" Ref: ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.referencia,""),p.Cb(3),p.Gc(" ",i.orden.json_datos_delivery.p_header.arrDatosDelivery.telefono,""),p.Cb(6),p.Gc("",i.orden.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion," "),p.Cb(2),p.Fc(i.importeEfectivo),p.Cb(7),p.Gc("",i.comprobanteSolicitar,": "),p.Cb(2),p.Fc(i.indicacionesComprobante),p.Cb(2),p.mc("ngIf","4"!==i.orden.pwa_delivery_status),p.Cb(5),p.mc("ngIf",!i.isLlegoDestino))},directives:[o.m,a.d,Be,I.e],styles:["p[_ngcontent-%COMP%]{margin:0}"]}),e})(),Qe=(()=>{class e{constructor(e,i){this.dialogRef=e,this.laOrden=i.laOrden,console.log("orden desde dialog-orden-detalle",this.laOrden)}ngOnInit(){}cerrarDialog(e){e&&this.dialogRef.close(this.laOrden)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.g),p.Ob(a.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-dialog-orden-detalle"]],decls:1,vars:1,consts:[[3,"orden","closeWindow"]],template:function(e,i){1&e&&(p.Ub(0,"app-comp-orden-detalle",0),p.cc("closeWindow",(function(e){return i.cerrarDialog(e)})),p.Tb()),2&e&&p.mc("orden",i.laOrden)},directives:[Ye],styles:[""]}),e})(),Ze=(()=>{class e{constructor(){}primeraConMayusculas(e){return(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1)}reformatDate(e){const i=e.split("-");return i[2]+"/"+i[1]+"/"+i[0]}xTiempoTranscurridos_2(e){const i=this.xDevolverHora().split(":"),t=e.split(":"),o=new Date,s=new Date;null===t[2]&&(t[2]="00"),s.setHours(i[0],i[1],i[2]),o.setHours(t[0],t[1],t[2]);const a=Math.floor((s-o)/1e3),n=a%60,r=Math.floor(a/60),d=r%60,c=Math.floor(r/60);return this.xCeroIzq(c%24,2)+":"+this.xCeroIzq(d,2)+":"+this.xCeroIzq(n,2)}xTiempoTranscurridos_en_minutos(e){const i=this.xDevolverHora().split(":"),t=e.split(":"),o=new Date,s=new Date;null===t[2]&&(t[2]="00"),s.setHours(i[0],i[1],i[2]),o.setHours(t[0],t[1],t[2]);const a=Math.floor((s-o)/1e3),n=Math.floor(a/60),r=n%60,d=Math.floor(n/60);return this.xCeroIzq(d%24*60+r,2)}xDevolverHora(){const e=new Date;return this.xCeroIzq(e.getHours(),2)+":"+this.xCeroIzq(e.getMinutes(),2)+":"+this.xCeroIzq(e.getSeconds(),2)}xCeroIzq(e,i){for(e=e.toString();e.length<i;)e="0"+e;return e}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=p.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Xe=t("+0xr");function ei(e,i){if(1&e&&(p.Ub(0,"div",22),p.Ub(1,"span",23),p.Ec(2),p.Tb(),p.Tb()),2&e){const e=p.gc(4);p.Cb(2),p.Fc(e.msjErrorCodDelivery)}}function ii(e,i){if(1&e){const e=p.Vb();p.Sb(0),p.Ub(1,"button",24),p.cc("click",(function(){p.wc(e),p.gc();const i=p.vc(3);return p.gc(3).succesScan(i.value)})),p.Ub(2,"span",19),p.Ec(3," Asignarse"),p.Tb(),p.Tb(),p.Rb()}}function ti(e,i){if(1&e){const e=p.Vb();p.Ub(0,"button",24),p.cc("click",(function(){p.wc(e),p.gc();const i=p.vc(3);return p.gc(3).succesScan(i.value)})),p.Ub(1,"span",19),p.Ec(2," Asignarse"),p.Tb(),p.Tb()}}function oi(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",14),p.Ub(1,"mat-form-field"),p.Pb(2,"input",15,16),p.Tb(),p.Cc(4,ei,3,1,"div",17),p.Pb(5,"br"),p.Ub(6,"div"),p.Ub(7,"button",18),p.cc("click",(function(){return p.wc(e),p.gc(3).goBackListPedidos()})),p.Ub(8,"span",19),p.Ec(9," Cancelar"),p.Tb(),p.Tb(),p.Cc(10,ii,4,0,"ng-container",20),p.Cc(11,ti,3,0,"ng-template",null,21,p.Dc),p.Tb(),p.Tb()}if(2&e){const e=p.vc(12),i=p.gc(3);p.Cb(4),p.mc("ngIf",i.msjErrorCodDelivery.length>0),p.Cb(6),p.mc("ngIf",!i.isRepartidorRed)("ngIfElse",e)}}function si(e,i){1&e&&(p.Sb(0),p.Ub(1,"div",27),p.Pb(2,"i",28),p.Ub(3,"p"),p.Ec(4,"Obteniendo Datos ..."),p.Tb(),p.Tb(),p.Rb())}function ai(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",27),p.Ub(1,"p"),p.Ec(2),p.Tb(),p.Ub(3,"p"),p.Ec(4),p.Tb(),p.Pb(5,"hr"),p.Ub(6,"div",29),p.Ub(7,"button",30),p.cc("click",(function(){return p.wc(e),p.gc(4).isResulScan=!1})),p.Ub(8,"span",19),p.Ec(9,"Buscar Otro"),p.Tb(),p.Tb(),p.Ub(10,"button",31),p.cc("click",(function(){return p.wc(e),p.gc(4).goBackListPedidos()})),p.Ub(11,"span",19),p.Ec(12,"Finalizar Asignacion"),p.Tb(),p.Tb(),p.Tb(),p.Tb()}if(2&e){const e=p.gc(4);p.Cb(2),p.Gc("Pedido Asinado: ",e.ordenAsingadaScan.idpedido,""),p.Cb(2),p.Fc(e.ordenAsingadaScan.json_datos_delivery.p_header.arrDatosDelivery.nombre)}}function ni(e,i){if(1&e&&(p.Ub(0,"div",25),p.Cc(1,si,5,0,"ng-container",20),p.Cc(2,ai,13,2,"ng-template",null,26,p.Dc),p.Tb()),2&e){const e=p.vc(3),i=p.gc(3);p.Cb(1),p.mc("ngIf",i.loadingScan)("ngIfElse",e)}}function ri(e,i){if(1&e&&(p.Ub(0,"div",12),p.Cc(1,oi,13,3,"div",13),p.Cc(2,ni,4,2,"div",9),p.Tb()),2&e){const e=p.gc(2);p.Cb(1),p.mc("ngIf",!e.isResulScan),p.Cb(1),p.mc("ngIf",e.isResulScan)}}function di(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div"),p.Ub(1,"button",38),p.cc("click",(function(){return p.wc(e),p.gc(4).goBackRepartidorRed()})),p.Pb(2,"i",39),p.Ec(3," Atas"),p.Tb(),p.Tb()}}function ci(e,i){if(1&e&&(p.Ub(0,"div",36),p.Pb(1,"img",37),p.Pb(2,"br"),p.Pb(3,"br"),p.Cc(4,di,4,0,"div",8),p.Tb()),2&e){const e=p.gc(3);p.Cb(4),p.mc("ngIf",e.isRepartidorRed)}}function li(e,i){1&e&&(p.Ub(0,"th",52),p.Ec(1," Pedido "),p.Tb())}const pi=function(e){return{"text-danger":e}};function bi(e,i){if(1&e&&(p.Ub(0,"td",53),p.Ub(1,"p",54),p.Ec(2),p.Tb(),p.Ub(3,"p",55),p.Ub(4,"span",56),p.Ec(5),p.Tb(),p.Tb(),p.Tb()),2&e){const e=i.$implicit;p.Cb(2),p.Fc(e.idpedido),p.Cb(2),p.mc("ngClass",p.rc(3,pi,e.hora_show>30)),p.Cb(1),p.Gc(" ",e.hora_show," min ")}}function hi(e,i){1&e&&(p.Ub(0,"th",57),p.Ec(1," Cliente "),p.Tb())}const ui=function(e,i,t){return{"badge-primary":e,"badge-info":i,"badge-secondary":t}};function mi(e,i){if(1&e&&(p.Ub(0,"td",58),p.Ub(1,"p",54),p.Ec(2),p.hc(3,"titlecase"),p.Tb(),p.Ub(4,"p",59),p.Ub(5,"span",60),p.Ec(6),p.hc(7,"titlecase"),p.Tb(),p.Ub(8,"span",61),p.Ec(9),p.Tb(),p.Tb(),p.Tb()),2&e){const e=i.$implicit;p.Cb(2),p.Gc(" ",p.ic(3,4,e.json_datos_delivery.p_header.arrDatosDelivery.nombre)," "),p.Cb(3),p.mc("ngClass",p.tc(8,ui,3===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,1===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)),p.Cb(1),p.Gc(" ",p.ic(7,6,e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion)," "),p.Cb(3),p.Gc(" ",e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km," Km ")}}function gi(e,i){1&e&&(p.Ub(0,"th",62),p.Ec(1," Importe "),p.Tb())}function fi(e,i){1&e&&(p.Ub(0,"p",65),p.Ec(1," pagado con tarjeta "),p.Tb())}function vi(e,i){if(1&e&&(p.Ub(0,"td",63),p.Ub(1,"p",54),p.Ec(2),p.hc(3,"number"),p.Tb(),p.Cc(4,fi,2,0,"p",64),p.Tb()),2&e){const e=i.$implicit;p.Cb(2),p.Gc(" ",p.jc(3,2,e.importe_pagar_comercio,".2")," "),p.Cb(2),p.mc("ngIf",2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)}}function Pi(e,i){1&e&&p.Pb(0,"tr",66)}const Ci=function(e){return{"color-checked":e}};function Ti(e,i){if(1&e){const e=p.Vb();p.Ub(0,"tr",67),p.cc("click",(function(){p.wc(e);const t=i.$implicit;return p.gc(4).showDetallePedido(t)})),p.Tb()}2&e&&p.mc("ngClass",p.rc(1,Ci,"E"===i.$implicit.pwa_estado))}function _i(e,i){if(1&e&&(p.Ub(0,"table",40),p.Sb(1,41),p.Cc(2,li,2,0,"th",42),p.Cc(3,bi,6,5,"td",43),p.Rb(),p.Sb(4,44),p.Cc(5,hi,2,0,"th",45),p.Cc(6,mi,10,12,"td",46),p.Rb(),p.Sb(7,47),p.Cc(8,gi,2,0,"th",48),p.Cc(9,vi,5,5,"td",49),p.Rb(),p.Cc(10,Pi,1,0,"tr",50),p.Cc(11,Ti,1,3,"tr",51),p.Tb()),2&e){const e=p.gc(3);p.mc("dataSource",e.listPedidos),p.Cb(10),p.mc("matHeaderRowDef",e.displayedColumns),p.Cb(1),p.mc("matRowDefColumns",e.displayedColumns)}}function yi(e,i){if(1&e&&(p.Ub(0,"div",68),p.Ub(1,"div",69),p.Ub(2,"div"),p.Ub(3,"span",70),p.Ec(4,"Total a pagar: "),p.Tb(),p.Ub(5,"span",71),p.Ec(6),p.hc(7,"number"),p.Tb(),p.Tb(),p.Ub(8,"div"),p.Ub(9,"span",72),p.Ec(10,"Comision Entrega: "),p.Tb(),p.Ub(11,"span",73),p.Ec(12),p.hc(13,"number"),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e){const e=p.gc(3);p.Cb(6),p.Gc(" ",p.jc(7,2,e.sumListPedidos,".2")," "),p.Cb(6),p.Gc(" ",p.jc(13,5,e.sumGananciaTotal,".2")," ")}}function Si(e,i){if(1&e&&(p.Ub(0,"div"),p.Ub(1,"p",32),p.Ec(2,"Lista de pedidos asignados:"),p.Tb(),p.Cc(3,ci,5,1,"div",33),p.Cc(4,_i,12,3,"table",34),p.Cc(5,yi,14,8,"div",35),p.Pb(6,"br"),p.Pb(7,"br"),p.Tb()),2&e){const e=p.gc(2);p.Cb(3),p.mc("ngIf",!e.scanCode&&!e.listPedidos),p.Cb(1),p.mc("ngIf",e.listPedidos),p.Cb(1),p.mc("ngIf",e.listPedidos)}}function Ui(e,i){if(1&e&&(p.Ub(0,"div"),p.Cc(1,ri,3,2,"div",11),p.Cc(2,Si,8,3,"div",8),p.Tb()),2&e){const e=p.gc();p.Cb(1),p.mc("ngIf",e.scanCode),p.Cb(1),p.mc("ngIf",!e.scanCode)}}function wi(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",25),p.Pb(1,"app-pedidos-atendidos"),p.Ub(2,"div",74),p.Ub(3,"button",24),p.cc("click",(function(){return p.wc(e),p.gc().isShowResumen=!1})),p.Pb(4,"i",75),p.Ec(5," Atras "),p.Tb(),p.Tb(),p.Tb()}}function Ri(e,i){if(1&e){const e=p.Vb();p.Sb(0),p.Ub(1,"div",77),p.cc("click",(function(){return p.wc(e),p.gc(2).entregaTodo()})),p.Ub(2,"span"),p.Ec(3,"Listo, pedidos entregados."),p.Tb(),p.Tb(),p.Rb()}}function ki(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",78),p.cc("click",(function(){return p.wc(e),p.gc(2).goRuta()})),p.Ub(1,"span"),p.Ec(2,"Ver Ruta"),p.Tb(),p.Ub(3,"p",79),p.Ec(4,"Ruta mas corta."),p.Tb(),p.Tb()}}function Di(e,i){if(1&e&&(p.Ub(0,"div",76),p.Cc(1,Ri,4,0,"ng-container",20),p.Cc(2,ki,5,0,"ng-template",null,26,p.Dc),p.Tb()),2&e){const e=p.vc(3),i=p.gc();p.Cb(1),p.mc("ngIf",i.isEntregadoAll)("ngIfElse",e)}}let Ei=(()=>{class e{constructor(e,i,t,o,s,a,n,r,d,c){this.infoTokenService=e,this.utilService=i,this.socketService=t,this.dialog=o,this.repartidorService=s,this.pedidoRepartidorService=a,this.gpsPositionService=n,this.listeService=r,this.geoPositionService=d,this.router=c,this.nomRepartidor="",this.sumListPedidos=0,this.sumGananciaTotal=0,this.listRepartidoresInformativo=[],this.isShowResumen=!1,this.scanCode=!1,this.loadingScan=!1,this.isResulScan=!1,this.isEntregadoAll=!1,this.isRepartidorRed=!1,this.destroy$=new v.Subject,this.geoPositionActual=new Pe.a,this.displayedColumns=["Pedido","Cliente","Importe"],this.msjErrorCodDelivery="",this.countPedidosAsignados=0,this.countPedidoSetForMe=0,this.showTimeAsignacion=!0,this.keyTimeSetLastPedido="sys::set::p::me",this.keyCountSetLastPedido="sys::set::p::me::count"}ngOnInit(){this.infoToken=this.infoTokenService.getInfoUs(),console.log("this.infoToken lista pedidos",this.infoToken),this.isRepartidorRed=!this.infoToken.usuario.idsede_suscrito,this.nomRepartidor=this.infoToken.usuario.nombre+" "+this.infoToken.usuario.apellido,this.loadPedidosPendiente(),this.listenNewPedidos(),this.countPedidosAsignados=this.isRepartidorRed?localStorage.getItem("sys::count::p"):0,console.log("this.countPedidosAsignados",this.countPedidosAsignados),console.log("this.isRepartidorRed",this.isRepartidorRed),this.scanCode=this.isRepartidorRed,this.geoPositionService.onGeoWatchPosition(),this.geoPositionActual=this.geoPositionService.geoPosition,this.geoPositionService.geoPositionNow$.pipe(Object(le.takeUntil)(this.destroy$)).subscribe(e=>{(e=(null==e?void 0:e.latitude)?e:this.geoPositionActual).latitude&&(this.geoPositionActual=e)})}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}loadPedidosPendiente(){this.socketService.onRepartidorGetPedidoPendienteAceptar().subscribe(e=>{console.log(e),this.pedidoRepartidorService.setPedidoPorAceptar(e[0].pedido_por_aceptar),this.darFormatoGrupoPedidosRecibidos(e[0].pedido_por_aceptar),this.pedidoRepartidorService.setPedidoPorAceptar(e[0].pedido_por_aceptar)})}succesScan(e){console.log("cod",e),this.msjErrorCodDelivery="",this.loadingScan=!0,this.countPedidosAsignados>3?this.msjErrorCodDelivery="Ya tienes muchos pedidos!. Entrega lo que tienes primero.":(localStorage.setItem("sys::count::p",this.countPedidosAsignados),console.log("this.countPedidosAsignados",this.countPedidosAsignados),this.pedidoRepartidorService.confirmarAsignacionReadBarCode(e).subscribe(e=>{if(e)if(console.log(e),e.elPedido.idrepartidor)this.msjErrorCodDelivery="Ya tiene repatirdor asignado.";else{if(!this.verificarTiempoAsignacion())return void(this.msjErrorCodDelivery="Ya tienes pedidos, la asignaci\xf3n estara disponible en 10min.");this.countPedidosAsignados++,this.loadingScan=!1,this.isResulScan=!0;try{e.elPedido.json_datos_delivery="object"!=typeof e.elPedido.json_datos_delivery?JSON.parse(e.elPedido.json_datos_delivery):e.elPedido.json_datos_delivery}catch(i){}this.ordenAsingadaScan=e.elPedido,e=this.pedidoRepartidorService.addPedidoInListPedidosPendientes(e.elPedido),this.darFormatoGrupoPedidosRecibidos(e.pedidos_repartidor),console.log(e)}else this.msjErrorCodDelivery="No se encontro ning\xfan pedido."}))}darFormatoGrupoPedidosRecibidos(e){e&&this.pedidoRepartidorService.loadPedidosRecibidos(e.pedidos.join(",")).subscribe(i=>{let t;console.log("res",i);const o=i.map(e=>{e.json_datos_delivery=JSON.parse(e.json_datos_delivery),t=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal),t=0===t?parseFloat(e.json_datos_delivery.p_subtotales[e.json_datos_delivery.p_subtotales.length-1].importe):t,e.importe_pagar_comercio=parseFloat(t)-parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery),e.importe_pagar_comercio=2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago?0:e.importe_pagar_comercio;const i=e.json_datos_delivery.p_header.arrDatosDelivery.propina.value?parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.propina.value):0;return e.comsion_entrea_total=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery)+i,e});this.establecimientoIni=o[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento,this.establecimientoIni.longitude=parseFloat(this.establecimientoIni.longitude),this.establecimientoIni.latitude=parseFloat(this.establecimientoIni.latitude);const s=JSON.parse(JSON.stringify(o));this.pedidoRepartidorService.setLocalIds(e),this.pedidoRepartidorService.setLocalItems(s),this.iniComponente()})}iniComponente(){this.pedidoRepartidorService.init(),this.dataPedido=this.pedidoRepartidorService.getLocal(),this.listPedidos=this.pedidoRepartidorService.getLocalItems(),this.listPedidos=this.listPedidos.sort((e,i)=>parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)-parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)),this.checkIsEntregaALL(),this.dataPedido.idsede=this.listPedidos[0].idsede,this.pedidoRepartidorService.setLocal(),this.sumListPedidos=this.listPedidos.map(e=>e.importe_pagar_comercio).reduce((e,i)=>e+i,0),this.sumGananciaTotal=this.listPedidos.map(e=>e.comsion_entrea_total).reduce((e,i)=>e+i,0),this.calcHora()}calcHora(){this.calHoraList(),this.timerRun=setInterval(()=>{this.calHoraList()},6e4)}calHoraList(){this.listPedidos.map(e=>{e.hora_show=this.utilService.xTiempoTranscurridos_en_minutos(e.hora)})}showDetallePedido(e){const i=new a.e;e.isRepartidorRed=!0,i.disableClose=!0,i.hasBackdrop=!0,i.width="700px",i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],i.data={laOrden:e},this.pedidoRepartidorService.setPedidoSelect(e),this.dialog.open(Qe,i).afterClosed().subscribe(e=>{console.log("el pedido",e),this.checkIsEntregaALL(),"E"===e.pwa_estado&&this.openDialogCalificacion(e)})}checkIsEntregaALL(){const e=this.listPedidos.filter(e=>"E"!==e.pwa_estado);this.isEntregadoAll=0===e.length}listenNewPedidos(){this.socketService.onPedidoAsignadoFromComercio().subscribe(e=>{console.log("nuevo pedido asignado",e);const i=this.pedidoRepartidorService.addPedidoInListPedidosPendientes(e);console.log(i),this.darFormatoGrupoPedidosRecibidos(i.pedidos_repartidor)}),this.socketService.onDeliveryPedidoFin().pipe(Object(le.takeUntil)(this.destroy$)).subscribe(e=>{this.openDialogCalificacion(e)})}loadPedidosPropios(){this.repartidorService.getMisPedidosPropiosAsignados().subscribe(e=>{e.map(e=>{e.json_datos_delivery=JSON.parse(e.json_datos_delivery)}),this.listPedidos=e})}openDialogCalificacion(e=null){this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor;const i=new pe;i.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,i.idcliente=this.dataPedido.datosCliente.idcliente,i.idpedido=this.dataPedido.idpedido,i.tipo=2,i.showNombre=!0,i.nombre=this.dataPedido.datosDelivery.nombre,i.titulo="Como calificas al cliente?",i.showTitulo=!0,i.showMsjTankyou=!0;const t=new a.e;t.disableClose=!0,t.hasBackdrop=!0,t.data={dataCalificado:i},this.dialog.open(ve,t).afterClosed().subscribe(e=>{this.pedidoRepartidorService.finalizarPedidoPropioRepartidor()})}goRuta(){let e="";this.listPedidos.map(i=>{e+=`${i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude},${i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude}+to:`}),e=e.slice(0,-4),window.open(`http://maps.google.com/maps?f=d&source=s_d&saddr=${this.establecimientoIni.latitude},${this.establecimientoIni.longitude}&daddr=${e}`,"_blank")}entregaTodo(){this.pedidoRepartidorService.listaPedidosEntregados(),this.listPedidos=null,this.sumListPedidos=0,this.sumGananciaTotal=0}resumenDelDia(){this.isShowResumen=!0}goBackRepartidorRed(){this.router.navigate(["./main/pedidos"])}goBackListPedidos(){this.isRepartidorRed?this.router.navigate(this.countPedidosAsignados>0?["./main/list-grupo-pedidos"]:["./main/pedidos"]):(this.scanCode=!1,this.isResulScan=!1)}verificarTiempoAsignacion(){if(this.isRepartidorRed){let e=localStorage.getItem(this.keyTimeSetLastPedido);e=e||(new Date).toLocaleTimeString(),this.countPedidoSetForMe=parseInt(localStorage.getItem(this.keyCountSetLastPedido),0),this.countPedidoSetForMe=isNaN(this.countPedidoSetForMe)?0:this.countPedidoSetForMe,this.countPedidoSetForMe++;const i=this.utilService.xTiempoTranscurridos_en_minutos(e);return this.countPedidoSetForMe=i>10?1:this.countPedidoSetForMe,localStorage.setItem(this.keyCountSetLastPedido,this.countPedidoSetForMe.toString()),!(this.countPedidoSetForMe>2||(localStorage.setItem(this.keyTimeSetLastPedido,(new Date).toLocaleTimeString()),0))}return!0}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(d.a),p.Ob(Ze),p.Ob(g.a),p.Ob(a.b),p.Ob(c.a),p.Ob(f.a),p.Ob(r.a),p.Ob(l.a),p.Ob(r.a),p.Ob(s.b))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-mapa-pedidos"]],decls:13,vars:3,consts:[[1,"container-body","animated","fadeInDown"],[1,"bg-dark","text-white","fs-13","d-flex","justify-content-between","align-items-center","p-2"],["matRipple","",1,"pl-2","btn-link-2","xCursor",3,"click"],[1,"d-flex","align-items-center"],[1,"fa","fa-shopping-bag"],[1,"fs-11","pl-2"],["matRipple","",1,"pr-2",3,"click"],[1,"btn-link-2","xCursor"],[4,"ngIf"],["class","animated fadeIn",4,"ngIf"],["class","xfooterA p-2",4,"ngIf"],["class","w-100 center-div-screen",4,"ngIf"],[1,"w-100","center-div-screen"],["class","animated fadeIn text-center",4,"ngIf"],[1,"animated","fadeIn","text-center"],["matInput","","placeholder","C\xf3digo Delivery","autocomplete","off","name","txt_delivety",1,"text-center"],["txt_cod",""],["class","p-2",4,"ngIf"],[1,"btn","btn-sm","btn-secondary","mr-2",3,"click"],[1,"fs-12"],[4,"ngIf","ngIfElse"],["elseTemplateIsRed",""],[1,"p-2"],[1,"fs-14","fw-600","text-danger","animated","flash"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"animated","fadeIn"],["elseTemplate",""],[1,"w-100","text-center"],[1,"fa","fa-spinner","fa-spin","fa-2x","fa-fw"],[1,"d-flex","justify-content-center"],[1,"btn","btn-sm","btn-success","mr-1",3,"click"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"p-3"],["class","p-5 w-100 text-center",4,"ngIf"],["mat-table","","class","w-100",3,"dataSource",4,"ngIf"],["class","w-100 pt-3",4,"ngIf"],[1,"p-5","w-100","text-center"],["src","./assets/images/waiting.JPG","width","250px","alt","waiting"],["mat-stroked-button","",3,"click"],[1,"fa","fa-arrow-left","pr-2"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","Pedido"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Cliente"],["mat-header-cell","","class","text-left",4,"matHeaderCellDef"],["mat-cell","","class","text-left",4,"matCellDef"],["matColumnDef","Importe"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"fw-600","fs-12"],[1,"fw-100","text-secondary","fs-12"],[1,"text-success","fs-10",3,"ngClass"],["mat-header-cell","",1,"text-left"],["mat-cell","",1,"text-left"],[1,"fw-100","fs-12"],[1,"fw-600","badge",3,"ngClass"],[1,"text-secondary","fs-10","ml-1"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["class","badge badge-info",4,"ngIf"],[1,"badge","badge-info"],["mat-header-row",""],["mat-row","",3,"ngClass","click"],[1,"w-100","pt-3"],[1,"text-right","pr-4"],[1,"text-secondary","pr-2"],[1,"fw-600","fs-18"],[1,"text-secondary","fs-13","pr-2"],[1,"fw-600","fs-13","badge","badge-info"],[1,"text-center","w-100"],[1,"fa","fa-arrow-left"],[1,"xfooterA","p-2"],["matRipple","",1,"btn","btn-secondary","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],["matRipple","",1,"btn","btn-success","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],[1,"fs-11","fw-100"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div",2),p.cc("click",(function(){return i.scanCode=!0})),p.Ub(3,"div",3),p.Pb(4,"i",4),p.Ub(5,"span",5),p.Ec(6,"Codigo Delivery"),p.Tb(),p.Tb(),p.Tb(),p.Ub(7,"div",6),p.cc("click",(function(){return i.resumenDelDia()})),p.Ub(8,"span",7),p.Ec(9,"Resumen"),p.Tb(),p.Tb(),p.Tb(),p.Cc(10,Ui,3,2,"div",8),p.Cc(11,wi,6,0,"div",9),p.Cc(12,Di,4,2,"div",10),p.Tb()),2&e&&(p.Cb(10),p.mc("ngIf",!i.isShowResumen),p.Cb(1),p.mc("ngIf",i.isShowResumen),p.Cb(1),p.mc("ngIf",i.listPedidos))},directives:[I.e,o.m,b.a,h.a,u.a,Xe.j,Xe.c,Xe.e,Xe.b,Xe.g,Xe.i,Xe.d,Xe.a,o.k,Xe.f,Xe.h,z],pipes:[o.u,o.e],styles:[".content-body-mapa[_ngcontent-%COMP%]{height:calc(100vh - 109px);overflow:auto}.btn-link-2[_ngcontent-%COMP%]:hover{text-decoration:none;color:gold;cursor:pointer}.center-div-screen[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:80vh;overflow:hidden}p[_ngcontent-%COMP%]{margin:0}.xfooterA[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}.color-checked[_ngcontent-%COMP%]{background-color:#e8f5e9}"]}),e})();function xi(e,i){1&e&&(p.Ub(0,"th",34),p.Ec(1," Pedido "),p.Tb())}const Ii=function(e){return{"text-danger":e}};function Oi(e,i){if(1&e&&(p.Ub(0,"td",35),p.Ub(1,"p",36),p.Ec(2),p.Tb(),p.Ub(3,"p",37),p.Ub(4,"span",38),p.Ec(5),p.Tb(),p.Tb(),p.Tb()),2&e){const e=i.$implicit;p.Cb(2),p.Fc(e.idpedido),p.Cb(2),p.mc("ngClass",p.rc(3,Ii,e.hora_show>30)),p.Cb(1),p.Gc(" ",e.hora_show," min ")}}function ji(e,i){1&e&&(p.Ub(0,"th",39),p.Ec(1," Cliente "),p.Tb())}function Ai(e,i){1&e&&(p.Ub(0,"span",45),p.Ec(1," APP "),p.Tb())}const Li=function(e,i,t){return{"badge-primary":e,"badge-info":i,"badge-secondary":t}};function Mi(e,i){if(1&e&&(p.Ub(0,"td",40),p.Ub(1,"p",36),p.Ec(2),p.hc(3,"titlecase"),p.Tb(),p.Ub(4,"p",41),p.Cc(5,Ai,2,0,"span",42),p.Ub(6,"span",43),p.Ec(7),p.hc(8,"titlecase"),p.Tb(),p.Ub(9,"span",44),p.Ec(10),p.Tb(),p.Tb(),p.Tb()),2&e){const e=i.$implicit;p.Cb(2),p.Gc(" ",p.ic(3,5,e.json_datos_delivery.p_header.arrDatosDelivery.nombre)," "),p.Cb(3),p.mc("ngIf",1===e.json_datos_delivery.p_header.isCliente),p.Cb(1),p.mc("ngClass",p.tc(9,Li,3===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago,1===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)),p.Cb(1),p.Gc(" ",p.ic(8,7,e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.descripcion)," "),p.Cb(3),p.Gc(" ",e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km," Km ")}}function Fi(e,i){1&e&&(p.Ub(0,"th",46),p.Ec(1," Importe "),p.Tb())}function Gi(e,i){if(1&e&&(p.Sb(0),p.Ub(1,"p",36),p.Ec(2),p.hc(3,"number"),p.Tb(),p.Rb()),2&e){const e=p.gc().$implicit;p.Cb(2),p.Gc(" ",p.jc(3,1,e.importe_pagar_comercio,".2")," ")}}function $i(e,i){if(1&e&&(p.Ub(0,"p",36),p.Ec(1),p.Tb()),2&e){const e=p.gc().$implicit;p.Cb(1),p.Gc(" ",e.total,"")}}function Ni(e,i){1&e&&(p.Ub(0,"p",51),p.Ec(1," pagado con tarjeta "),p.Tb())}function Vi(e,i){if(1&e&&(p.Ub(0,"td",47),p.Cc(1,Gi,4,4,"ng-container",48),p.Cc(2,$i,2,1,"ng-template",null,49,p.Dc),p.Cc(4,Ni,2,0,"p",50),p.Tb()),2&e){const e=i.$implicit,t=p.vc(3);p.Cb(1),p.mc("ngIf",e.importe_pagar_comercio)("ngIfElse",t),p.Cb(3),p.mc("ngIf",2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago)}}function zi(e,i){1&e&&p.Pb(0,"tr",52)}const Hi=function(e){return{"color-checked":e}};function Bi(e,i){if(1&e){const e=p.Vb();p.Ub(0,"tr",53),p.cc("click",(function(){p.wc(e);const t=i.$implicit;return p.gc().showDetallePedido(t)})),p.Tb()}2&e&&p.mc("ngClass",p.rc(1,Hi,"E"===i.$implicit.pwa_estado))}function Wi(e,i){if(1&e){const e=p.Vb();p.Sb(0),p.Ub(1,"div",56),p.cc("click",(function(){return p.wc(e),p.gc(2).entregaTodo()})),p.Ub(2,"span"),p.Ec(3,"Listo, pedidos entregados."),p.Tb(),p.Tb(),p.Rb()}}function qi(e,i){if(1&e){const e=p.Vb();p.Ub(0,"div",57),p.cc("click",(function(){return p.wc(e),p.gc(2).goRuta()})),p.Ub(1,"span"),p.Ec(2,"Ver Ruta"),p.Tb(),p.Ub(3,"p",58),p.Ec(4,"Ruta mas corta."),p.Tb(),p.Tb()}}function Ki(e,i){if(1&e&&(p.Ub(0,"div",54),p.Cc(1,Wi,4,0,"ng-container",48),p.Cc(2,qi,5,0,"ng-template",null,55,p.Dc),p.Tb()),2&e){const e=p.vc(3),i=p.gc();p.Cb(1),p.mc("ngIf",i.isEntregadoAll)("ngIfElse",e)}}let Ji=(()=>{class e{constructor(e,i,t,o,s,a,n,r,d,c){this.infoTokenService=e,this.pedidoRepartidorService=i,this.utilService=t,this.geoPositionService=o,this.listenService=s,this.calcDistanciaService=a,this.router=n,this.dialog=r,this.repartidorServcice=d,this.socketService=c,this.sumListPedidos=0,this.sumGananciaTotal=0,this.btnShow=!0,this.btnTitlePasos="Vamos, vamos!!",this.displayedColumns=["Pedido","Cliente","Importe"],this.geoPositionActual=new Pe.a,this.geoPositionComercio=new Pe.a,this.destroy$=new v.Subject,this.isEntregadoAll=!1}ngOnInit(){this.iniComponente(),this.geoPositionService.onGeoWatchPosition(),this.listenGeoPosition(),this.socketService.onRepartidorGetPedidoPendienteAceptar().subscribe(e=>{this.pedidoRepartidorService.setPedidoPorAceptar(e[0].pedido_por_aceptar),this.darFormatoGrupoPedidosRecibidos(e[0].pedido_por_aceptar)})}iniComponente(){this.pedidoRepartidorService.init(),this.dataPedido=this.pedidoRepartidorService.getLocal(),this.listPedidos=this.pedidoRepartidorService.getLocalItems(),this.listPedidos=this.listPedidos.sort((e,i)=>parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)-parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)),this.checkIsEntregaALL(),this.comercioPedido=this.listPedidos[0].json_datos_delivery.p_header.arrDatosDelivery.establecimiento,this.dataPedido.idsede=this.listPedidos[0].idsede,this.pedidoRepartidorService.setLocal(),this.geoPositionComercio.latitude="string"==typeof this.comercioPedido.latitude?parseFloat(this.comercioPedido.latitude):this.comercioPedido.latitude,this.geoPositionComercio.longitude="string"==typeof this.comercioPedido.longitude?parseFloat(this.comercioPedido.longitude):this.comercioPedido.longitude,this.sumListPedidos=this.listPedidos.map(e=>e.importe_pagar_comercio).reduce((e,i)=>e+i,0),this.sumListPedidos=this.sumListPedidos?this.sumListPedidos:this.sumListPedidos=this.listPedidos.map(e=>parseFloat(e.total)).reduce((e,i)=>e+i,0),this.sumGananciaTotal=this.dataPedido.sumGananciaTotal,this.showPasos(),this.calcHora()}ngOnDestroy(){clearInterval(this.timerRun),this.destroy$.next(!0),this.destroy$.unsubscribe()}darFormatoGrupoPedidosRecibidos(e){e&&this.pedidoRepartidorService.loadPedidosRecibidos(e.pedidos.join(",")).subscribe(i=>{const t=i.map(e=>(e.json_datos_delivery=JSON.parse(e.json_datos_delivery),e.importe_pagar_comercio=parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.importeTotal)-parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.costoTotalDelivery),e.importe_pagar_comercio=2===e.json_datos_delivery.p_header.arrDatosDelivery.metodoPago.idtipo_pago?0:e.importe_pagar_comercio,e)),o=JSON.parse(JSON.stringify(t));this.pedidoRepartidorService.setLocalIds(e),this.pedidoRepartidorService.setLocalItems(o),this.iniComponente()})}calcHora(){this.calHoraList(),this.timerRun=setInterval(()=>{this.calHoraList()},6e4)}calHoraList(){this.listPedidos.map(e=>{e.hora_show=this.utilService.xTiempoTranscurridos_en_minutos(e.hora)})}listenGeoPosition(){this.geoPositionActual=this.geoPositionService.geoPosition,this.geoPositionService.geoPositionNow$.pipe(Object(le.takeUntil)(this.destroy$)).subscribe(e=>{(e=(null==e?void 0:e.latitude)?e:this.geoPositionActual).latitude&&(this.geoPositionActual=e,this.geoPositionComercio.latitude&&this.calcDistanciaService.calcDistancia(this.geoPositionActual,this.geoPositionComercio,120)||1===this.dataPedido.pedido_paso_va&&(this.dataPedido.pedido_paso_va=2,this.pedidoRepartidorService.setPedidoPasoVa(2),this.dataPedido.pedido_paso_va=2,console.log("guarda paso va 2"),this.repartidorServcice.guardarPasoVa(2),this.showPasos()))})}showPasos(){switch(this.dataPedido.pedido_paso_va){case null:case 1:this.btnTitlePasos="Empezar";break;default:this.btnShow=!1,this.btnTitlePasos="Ir a Entregar"}}goRuta(){let e="";this.listPedidos.map(i=>{e+=`${i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude},${i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude}+to:`}),e=e.slice(0,-4),window.open(`http://maps.google.com/maps?f=d&source=s_d&saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${e}`,"_blank")}entregaTodo(){this.pedidoRepartidorService.listaPedidosEntregados(),this.listPedidos=null,this.sumListPedidos=0,this.sumGananciaTotal=0,this.router.navigate(["./main/pedidos"])}btnEjecutar(){switch(this.dataPedido.pedido_paso_va){case 1:let e="";this.listPedidos.map(i=>{e+=`${i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.latitude},${i.json_datos_delivery.p_header.arrDatosDelivery.direccionEnvioSelected.longitude}+to:`}),e=e.slice(0,-4),window.open(`http://maps.google.com/maps?f=d&source=s_d&saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${e}`,"_blank");break;default:this.pedidoRepartidorService.setPedidoPasoVa(3),this.dataPedido.pedido_paso_va=3,this.repartidorServcice.guardarPasoVa(3),this.router.navigate(["/main/indicaciones-mapa-grupo"])}}irAlComercio(){window.open(`http://maps.google.com/maps?saddr=${this.geoPositionActual.latitude},${this.geoPositionActual.longitude}&daddr=${this.geoPositionComercio.latitude},${this.geoPositionComercio.longitude}`,"_blank")}showDetallePedido(e){const i=new a.e;e.isRepartidorRed=!0,i.disableClose=!0,i.hasBackdrop=!0,i.width="700px",i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],i.data={laOrden:e},this.pedidoRepartidorService.setPedidoSelect(e),this.dialog.open(Qe,i).afterClosed().subscribe(e=>{console.log("el pedido",e),this.checkIsEntregaALL(),"E"===e.pwa_estado&&this.openDialogCalificacion(e)})}checkIsEntregaALL(){const e=this.listPedidos.filter(e=>"E"!==e.pwa_estado);this.isEntregadoAll=0===e.length}openDialogCalificacion(e=null){this.dataPedido=this.pedidoRepartidorService.pedidoRepartidor;const i=new pe;i.idrepartidor=this.infoTokenService.infoUsToken.usuario.idrepartidor,i.idcliente=this.dataPedido.datosCliente.idcliente,i.idpedido=this.dataPedido.idpedido,i.tipo=2,i.showNombre=!0,i.nombre=this.dataPedido.datosDelivery.nombre,i.titulo="Como calificas al cliente?",i.showTitulo=!0,i.showMsjTankyou=!0;const t=new a.e;t.disableClose=!0,t.hasBackdrop=!0,t.data={dataCalificado:i},this.dialog.open(ve,t).afterClosed().subscribe(e=>{this.pedidoRepartidorService.finalizarPedidoPropioRepartidor()})}goScanCodeBar(){localStorage.setItem("sys::count::p",this.listPedidos.length),this.router.navigate(["./main/mapa-de-pedidos"])}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(d.a),p.Ob(f.a),p.Ob(Ze),p.Ob(r.a),p.Ob(l.a),p.Ob(ce),p.Ob(s.b),p.Ob(a.b),p.Ob(c.a),p.Ob(g.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-list-grupo-pedidos"]],decls:56,vars:14,consts:[[1,"animated","fadeInDown","container-body"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"p-4"],[1,"fw-600","text-secondary"],[1,"row"],[1,"col-6"],[1,"fw-100","fs-13"],[1,"fw-100","fs-12","text-secondary"],[1,"fw-100","fs-13","text-secondary"],[1,"w-100","text-right"],[1,"btn","btn-sm","btn-secondary","mb-1",3,"click"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"m-0"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","Pedido"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Cliente"],["mat-header-cell","","class","text-left",4,"matHeaderCellDef"],["mat-cell","","class","text-left",4,"matCellDef"],["matColumnDef","Importe"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"w-100","pt-3"],[1,"text-right","pr-4"],[1,"text-secondary","pr-2"],[1,"fw-600","fs-18"],[1,"text-secondary","fs-13","pr-2"],[1,"fw-600","fs-13","badge","badge-info"],[1,"p-2"],[1,"fw-100","fs-12","text-info"],["class","p-2 pt-3 text-center",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"fw-600","fs-12"],[1,"fw-100","text-secondary","fs-12"],[1,"text-success","fs-10",3,"ngClass"],["mat-header-cell","",1,"text-left"],["mat-cell","",1,"text-left"],[1,"fw-100","fs-12"],["class","fw-600 badge badge-success",4,"ngIf"],[1,"fw-600","badge",3,"ngClass"],[1,"text-secondary","fs-10","ml-1"],[1,"fw-600","badge","badge-success"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],[4,"ngIf","ngIfElse"],["elseTemplatePrecioTotal",""],["class","badge badge-info",4,"ngIf"],[1,"badge","badge-info"],["mat-header-row",""],["mat-row","",3,"ngClass","click"],[1,"p-2","pt-3","text-center"],["elseTemplate",""],["matRipple","",1,"btn","btn-secondary","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],["matRipple","",1,"btn","btn-success","w-75","p-2","fs-20","text-white","animated","fadeInUp","delay-0-5s",3,"click"],[1,"fs-11","fw-100"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div"),p.Ub(3,"span"),p.Ec(4,"Lista de pedidos"),p.Tb(),p.Tb(),p.Tb(),p.Ub(5,"div"),p.Ub(6,"div",2),p.Ub(7,"p",3),p.Ec(8,"Dir\xedjase hacia el comercio:"),p.Tb(),p.Ub(9,"div",4),p.Ub(10,"div",5),p.Ub(11,"p",6),p.Ec(12),p.Tb(),p.Ub(13,"p",7),p.Ec(14),p.Tb(),p.Ub(15,"p",8),p.Ec(16," Pedidos Asignados: "),p.Tb(),p.Tb(),p.Ub(17,"div",5),p.Ub(18,"div",9),p.Ub(19,"button",10),p.cc("click",(function(){return i.irAlComercio()})),p.Ec(20,"Ir al comercio"),p.Tb(),p.Ub(21,"button",11),p.cc("click",(function(){return i.goScanCodeBar()})),p.Ec(22,"Asignarse Pedido"),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Pb(23,"hr",12),p.Ub(24,"table",13),p.Sb(25,14),p.Cc(26,xi,2,0,"th",15),p.Cc(27,Oi,6,5,"td",16),p.Rb(),p.Sb(28,17),p.Cc(29,ji,2,0,"th",18),p.Cc(30,Mi,11,13,"td",19),p.Rb(),p.Sb(31,20),p.Cc(32,Fi,2,0,"th",21),p.Cc(33,Vi,5,3,"td",22),p.Rb(),p.Cc(34,zi,1,0,"tr",23),p.Cc(35,Bi,1,3,"tr",24),p.Tb(),p.Ub(36,"div",25),p.Ub(37,"div",26),p.Ub(38,"div"),p.Ub(39,"span",27),p.Ec(40,"Total a pagar: "),p.Tb(),p.Ub(41,"span",28),p.Ec(42),p.hc(43,"number"),p.Tb(),p.Tb(),p.Ub(44,"div"),p.Ub(45,"span",29),p.Ec(46,"Ganancia: "),p.Tb(),p.Ub(47,"span",30),p.Ec(48),p.hc(49,"number"),p.Tb(),p.Tb(),p.Ub(50,"div",31),p.Ub(51,"span",32),p.Ec(52,"Cuando sea posible elige pagar cero contacto: Yape \xf3 Tarjeta"),p.Tb(),p.Tb(),p.Tb(),p.Tb(),p.Pb(53,"br"),p.Pb(54,"br"),p.Tb(),p.Tb(),p.Cc(55,Ki,4,2,"div",33)),2&e&&(p.Cb(12),p.Gc(" ",i.comercioPedido.nombre," "),p.Cb(2),p.Gc(" ",i.comercioPedido.direccion," "),p.Cb(10),p.mc("dataSource",i.listPedidos),p.Cb(10),p.mc("matHeaderRowDef",i.displayedColumns),p.Cb(1),p.mc("matRowDefColumns",i.displayedColumns),p.Cb(7),p.Gc(" ",p.jc(43,8,i.sumListPedidos,".2")," "),p.Cb(6),p.Gc(" ",p.jc(49,11,i.sumGananciaTotal,".2")," "),p.Cb(7),p.mc("ngIf",i.listPedidos))},directives:[Xe.j,Xe.c,Xe.e,Xe.b,Xe.g,Xe.i,o.m,Xe.d,Xe.a,o.k,Xe.f,Xe.h,I.e],pipes:[o.e,o.u],styles:["p[_ngcontent-%COMP%]{margin:0}.xfooter[_ngcontent-%COMP%]{bottom:0;text-align:center;width:100%}.color-checked[_ngcontent-%COMP%]{background-color:#e8f5e9}"]}),e})();var Yi=t("3sZV");function Qi(e,i){if(1&e&&p.Pb(0,"map-marker",3,4),2&e){const e=i.$implicit,t=p.gc();p.mc("position",e.position)("label",e.label)("title",e.title)("options",t.markerOptionsRepartidorProduccion)}}function Zi(e,i){if(1&e){const e=p.Vb();p.Ub(0,"map-marker",5,4),p.cc("mapClick",(function(){p.wc(e);const t=i.index;return p.gc().openPedido(t)})),p.Tb()}if(2&e){const e=i.$implicit;p.mc("position",e.position)("label",e.label)("title",e.title)("options",e.options)}}let Xi=(()=>{class e{constructor(e,i,t,o){this.geoUbicationService=e,this.pedidoRepartidorService=i,this.repartidorService=t,this.listenService=o,this.infowindow=new google.maps.InfoWindow,this.pedidoOpen=new p.o,this.zoom=15,this.options={zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0},this.trazarRuta=!1,this.markerOptionsPedido={draggable:!1,icon:"./assets/images/marker-1.png"},this.markersPedidos=[],this.markerOptionsRepartidorDesarrollo={draggable:!0,icon:"./assets/images/delivery-man.png"},this.markersRepartidorDesarrollo=[],this.markerOptionsRepartidorProduccion={icon:"./assets/images/delivery-man.png"},this.markersRepartidorProduccion=[],this._isSedeFirtPedido=0,this._isFirtPedido=0}set listaPedidos(e){this.listPedidos=e,e&&this.addMarkerPedidos()}ngOnInit(){}ngAfterViewInit(){this.trazarRuta&&(this.listPedidos=this.pedidoRepartidorService.getLocalItems(),this._isSedeFirtPedido=this.listPedidos[0].idsede,this._isFirtPedido=this.listPedidos[0],this.listPedidos=this.listPedidos.sort((e,i)=>parseFloat(e.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)-parseFloat(i.json_datos_delivery.p_header.arrDatosDelivery.establecimiento.distancia_km)),this.addMarkerPedidos()),this.listenUbicaion(),this.trazarRuta&&this.directionMap(),this.listenPedidos()}listenPedidos(){this.listenService.newPedidoRepartoPropio$.subscribe(e=>{e&&(e.idpedido="string"==typeof e.idpedido?parseInt(e.idpedido,0):e.idpedido,this.listPedidos.filter(i=>i.idpedido===e.idpedido)[0]||this.listPedidos.push(e),this.addMarkerPedidos())}),this.listenService.pedidoModificado$.subscribe(e=>{e&&(this.markersPedidos.filter(i=>i.idpedido===e.idpedido)[0].options={animation:0,draggable:!1,icon:"./assets/images/marker-3.png"})})}enviarUbicacion(e){this.repartidorService.emitPositionNow(e,this.pedidoRepartidorService.pedidoRepartidor,this.trazarRuta?this._isSedeFirtPedido:this.pedidoRepartidorService.pedidoRepartidor.idsede||null)}listenUbicaion(){const e=this.geoUbicationService.getGeoPosition();this.geoUbicationService.geoPositionNow$.subscribe(i=>{this.center={lat:(i=i.latitude?i:e).latitude,lng:i.longitude};const t=new Pe.a;t.latitude=this.center.lat,t.longitude=this.center.lng,this.geoUbicationService.geoPosition=t,this.geoUbicationService.set(),this.enviarUbicacion(this.center),this.addMyMarkert()}),this.geoUbicationService.onGeoWatchPosition()}addMyMarkert(){this.markersRepartidorProduccion.push({position:this.center,label:{fontWeight:"600",text:"Yo"},title:"Repartidor",info:"Repartidor",options:{animation:google.maps.Animation.BOUNCE}})}addMarkerPedidos(){this.markersPedidos=[];const e=this.listPedidos.length-1;this.listPedidos.map((i,t)=>{let o="marker-1.png",s="Pedido "+(t+1);const a=i.json_datos_delivery.p_header.arrDatosDelivery;i.isLast=e===t,"4"===i.pwa_delivery_status.toString()&&(o="marker-3.png",s="-"),this.markersPedidos.push({idpedido:i.idpedido,position:{lat:a.direccionEnvioSelected.latitude,lng:a.direccionEnvioSelected.longitude},label:{color:"#0d47a1",fontWeight:"600",text:s},title:"Pedido",info:i.idpedido,options:{draggable:!1,animation:i.isLast?google.maps.Animation.BOUNCE:0,icon:`./assets/images/${o}`}})})}openPedido(e){this.pedidoOpen.emit(this.listPedidos[e])}directionMap(){const e=new google.maps.DirectionsService,i=[];this.markersPedidos.map(e=>{i.push({location:e.position,stopover:!0})});const t={origin:this.center,destination:this.markersPedidos[this.markersPedidos.length-1].position,waypoints:i,optimizeWaypoints:!0,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL,durationInTraffic:!1,avoidHighways:!0,avoidTolls:!0},o=new google.maps.DirectionsRenderer({preserveViewport:!1,suppressMarkers:!0});o.setMap(this.map._googleMap),e.route(t,(function(e,i){i===google.maps.DirectionsStatus.OK&&o.setDirections(e)}))}addMyMarkertDesarrolllo(){this.markersRepartidorDesarrollo.push({position:this.center,label:{fontWeight:"600",text:"Yo"},title:"Repartidor",info:"Repartidor",options:{animation:google.maps.Animation.BOUNCE}})}listeDesarrolloUbicacion(){this.center={lat:-6.029306,lng:-76.969725},this.addMyMarkertDesarrolllo()}updateUbicationDesarrollo(e){console.log("new ubicacion",e),this.center.lat=e.latLng.lat(),this.center.lng=e.latLng.lng();const i=new Pe.a;i.latitude=this.center.lat,i.longitude=this.center.lng,this.geoUbicationService.geoPosition=i,this.geoUbicationService.set(),this.enviarUbicacion(this.center)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(r.a),p.Ob(f.a),p.Ob(c.a),p.Ob(l.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-mapa-ordenes"]],viewQuery:function(e,i){var t;1&e&&p.Jc(Yi.a,!0),2&e&&p.uc(t=p.dc())&&(i.map=t.first)},inputs:{trazarRuta:"trazarRuta",listaPedidos:"listaPedidos"},outputs:{pedidoOpen:"pedidoOpen"},decls:3,vars:5,consts:[["height","100%","width","100%",3,"zoom","center","options"],[3,"position","label","title","options",4,"ngFor","ngForOf"],[3,"position","label","title","options","mapClick",4,"ngFor","ngForOf"],[3,"position","label","title","options"],["markerElem",""],[3,"position","label","title","options","mapClick"]],template:function(e,i){1&e&&(p.Ub(0,"google-map",0),p.Cc(1,Qi,2,4,"map-marker",1),p.Cc(2,Zi,2,4,"map-marker",2),p.Tb()),2&e&&(p.mc("zoom",i.zoom)("center",i.center)("options",i.options),p.Cb(1),p.mc("ngForOf",i.markersRepartidorProduccion),p.Cb(1),p.mc("ngForOf",i.markersPedidos))},directives:[Yi.a,o.l,Yi.c],styles:[""]}),e})();const et=[{path:"",component:M,data:{titulo:"Inicio"},children:[{path:"pedidos",component:re,data:{titulo:"Pedido"}},{path:"indicaciones",component:Ie,data:{titulo:"Indicaciones Pedido"}},{path:"pedido-detalle",component:We,data:{titulo:"Indicaciones Pedido"}},{path:"pedidos-atendidos",component:z,data:{titulo:"Pedidos Atendidos"}},{path:"mapa-de-pedidos",component:Ei,data:{titulo:"Mapa de pedidos"}},{path:"list-grupo-pedidos",component:Ji,data:{titulo:"Grupo de pedidos"}},{path:"indicaciones-mapa-grupo",component:(()=>{class e{constructor(e,i){this.dialog=e,this.pedidoRepartidorService=i}ngOnInit(){}openDialogOrden(e){const i=new a.e;e.isRepartidorRed=!0,i.disableClose=!0,i.hasBackdrop=!0,i.width="700px",i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],i.data={laOrden:e},this.pedidoRepartidorService.setPedidoSelect(e),this.dialog.open(Qe,i)}}return e.\u0275fac=function(i){return new(i||e)(p.Ob(a.b),p.Ob(f.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-indicaciones-grupo-mapa"]],decls:7,vars:1,consts:[[1,"animated","fadeInDown","container-body"],[1,"p-3","bg-dark","text-white","fs-13","d-flex","justify-content-between"],[1,"content-body-mapa"],[3,"trazarRuta","pedidoOpen"]],template:function(e,i){1&e&&(p.Ub(0,"div",0),p.Ub(1,"div",1),p.Ub(2,"div"),p.Ub(3,"span"),p.Ec(4,"Pedidos - Ruta mas corta"),p.Tb(),p.Tb(),p.Tb(),p.Ub(5,"div",2),p.Ub(6,"app-mapa-ordenes",3),p.cc("pedidoOpen",(function(e){return i.openDialogOrden(e)})),p.Tb(),p.Tb(),p.Tb()),2&e&&(p.Cb(6),p.mc("trazarRuta",!0))},directives:[Xi],styles:[".content-body-mapa[_ngcontent-%COMP%]{height:calc(100vh - 109px);overflow:auto}"]}),e})(),data:{titulo:"Indicaciones en el mapa"}}]}];let it=(()=>{class e{}return e.\u0275mod=p.Mb({type:e}),e.\u0275inj=p.Lb({factory:function(i){return new(i||e)},imports:[[s.d.forChild(et)],s.d]}),e})();var tt=t("rsRi"),ot=t("pKmL"),st=t("lSLK");let at=(()=>{class e{}return e.\u0275mod=p.Mb({type:e}),e.\u0275inj=p.Lb({factory:function(i){return new(i||e)},imports:[[o.c,it,ot.a,st.a,tt.a]]}),e})()},"90cg":function(e,i,t){"use strict";i.isPromise=function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}},IW2O:function(e,i,t){"use strict";var o=this&&this.__extends||function(){var e=function(i,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(i,t)};return function(i,t){function o(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),s=t("Y4kR"),a=t("cSoz");i.takeUntil=function(e){return function(i){return i.lift(new n(e))}};var n=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,i){var t=new r(e),o=a.subscribeToResult(t,this.notifier);return o&&!t.seenValue?(t.add(o),i.subscribe(t)):t},e}(),r=function(e){function i(i){var t=e.call(this,i)||this;return t.seenValue=!1,t}return o(i,e),i.prototype.notifyNext=function(e,i,t,o,s){this.seenValue=!0,this.complete()},i.prototype.notifyComplete=function(){},i}(s.OuterSubscriber)},OAkW:function(e,i,t){"use strict";i.subscribeToArray=function(e){return function(i){for(var t=0,o=e.length;t<o&&!i.closed;t++)i.next(e[t]);i.complete()}}},VKeD:function(e,i,t){"use strict";function o(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}i.getSymbolIterator=o,i.iterator=o(),i.$$iterator=i.iterator},Vi6O:function(e,i,t){"use strict";var o=this&&this.__extends||function(){var e=function(i,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(i,t)};return function(i,t){function o(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();i.InnerSubscriber=function(e){function i(i,t,o){var s=e.call(this)||this;return s.parent=i,s.outerValue=t,s.outerIndex=o,s.index=0,s}return o(i,e),i.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},i.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},i}(t("FWf1").Subscriber)},Y4kR:function(e,i,t){"use strict";var o=this&&this.__extends||function(){var e=function(i,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(i,t)};return function(i,t){function o(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();i.OuterSubscriber=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return o(i,e),i.prototype.notifyNext=function(e,i,t,o,s){this.destination.next(i)},i.prototype.notifyError=function(e,i){this.destination.error(e)},i.prototype.notifyComplete=function(e){this.destination.complete()},i}(t("FWf1").Subscriber)},Z5tI:function(e,i,t){"use strict";var o=t("MkmW");i.subscribeToPromise=function(e){return function(i){return e.then((function(e){i.closed||(i.next(e),i.complete())}),(function(e){return i.error(e)})).then(null,o.hostReportError),i}}},cSoz:function(e,i,t){"use strict";var o=t("Vi6O"),s=t("6qA3"),a=t("Q1FS");i.subscribeToResult=function(e,i,t,n,r){if(void 0===r&&(r=new o.InnerSubscriber(e,t,n)),!r.closed)return i instanceof a.Observable?i.subscribe(r):s.subscribeTo(i)(r)}},ozli:function(e,i,t){"use strict";var o=t("zfKp");i.subscribeToObservable=function(e){return function(i){var t=e[o.observable]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(i)}}},poJ0:function(e,i,t){"use strict";var o=t("VKeD");i.subscribeToIterable=function(e){return function(i){for(var t=e[o.iterator]();;){var s=t.next();if(s.done){i.complete();break}if(i.next(s.value),i.closed)break}return"function"==typeof t.return&&i.add((function(){t.return&&t.return()})),i}}},yRPT:function(e,i,t){"use strict";i.isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}}}]);